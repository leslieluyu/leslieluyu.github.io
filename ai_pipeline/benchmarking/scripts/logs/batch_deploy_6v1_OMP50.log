2023-03-14 02:24:17,677 - INFO - Starting batch deployment...
2023-03-14 02:24:17,679 - INFO - ------------- scenario: 1/5 ------------
2023-03-14 02:24:17,679 - INFO - Begin set_deployment_env of scenario : AMX_BF16 ...
2023-03-14 02:24:17,712 - INFO - Setting environment variables for scenario AMX_BF16...
2023-03-14 02:24:17,730 - INFO - Setting resource requests and limits for scenario AMX_BF16...
2023-03-14 02:24:17,747 - INFO - after patch_body
2023-03-14 02:24:17,748 - INFO - Waiting for 1 pods to be ready for scenario AMX_BF16...
2023-03-14 02:24:17,811 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2 status:Running
2023-03-14 02:24:17,811 - INFO - All 1 pods are ready for scenario AMX_BF16
2023-03-14 02:24:17,812 - INFO - Finished scenario AMX_BF16
2023-03-14 02:24:17,812 - INFO - wait for 2m to get stable metrics ...
2023-03-14 02:24:17,812 - INFO - Running benchmarking script for scenario AMX_BF16...
2023-03-14 02:24:17,823 - INFO - TS=20230314022417
2023-03-14 02:24:19,717 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:24:19,717 - INFO - Reading package lists...
2023-03-14 02:24:19,717 - INFO - Building dependency tree...
2023-03-14 02:24:19,718 - INFO - Reading state information...
2023-03-14 02:24:19,718 - INFO - linux-tools-5.15.0-60-generic is already the newest version (5.15.0-60.66).
2023-03-14 02:24:19,718 - INFO - sysstat is already the newest version (12.5.2-2ubuntu0.1).
2023-03-14 02:24:19,718 - INFO - The following packages were automatically installed and are no longer required:
2023-03-14 02:24:19,718 - INFO - cgroupfs-mount libltdl7 pigz
2023-03-14 02:24:19,718 - INFO - Use 'sudo apt autoremove' to remove them.
2023-03-14 02:24:19,718 - INFO - 0 upgraded, 0 newly installed, 0 to remove and 41 not upgraded.
2023-03-14 02:24:19,718 - INFO - WARNING: apt does not have a stable CLI interface. Use with caution in scripts.
2023-03-14 02:24:20,803 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:24:20,803 - INFO - 
2023-03-14 02:24:21,902 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:24:21,903 - INFO - performance
2023-03-14 02:24:22,001 - INFO - Run on test AiPipeline_20230314022417_A078_AMX_BF16_6
2023-03-14 02:24:22,001 - INFO - TT=AiPipeline_20230314022417_A078_AMX_BF16_6,WRKDIR=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 02:24:22,007 - INFO - -----------loop num:1/3------------
2023-03-14 02:24:32,013 - INFO - 1.  fetch_emon.sh
2023-03-14 02:24:32,015 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 02:24:33,310 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 02:24:33,310 - INFO - "ansible_facts": {
2023-03-14 02:24:33,311 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 02:24:33,311 - INFO - },
2023-03-14 02:24:33,311 - INFO - "changed": false,
2023-03-14 02:24:33,311 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 02:24:33,311 - INFO - "dest": "runemon.sh",
2023-03-14 02:24:33,311 - INFO - "gid": 1007,
2023-03-14 02:24:33,311 - INFO - "group": "ansible",
2023-03-14 02:24:33,311 - INFO - "mode": "0755",
2023-03-14 02:24:33,311 - INFO - "owner": "ansible",
2023-03-14 02:24:33,311 - INFO - "path": "runemon.sh",
2023-03-14 02:24:33,311 - INFO - "size": 452,
2023-03-14 02:24:33,311 - INFO - "state": "file",
2023-03-14 02:24:33,311 - INFO - "uid": 1006
2023-03-14 02:24:33,312 - INFO - }
2023-03-14 02:24:34,743 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 02:24:34,743 - INFO - "ansible_facts": {
2023-03-14 02:24:34,743 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 02:24:34,743 - INFO - },
2023-03-14 02:24:34,744 - INFO - "changed": false,
2023-03-14 02:24:34,744 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 02:24:34,744 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 02:24:34,744 - INFO - "gid": 1007,
2023-03-14 02:24:34,744 - INFO - "group": "ansible",
2023-03-14 02:24:34,744 - INFO - "mode": "0664",
2023-03-14 02:24:34,744 - INFO - "owner": "ansible",
2023-03-14 02:24:34,744 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 02:24:34,744 - INFO - "size": 23423,
2023-03-14 02:24:34,744 - INFO - "state": "file",
2023-03-14 02:24:34,744 - INFO - "uid": 1006
2023-03-14 02:24:34,744 - INFO - }
2023-03-14 02:24:35,813 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:24:35,814 - INFO - 
2023-03-14 02:24:36,903 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:24:36,903 - INFO - 
2023-03-14 02:24:37,000 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 02:24:42,003 - INFO - Collecting 30 seconds sar data background
2023-03-14 02:24:43,975 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:24:43,975 - INFO - 
2023-03-14 02:24:46,074 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:24:46,075 - INFO - 
2023-03-14 02:24:48,139 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:24:48,139 - INFO - 
2023-03-14 02:24:50,199 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:24:50,199 - INFO - 
2023-03-14 02:24:50,296 - INFO - Collecting EMON data
2023-03-14 02:25:21,848 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:25:21,849 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 02:25:21,849 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 02:25:21,849 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 02:25:21,849 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 02:25:21,849 - INFO - LD_LIBRARY_PATH=
2023-03-14 02:25:21,849 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 02:25:21,849 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 02:25:21,849 - INFO - EMON collector successfully stopped.
2023-03-14 02:25:21,956 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 02:25:51,959 - INFO - Copy dat files
2023-03-14 02:25:52,965 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:25:52,966 - INFO - "changed": true,
2023-03-14 02:25:52,966 - INFO - "checksum": "6e0bbe599dfcfb8384e5095fe98dddc82485de0d",
2023-03-14 02:25:52,966 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 02:25:52,966 - INFO - "md5sum": "cf4e90e0ca723147c91e48522f3a8f70",
2023-03-14 02:25:52,966 - INFO - "remote_checksum": "6e0bbe599dfcfb8384e5095fe98dddc82485de0d",
2023-03-14 02:25:52,966 - INFO - "remote_md5sum": null
2023-03-14 02:25:52,966 - INFO - }
2023-03-14 02:25:54,075 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:25:54,076 - INFO - "changed": true,
2023-03-14 02:25:54,076 - INFO - "checksum": "1610498071150f6e92a4abc9843dea56e6c82f2b",
2023-03-14 02:25:54,076 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 02:25:54,076 - INFO - "md5sum": "a26f8b7f293550dc756c14febdc6bdae",
2023-03-14 02:25:54,076 - INFO - "remote_checksum": "1610498071150f6e92a4abc9843dea56e6c82f2b",
2023-03-14 02:25:54,076 - INFO - "remote_md5sum": null
2023-03-14 02:25:54,076 - INFO - }
2023-03-14 02:25:55,210 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:25:55,211 - INFO - "changed": true,
2023-03-14 02:25:55,211 - INFO - "checksum": "903363900b5d64c5ca3369093397d5e15aa7ad08",
2023-03-14 02:25:55,211 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 02:25:55,211 - INFO - "md5sum": "405ddc9393a020ad554ca164f5d3de3a",
2023-03-14 02:25:55,211 - INFO - "remote_checksum": "903363900b5d64c5ca3369093397d5e15aa7ad08",
2023-03-14 02:25:55,211 - INFO - "remote_md5sum": null
2023-03-14 02:25:55,211 - INFO - }
2023-03-14 02:25:56,348 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:25:56,348 - INFO - "changed": true,
2023-03-14 02:25:56,348 - INFO - "checksum": "be899e5e9aa198e8324d3999084070db1421ef6a",
2023-03-14 02:25:56,348 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 02:25:56,348 - INFO - "md5sum": "21df72eafa6439bef86239b51d860172",
2023-03-14 02:25:56,348 - INFO - "remote_checksum": "be899e5e9aa198e8324d3999084070db1421ef6a",
2023-03-14 02:25:56,348 - INFO - "remote_md5sum": null
2023-03-14 02:25:56,349 - INFO - }
2023-03-14 02:25:57,447 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:25:57,448 - INFO - "changed": true,
2023-03-14 02:25:57,448 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 02:25:57,448 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 02:25:57,448 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 02:25:57,448 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 02:25:57,448 - INFO - "remote_md5sum": null
2023-03-14 02:25:57,448 - INFO - }
2023-03-14 02:25:58,560 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:25:58,560 - INFO - "changed": true,
2023-03-14 02:25:58,560 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 02:25:58,560 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 02:25:58,560 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 02:25:58,560 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 02:25:58,560 - INFO - "remote_md5sum": null
2023-03-14 02:25:58,561 - INFO - }
2023-03-14 02:26:00,189 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:26:00,190 - INFO - "changed": true,
2023-03-14 02:26:00,190 - INFO - "checksum": "2fe6deedb3b3d9bdece44b2b97251af6c929e8c7",
2023-03-14 02:26:00,190 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 02:26:00,190 - INFO - "md5sum": "15fbba8b68ef63cc24c1887510b642ef",
2023-03-14 02:26:00,190 - INFO - "remote_checksum": "2fe6deedb3b3d9bdece44b2b97251af6c929e8c7",
2023-03-14 02:26:00,190 - INFO - "remote_md5sum": null
2023-03-14 02:26:00,190 - INFO - }
2023-03-14 02:26:00,286 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 02:26:00,286 - INFO - 3.  collect the result
2023-03-14 02:26:00,460 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 02:26:00,460 - INFO - metric_name is: cpu_usage
2023-03-14 02:26:00,475 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678785960.453, '0.06860426111110832']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678785960.453, '0.07976978055555972']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678785960.453, '0.07100650277777984']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678785960.453, '0.07757670555555604']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678785960.453, '0.07152494444444528']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678785960.453, '0.07276748611110533']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678785960.453, '0.0011621666666665456']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod5596ede8_3ad4_43ab_b624_7f229e363d13.slice/cri-containerd-0a8ae2f55061745486d3ce4fce7f5b971e45678846c3b58ea4b1db250b1bfa37.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0a8ae2f55061745486d3ce4fce7f5b971e45678846c3b58ea4b1db250b1bfa37', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'kubelet'}, 'value': [1678785960.453, '51.019575283333324']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678785960.453, '0.011389602777777933']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678785960.453, '0.0009963833333333442']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678785960.453, '0.018631124999999176']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678785960.453, '0.00000039166666666667283']}]
2023-03-14 02:26:00,475 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 02:26:00,475 - INFO - metric_name is: memory_usage
2023-03-14 02:26:00,475 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678785960.457, '386162688']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678785960.457, '386564096']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678785960.457, '386551808']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678785960.457, '386277376']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678785960.457, '386441216']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678785960.457, '386002944']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678785960.457, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2'}, 'value': [1678785960.457, '524075008']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678785960.457, '5093199872']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678785960.457, '15294464']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678785960.457, '2445393920']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678785960.457, '847872']}]
2023-03-14 02:26:00,475 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 02:26:00,475 - INFO - metric_name is: ei_infer_fps
2023-03-14 02:26:00,476 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.56:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678785960.461, '141.2900805057711']}]
2023-03-14 02:26:00,476 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 02:26:00,476 - INFO - metric_name is: ei_drop_fps
2023-03-14 02:26:00,476 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.56:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678785960.465, '28.465555525468744']}]
2023-03-14 02:26:00,476 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 02:26:00,476 - INFO - metric_name is: ei_scale_ratio
2023-03-14 02:26:00,476 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.56:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678785960.468, '1.2031996040737007']}]
2023-03-14 02:26:00,476 - INFO - Results written to metrics/A078_AMX_BF16_metrics_20230314_022600.txt
2023-03-14 02:26:00,552 - INFO - sleep 120 seconds for the next round ...
2023-03-14 02:27:43,415 - INFO - Starting batch deployment...
2023-03-14 02:27:43,417 - INFO - ------------- scenario: 1/5 ------------
2023-03-14 02:27:43,418 - INFO - Begin set_deployment_env of scenario : AMX_BF16 ...
2023-03-14 02:27:43,451 - INFO - Setting environment variables for scenario AMX_BF16...
2023-03-14 02:27:43,469 - INFO - Setting resource requests and limits for scenario AMX_BF16...
2023-03-14 02:27:43,487 - INFO - after patch_body
2023-03-14 02:27:43,487 - INFO - Waiting for 1 pods to be ready for scenario AMX_BF16...
2023-03-14 02:27:43,545 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2 status:Running
2023-03-14 02:27:43,546 - INFO - All 1 pods are ready for scenario AMX_BF16
2023-03-14 02:27:43,546 - INFO - Finished scenario AMX_BF16
2023-03-14 02:27:43,546 - INFO - wait for 2m to get stable metrics ...
2023-03-14 02:29:43,647 - INFO - Running benchmarking script for scenario AMX_BF16...
2023-03-14 02:29:43,658 - INFO - TS=20230314022943
2023-03-14 02:29:45,680 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:29:45,680 - INFO - Reading package lists...
2023-03-14 02:29:45,681 - INFO - Building dependency tree...
2023-03-14 02:29:45,681 - INFO - Reading state information...
2023-03-14 02:29:45,681 - INFO - linux-tools-5.15.0-60-generic is already the newest version (5.15.0-60.66).
2023-03-14 02:29:45,681 - INFO - sysstat is already the newest version (12.5.2-2ubuntu0.1).
2023-03-14 02:29:45,681 - INFO - The following packages were automatically installed and are no longer required:
2023-03-14 02:29:45,681 - INFO - cgroupfs-mount libltdl7 pigz
2023-03-14 02:29:45,681 - INFO - Use 'sudo apt autoremove' to remove them.
2023-03-14 02:29:45,681 - INFO - 0 upgraded, 0 newly installed, 0 to remove and 41 not upgraded.
2023-03-14 02:29:45,681 - INFO - WARNING: apt does not have a stable CLI interface. Use with caution in scripts.
2023-03-14 02:29:46,773 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:29:46,774 - INFO - 
2023-03-14 02:29:47,842 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:29:47,842 - INFO - performance
2023-03-14 02:29:47,941 - INFO - Run on test AiPipeline_20230314022943_38B6_AMX_BF16_6
2023-03-14 02:29:47,941 - INFO - TT=AiPipeline_20230314022943_38B6_AMX_BF16_6,WRKDIR=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 02:29:47,946 - INFO - -----------loop num:1/3------------
2023-03-14 02:29:57,952 - INFO - 1.  fetch_emon.sh
2023-03-14 02:29:57,954 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 02:29:59,477 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 02:29:59,478 - INFO - "ansible_facts": {
2023-03-14 02:29:59,478 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 02:29:59,478 - INFO - },
2023-03-14 02:29:59,478 - INFO - "changed": false,
2023-03-14 02:29:59,478 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 02:29:59,478 - INFO - "dest": "runemon.sh",
2023-03-14 02:29:59,478 - INFO - "gid": 1007,
2023-03-14 02:29:59,478 - INFO - "group": "ansible",
2023-03-14 02:29:59,478 - INFO - "mode": "0755",
2023-03-14 02:29:59,479 - INFO - "owner": "ansible",
2023-03-14 02:29:59,479 - INFO - "path": "runemon.sh",
2023-03-14 02:29:59,479 - INFO - "size": 452,
2023-03-14 02:29:59,479 - INFO - "state": "file",
2023-03-14 02:29:59,479 - INFO - "uid": 1006
2023-03-14 02:29:59,479 - INFO - }
2023-03-14 02:30:00,895 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 02:30:00,895 - INFO - "ansible_facts": {
2023-03-14 02:30:00,895 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 02:30:00,895 - INFO - },
2023-03-14 02:30:00,895 - INFO - "changed": false,
2023-03-14 02:30:00,896 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 02:30:00,896 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 02:30:00,896 - INFO - "gid": 1007,
2023-03-14 02:30:00,896 - INFO - "group": "ansible",
2023-03-14 02:30:00,896 - INFO - "mode": "0664",
2023-03-14 02:30:00,896 - INFO - "owner": "ansible",
2023-03-14 02:30:00,896 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 02:30:00,896 - INFO - "size": 23423,
2023-03-14 02:30:00,896 - INFO - "state": "file",
2023-03-14 02:30:00,896 - INFO - "uid": 1006
2023-03-14 02:30:00,896 - INFO - }
2023-03-14 02:30:01,772 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:30:01,773 - INFO - 
2023-03-14 02:30:02,804 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:30:02,804 - INFO - 
2023-03-14 02:30:02,905 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 02:30:07,908 - INFO - Collecting 30 seconds sar data background
2023-03-14 02:30:09,868 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:30:09,868 - INFO - 
2023-03-14 02:30:11,944 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:30:11,944 - INFO - 
2023-03-14 02:30:14,008 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:30:14,009 - INFO - 
2023-03-14 02:30:16,139 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:30:16,140 - INFO - 
2023-03-14 02:30:16,241 - INFO - Collecting EMON data
2023-03-14 02:30:47,823 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:30:47,823 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 02:30:47,824 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 02:30:47,824 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 02:30:47,824 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 02:30:47,824 - INFO - LD_LIBRARY_PATH=
2023-03-14 02:30:47,824 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 02:30:47,824 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 02:30:47,824 - INFO - EMON collector successfully stopped.
2023-03-14 02:30:47,932 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 02:31:17,935 - INFO - Copy dat files
2023-03-14 02:31:18,971 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:31:18,971 - INFO - "changed": true,
2023-03-14 02:31:18,971 - INFO - "checksum": "3fb96e5fde52b9a75fa8db12549ad7d3e4423580",
2023-03-14 02:31:18,972 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 02:31:18,972 - INFO - "md5sum": "7bb5432e528dcbe72f51cf17c0cbf1ac",
2023-03-14 02:31:18,972 - INFO - "remote_checksum": "3fb96e5fde52b9a75fa8db12549ad7d3e4423580",
2023-03-14 02:31:18,972 - INFO - "remote_md5sum": null
2023-03-14 02:31:18,972 - INFO - }
2023-03-14 02:31:20,109 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:31:20,109 - INFO - "changed": true,
2023-03-14 02:31:20,109 - INFO - "checksum": "7c48c98a613b7c4edd14ca93eb0b7fc32ed45811",
2023-03-14 02:31:20,109 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 02:31:20,109 - INFO - "md5sum": "df1e0804d1d5a3a3f8f0380bed197e8d",
2023-03-14 02:31:20,110 - INFO - "remote_checksum": "7c48c98a613b7c4edd14ca93eb0b7fc32ed45811",
2023-03-14 02:31:20,110 - INFO - "remote_md5sum": null
2023-03-14 02:31:20,110 - INFO - }
2023-03-14 02:31:21,233 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:31:21,234 - INFO - "changed": true,
2023-03-14 02:31:21,234 - INFO - "checksum": "f1e1d2bf4c663bce1673bc20f5044685c26ce065",
2023-03-14 02:31:21,234 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 02:31:21,234 - INFO - "md5sum": "abd67b6dad32c905de8c1024bd0e1ad1",
2023-03-14 02:31:21,234 - INFO - "remote_checksum": "f1e1d2bf4c663bce1673bc20f5044685c26ce065",
2023-03-14 02:31:21,234 - INFO - "remote_md5sum": null
2023-03-14 02:31:21,234 - INFO - }
2023-03-14 02:31:22,378 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:31:22,378 - INFO - "changed": true,
2023-03-14 02:31:22,378 - INFO - "checksum": "b40bf3d7faf6c5c54db29c5398b3feee9ca0b986",
2023-03-14 02:31:22,378 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 02:31:22,378 - INFO - "md5sum": "9b1e2d0e5a25b4fe48206afc303d1154",
2023-03-14 02:31:22,378 - INFO - "remote_checksum": "b40bf3d7faf6c5c54db29c5398b3feee9ca0b986",
2023-03-14 02:31:22,379 - INFO - "remote_md5sum": null
2023-03-14 02:31:22,379 - INFO - }
2023-03-14 02:31:23,489 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:31:23,489 - INFO - "changed": true,
2023-03-14 02:31:23,490 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 02:31:23,490 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 02:31:23,490 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 02:31:23,490 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 02:31:23,490 - INFO - "remote_md5sum": null
2023-03-14 02:31:23,490 - INFO - }
2023-03-14 02:31:24,634 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:31:24,634 - INFO - "changed": true,
2023-03-14 02:31:24,634 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 02:31:24,634 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 02:31:24,634 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 02:31:24,634 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 02:31:24,634 - INFO - "remote_md5sum": null
2023-03-14 02:31:24,635 - INFO - }
2023-03-14 02:31:26,265 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:31:26,265 - INFO - "changed": true,
2023-03-14 02:31:26,265 - INFO - "checksum": "8253bb4166969ed011cb32ec8a69cb425c47164c",
2023-03-14 02:31:26,265 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 02:31:26,266 - INFO - "md5sum": "5fd5a7d2b7eefc6171bccd3bcdaa1f98",
2023-03-14 02:31:26,266 - INFO - "remote_checksum": "8253bb4166969ed011cb32ec8a69cb425c47164c",
2023-03-14 02:31:26,266 - INFO - "remote_md5sum": null
2023-03-14 02:31:26,266 - INFO - }
2023-03-14 02:31:26,367 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 02:31:26,368 - INFO - 3.  collect the result
2023-03-14 02:31:26,528 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 02:31:26,529 - INFO - metric_name is: cpu_usage
2023-03-14 02:31:26,543 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678786286.521, '0.0760799777777821']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678786286.521, '0.07214661944444742']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678786286.521, '0.07325875555555587']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678786286.521, '0.0771544277777745']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678786286.521, '0.07179278333334069']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678786286.521, '0.07627778055556417']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678786286.521, '0.0012415166666667372']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod5596ede8_3ad4_43ab_b624_7f229e363d13.slice/cri-containerd-0a8ae2f55061745486d3ce4fce7f5b971e45678846c3b58ea4b1db250b1bfa37.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0a8ae2f55061745486d3ce4fce7f5b971e45678846c3b58ea4b1db250b1bfa37', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'kubelet'}, 'value': [1678786286.521, '52.4840494444445']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678786286.521, '0.009840858333331601']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678786286.521, '0.0011351194444437674']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678786286.521, '0.018676777777775693']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678786286.521, '0']}]
2023-03-14 02:31:26,544 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 02:31:26,544 - INFO - metric_name is: memory_usage
2023-03-14 02:31:26,544 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678786286.526, '386273280']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678786286.526, '386670592']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678786286.526, '386445312']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678786286.526, '386150400']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678786286.526, '386441216']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678786286.526, '386134016']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678786286.526, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2'}, 'value': [1678786286.526, '524075008']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678786286.526, '5093097472']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678786286.526, '15433728']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678786286.526, '2445455360']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678786286.526, '847872']}]
2023-03-14 02:31:26,544 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 02:31:26,544 - INFO - metric_name is: ei_infer_fps
2023-03-14 02:31:26,544 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.56:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678786286.53, '145.6507026136892']}]
2023-03-14 02:31:26,544 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 02:31:26,544 - INFO - metric_name is: ei_drop_fps
2023-03-14 02:31:26,544 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.56:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678786286.533, '24.55441053265999']}]
2023-03-14 02:31:26,544 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 02:31:26,545 - INFO - metric_name is: ei_scale_ratio
2023-03-14 02:31:26,545 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.56:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678786286.537, '1.1688667196730762']}]
2023-03-14 02:31:26,545 - INFO - Results written to metrics/38B6_AMX_BF16_metrics_20230314_023126.txt
2023-03-14 02:31:26,614 - INFO - sleep 120 seconds for the next round ...
2023-03-14 02:33:26,616 - INFO - -----------loop num:2/3------------
2023-03-14 02:33:36,622 - INFO - 1.  fetch_emon.sh
2023-03-14 02:33:36,624 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 02:33:38,514 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 02:33:38,515 - INFO - "ansible_facts": {
2023-03-14 02:33:38,515 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 02:33:38,515 - INFO - },
2023-03-14 02:33:38,515 - INFO - "changed": false,
2023-03-14 02:33:38,515 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 02:33:38,515 - INFO - "dest": "runemon.sh",
2023-03-14 02:33:38,515 - INFO - "gid": 1007,
2023-03-14 02:33:38,515 - INFO - "group": "ansible",
2023-03-14 02:33:38,515 - INFO - "mode": "0755",
2023-03-14 02:33:38,515 - INFO - "owner": "ansible",
2023-03-14 02:33:38,516 - INFO - "path": "runemon.sh",
2023-03-14 02:33:38,516 - INFO - "size": 452,
2023-03-14 02:33:38,516 - INFO - "state": "file",
2023-03-14 02:33:38,516 - INFO - "uid": 1006
2023-03-14 02:33:38,516 - INFO - }
2023-03-14 02:33:39,648 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 02:33:39,648 - INFO - "ansible_facts": {
2023-03-14 02:33:39,648 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 02:33:39,648 - INFO - },
2023-03-14 02:33:39,648 - INFO - "changed": false,
2023-03-14 02:33:39,649 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 02:33:39,649 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 02:33:39,649 - INFO - "gid": 1007,
2023-03-14 02:33:39,649 - INFO - "group": "ansible",
2023-03-14 02:33:39,649 - INFO - "mode": "0664",
2023-03-14 02:33:39,649 - INFO - "owner": "ansible",
2023-03-14 02:33:39,649 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 02:33:39,649 - INFO - "size": 23423,
2023-03-14 02:33:39,649 - INFO - "state": "file",
2023-03-14 02:33:39,649 - INFO - "uid": 1006
2023-03-14 02:33:39,649 - INFO - }
2023-03-14 02:33:40,717 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:33:40,717 - INFO - 
2023-03-14 02:33:41,776 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:33:41,777 - INFO - 
2023-03-14 02:33:41,873 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 02:33:46,876 - INFO - Collecting 30 seconds sar data background
2023-03-14 02:33:48,848 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:33:48,848 - INFO - 
2023-03-14 02:33:50,927 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:33:50,928 - INFO - 
2023-03-14 02:33:53,057 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:33:53,057 - INFO - 
2023-03-14 02:33:55,136 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:33:55,137 - INFO - 
2023-03-14 02:33:55,240 - INFO - Collecting EMON data
2023-03-14 02:34:26,790 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:34:26,791 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 02:34:26,791 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 02:34:26,791 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 02:34:26,791 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 02:34:26,791 - INFO - LD_LIBRARY_PATH=
2023-03-14 02:34:26,791 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 02:34:26,791 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 02:34:26,792 - INFO - EMON collector successfully stopped.
2023-03-14 02:34:26,895 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 02:34:56,898 - INFO - Copy dat files
2023-03-14 02:34:57,911 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:34:57,912 - INFO - "changed": true,
2023-03-14 02:34:57,912 - INFO - "checksum": "f79f54deec7bb1b2b1e0872817ae8bc3714bb946",
2023-03-14 02:34:57,912 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 02:34:57,912 - INFO - "md5sum": "ac3a522a7ca25e118168b96b9b6dcb95",
2023-03-14 02:34:57,912 - INFO - "remote_checksum": "f79f54deec7bb1b2b1e0872817ae8bc3714bb946",
2023-03-14 02:34:57,912 - INFO - "remote_md5sum": null
2023-03-14 02:34:57,912 - INFO - }
2023-03-14 02:34:59,038 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:34:59,038 - INFO - "changed": true,
2023-03-14 02:34:59,038 - INFO - "checksum": "1435cb1f42edb51c7d8d0482a2fa6958b3cbfe28",
2023-03-14 02:34:59,039 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 02:34:59,039 - INFO - "md5sum": "4d1987e7df7fb3f126458bf5cafa7476",
2023-03-14 02:34:59,039 - INFO - "remote_checksum": "1435cb1f42edb51c7d8d0482a2fa6958b3cbfe28",
2023-03-14 02:34:59,039 - INFO - "remote_md5sum": null
2023-03-14 02:34:59,039 - INFO - }
2023-03-14 02:35:00,165 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:35:00,166 - INFO - "changed": true,
2023-03-14 02:35:00,166 - INFO - "checksum": "6d08e5e30cd420c0f5ee926823d9d7b5c2204821",
2023-03-14 02:35:00,166 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 02:35:00,166 - INFO - "md5sum": "475b209500f928ae3dcb881c147da9c7",
2023-03-14 02:35:00,166 - INFO - "remote_checksum": "6d08e5e30cd420c0f5ee926823d9d7b5c2204821",
2023-03-14 02:35:00,166 - INFO - "remote_md5sum": null
2023-03-14 02:35:00,166 - INFO - }
2023-03-14 02:35:01,322 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:35:01,323 - INFO - "changed": true,
2023-03-14 02:35:01,323 - INFO - "checksum": "c2355051243161ef0f0cc64a81dfd0c26ac94260",
2023-03-14 02:35:01,323 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 02:35:01,323 - INFO - "md5sum": "69eb8840b9827b67dbeb38cd0e1144f8",
2023-03-14 02:35:01,323 - INFO - "remote_checksum": "c2355051243161ef0f0cc64a81dfd0c26ac94260",
2023-03-14 02:35:01,323 - INFO - "remote_md5sum": null
2023-03-14 02:35:01,323 - INFO - }
2023-03-14 02:35:02,437 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:35:02,437 - INFO - "changed": true,
2023-03-14 02:35:02,437 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 02:35:02,437 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 02:35:02,437 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 02:35:02,437 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 02:35:02,437 - INFO - "remote_md5sum": null
2023-03-14 02:35:02,438 - INFO - }
2023-03-14 02:35:03,542 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:35:03,542 - INFO - "changed": true,
2023-03-14 02:35:03,542 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 02:35:03,542 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 02:35:03,542 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 02:35:03,543 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 02:35:03,543 - INFO - "remote_md5sum": null
2023-03-14 02:35:03,543 - INFO - }
2023-03-14 02:35:05,245 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:35:05,246 - INFO - "changed": true,
2023-03-14 02:35:05,246 - INFO - "checksum": "27409a4ed75484a0119978118e902ac325846a31",
2023-03-14 02:35:05,246 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 02:35:05,246 - INFO - "md5sum": "1a34a5abec6424aa459e51cf23251ccf",
2023-03-14 02:35:05,246 - INFO - "remote_checksum": "27409a4ed75484a0119978118e902ac325846a31",
2023-03-14 02:35:05,246 - INFO - "remote_md5sum": null
2023-03-14 02:35:05,246 - INFO - }
2023-03-14 02:35:05,344 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 02:35:05,345 - INFO - 3.  collect the result
2023-03-14 02:35:05,508 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 02:35:05,508 - INFO - metric_name is: cpu_usage
2023-03-14 02:35:05,523 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678786505.501, '0.0788575222222183']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678786505.501, '0.07744176111111503']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678786505.501, '0.06901378888887849']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678786505.501, '0.075995636111131']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678786505.501, '0.06857653611111042']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678786505.501, '0.072598736111124']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678786505.501, '0.0011536805555553858']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod5596ede8_3ad4_43ab_b624_7f229e363d13.slice/cri-containerd-0a8ae2f55061745486d3ce4fce7f5b971e45678846c3b58ea4b1db250b1bfa37.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0a8ae2f55061745486d3ce4fce7f5b971e45678846c3b58ea4b1db250b1bfa37', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'kubelet'}, 'value': [1678786505.501, '51.410043499999944']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678786505.501, '0.01053222500000225']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678786505.501, '0.0011436749999991964']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678786505.501, '0.017767586111108357']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678786505.501, '0.000002566666666666689']}]
2023-03-14 02:35:05,524 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 02:35:05,524 - INFO - metric_name is: memory_usage
2023-03-14 02:35:05,524 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678786505.505, '386293760']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678786505.505, '386564096']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678786505.505, '386572288']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678786505.505, '386150400']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678786505.505, '386441216']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678786505.505, '386031616']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678786505.505, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2'}, 'value': [1678786505.505, '524075008']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678786505.505, '5093195776']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678786505.505, '15433728']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678786505.505, '2445033472']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678786505.505, '847872']}]
2023-03-14 02:35:05,524 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 02:35:05,524 - INFO - metric_name is: ei_infer_fps
2023-03-14 02:35:05,524 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.56:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678786505.509, '144.367030650475']}]
2023-03-14 02:35:05,524 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 02:35:05,524 - INFO - metric_name is: ei_drop_fps
2023-03-14 02:35:05,524 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.56:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678786505.513, '25.605857298332666']}]
2023-03-14 02:35:05,524 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 02:35:05,525 - INFO - metric_name is: ei_scale_ratio
2023-03-14 02:35:05,525 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.56:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678786505.517, '1.1780304147283414']}]
2023-03-14 02:35:05,525 - INFO - Results written to metrics/38B6_AMX_BF16_metrics_20230314_023505.txt
2023-03-14 02:35:05,593 - INFO - sleep 120 seconds for the next round ...
2023-03-14 02:37:05,596 - INFO - -----------loop num:3/3------------
2023-03-14 02:37:15,602 - INFO - 1.  fetch_emon.sh
2023-03-14 02:37:15,604 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 02:37:17,540 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 02:37:17,540 - INFO - "ansible_facts": {
2023-03-14 02:37:17,540 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 02:37:17,540 - INFO - },
2023-03-14 02:37:17,540 - INFO - "changed": false,
2023-03-14 02:37:17,540 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 02:37:17,540 - INFO - "dest": "runemon.sh",
2023-03-14 02:37:17,541 - INFO - "gid": 1007,
2023-03-14 02:37:17,541 - INFO - "group": "ansible",
2023-03-14 02:37:17,541 - INFO - "mode": "0755",
2023-03-14 02:37:17,541 - INFO - "owner": "ansible",
2023-03-14 02:37:17,541 - INFO - "path": "runemon.sh",
2023-03-14 02:37:17,541 - INFO - "size": 452,
2023-03-14 02:37:17,541 - INFO - "state": "file",
2023-03-14 02:37:17,541 - INFO - "uid": 1006
2023-03-14 02:37:17,541 - INFO - }
2023-03-14 02:37:18,928 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 02:37:18,928 - INFO - "ansible_facts": {
2023-03-14 02:37:18,929 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 02:37:18,929 - INFO - },
2023-03-14 02:37:18,929 - INFO - "changed": false,
2023-03-14 02:37:18,929 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 02:37:18,929 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 02:37:18,929 - INFO - "gid": 1007,
2023-03-14 02:37:18,929 - INFO - "group": "ansible",
2023-03-14 02:37:18,929 - INFO - "mode": "0664",
2023-03-14 02:37:18,929 - INFO - "owner": "ansible",
2023-03-14 02:37:18,929 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 02:37:18,929 - INFO - "size": 23423,
2023-03-14 02:37:18,930 - INFO - "state": "file",
2023-03-14 02:37:18,930 - INFO - "uid": 1006
2023-03-14 02:37:18,930 - INFO - }
2023-03-14 02:37:20,005 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:37:20,005 - INFO - 
2023-03-14 02:37:21,105 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:37:21,105 - INFO - 
2023-03-14 02:37:21,201 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 02:37:26,204 - INFO - Collecting 30 seconds sar data background
2023-03-14 02:37:28,208 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:37:28,209 - INFO - 
2023-03-14 02:37:30,306 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:37:30,307 - INFO - 
2023-03-14 02:37:32,394 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:37:32,395 - INFO - 
2023-03-14 02:37:34,480 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:37:34,481 - INFO - 
2023-03-14 02:37:34,586 - INFO - Collecting EMON data
2023-03-14 02:38:06,142 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:38:06,142 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 02:38:06,142 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 02:38:06,142 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 02:38:06,143 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 02:38:06,143 - INFO - LD_LIBRARY_PATH=
2023-03-14 02:38:06,143 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 02:38:06,143 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 02:38:06,143 - INFO - EMON collector successfully stopped.
2023-03-14 02:38:06,248 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 02:38:36,251 - INFO - Copy dat files
2023-03-14 02:38:37,316 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:38:37,316 - INFO - "changed": true,
2023-03-14 02:38:37,316 - INFO - "checksum": "7c65ec15c87cdd86fb50bcefd640d951226c1ea8",
2023-03-14 02:38:37,317 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 02:38:37,317 - INFO - "md5sum": "5d5950e8e6e58db4be4cfe65434a0888",
2023-03-14 02:38:37,317 - INFO - "remote_checksum": "7c65ec15c87cdd86fb50bcefd640d951226c1ea8",
2023-03-14 02:38:37,317 - INFO - "remote_md5sum": null
2023-03-14 02:38:37,317 - INFO - }
2023-03-14 02:38:38,470 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:38:38,470 - INFO - "changed": true,
2023-03-14 02:38:38,470 - INFO - "checksum": "c1193f533a7267a8f312f47c0c571ec32b3d4dc8",
2023-03-14 02:38:38,471 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 02:38:38,471 - INFO - "md5sum": "5d55c58d1b6d568444e2ba5bbcb83492",
2023-03-14 02:38:38,471 - INFO - "remote_checksum": "c1193f533a7267a8f312f47c0c571ec32b3d4dc8",
2023-03-14 02:38:38,471 - INFO - "remote_md5sum": null
2023-03-14 02:38:38,471 - INFO - }
2023-03-14 02:38:39,579 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:38:39,579 - INFO - "changed": true,
2023-03-14 02:38:39,579 - INFO - "checksum": "effde4a4bfe85100eee9a01d2870066fceaa5c3e",
2023-03-14 02:38:39,580 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 02:38:39,580 - INFO - "md5sum": "66e12f87ba858bf52a1a907827604314",
2023-03-14 02:38:39,580 - INFO - "remote_checksum": "effde4a4bfe85100eee9a01d2870066fceaa5c3e",
2023-03-14 02:38:39,580 - INFO - "remote_md5sum": null
2023-03-14 02:38:39,580 - INFO - }
2023-03-14 02:38:40,727 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:38:40,728 - INFO - "changed": true,
2023-03-14 02:38:40,728 - INFO - "checksum": "334ff2a2a54e44a96effae9ffd66af74a82ad996",
2023-03-14 02:38:40,728 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 02:38:40,728 - INFO - "md5sum": "48582567f5b32fdfd8361095cdfd9130",
2023-03-14 02:38:40,728 - INFO - "remote_checksum": "334ff2a2a54e44a96effae9ffd66af74a82ad996",
2023-03-14 02:38:40,728 - INFO - "remote_md5sum": null
2023-03-14 02:38:40,728 - INFO - }
2023-03-14 02:38:41,831 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:38:41,831 - INFO - "changed": true,
2023-03-14 02:38:41,831 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 02:38:41,832 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 02:38:41,832 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 02:38:41,832 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 02:38:41,832 - INFO - "remote_md5sum": null
2023-03-14 02:38:41,832 - INFO - }
2023-03-14 02:38:42,925 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:38:42,926 - INFO - "changed": true,
2023-03-14 02:38:42,926 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 02:38:42,926 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 02:38:42,926 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 02:38:42,926 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 02:38:42,926 - INFO - "remote_md5sum": null
2023-03-14 02:38:42,926 - INFO - }
2023-03-14 02:38:44,647 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:38:44,647 - INFO - "changed": true,
2023-03-14 02:38:44,647 - INFO - "checksum": "62786d4a0e02c88d96ae1b2d94d963ce8197d1fd",
2023-03-14 02:38:44,648 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 02:38:44,648 - INFO - "md5sum": "76dd03cb86c47144f19f95de9c0ac872",
2023-03-14 02:38:44,648 - INFO - "remote_checksum": "62786d4a0e02c88d96ae1b2d94d963ce8197d1fd",
2023-03-14 02:38:44,648 - INFO - "remote_md5sum": null
2023-03-14 02:38:44,648 - INFO - }
2023-03-14 02:38:44,750 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 02:38:44,750 - INFO - 3.  collect the result
2023-03-14 02:38:44,910 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 02:38:44,910 - INFO - metric_name is: cpu_usage
2023-03-14 02:38:44,924 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678786724.903, '0.0794737111111115']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678786724.903, '0.07496259166665468']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678786724.903, '0.07785284166668335']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678786724.903, '0.07020117777777461']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678786724.903, '0.0726656194444432']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678786724.903, '0.07028229722222426']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678786724.903, '0.0013570194444446947']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod5596ede8_3ad4_43ab_b624_7f229e363d13.slice/cri-containerd-0a8ae2f55061745486d3ce4fce7f5b971e45678846c3b58ea4b1db250b1bfa37.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0a8ae2f55061745486d3ce4fce7f5b971e45678846c3b58ea4b1db250b1bfa37', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'kubelet'}, 'value': [1678786724.903, '52.04437387777777']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678786724.903, '0.010344608333328627']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678786724.903, '0.0010511416666657979']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678786724.903, '0.01975771944444457']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678786724.903, '0']}]
2023-03-14 02:38:44,925 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 02:38:44,925 - INFO - metric_name is: memory_usage
2023-03-14 02:38:44,925 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678786724.907, '386166784']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678786724.907, '386564096']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678786724.907, '386592768']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678786724.907, '386297856']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678786724.907, '386441216']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678786724.907, '386007040']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678786724.907, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2'}, 'value': [1678786724.907, '524075008']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678786724.907, '5093224448']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678786724.907, '15175680']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678786724.907, '2445545472']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678786724.907, '847872']}]
2023-03-14 02:38:44,925 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 02:38:44,925 - INFO - metric_name is: ei_infer_fps
2023-03-14 02:38:44,925 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.56:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678786724.911, '143.05525929600262']}]
2023-03-14 02:38:44,925 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 02:38:44,926 - INFO - metric_name is: ei_drop_fps
2023-03-14 02:38:44,926 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.56:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678786724.915, '26.71434779808265']}]
2023-03-14 02:38:44,926 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 02:38:44,926 - INFO - metric_name is: ei_scale_ratio
2023-03-14 02:38:44,926 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.56:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678786724.918, '1.1870745784433558']}]
2023-03-14 02:38:44,926 - INFO - Results written to metrics/38B6_AMX_BF16_metrics_20230314_023844.txt
2023-03-14 02:38:44,994 - INFO - ------------- scenario: 2/5 ------------
2023-03-14 02:38:44,994 - INFO - Begin set_deployment_env of scenario : NON_AMX_BF16 ...
2023-03-14 02:38:45,044 - INFO - Setting environment variables for scenario NON_AMX_BF16...
2023-03-14 02:38:45,063 - INFO - Setting resource requests and limits for scenario NON_AMX_BF16...
2023-03-14 02:38:45,081 - INFO - after patch_body
2023-03-14 02:38:45,081 - INFO - Waiting for 1 pods to be ready for scenario NON_AMX_BF16...
2023-03-14 02:38:45,147 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2 status:Running
2023-03-14 02:38:45,148 - INFO - All 1 pods are ready for scenario NON_AMX_BF16
2023-03-14 02:38:45,149 - INFO - Finished scenario NON_AMX_BF16
2023-03-14 02:38:45,149 - INFO - wait for 2m to get stable metrics ...
2023-03-14 02:40:45,249 - INFO - Running benchmarking script for scenario NON_AMX_BF16...
2023-03-14 02:40:45,261 - INFO - TS=20230314024045
2023-03-14 02:40:47,243 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:40:47,243 - INFO - Reading package lists...
2023-03-14 02:40:47,243 - INFO - Building dependency tree...
2023-03-14 02:40:47,243 - INFO - Reading state information...
2023-03-14 02:40:47,243 - INFO - linux-tools-5.15.0-60-generic is already the newest version (5.15.0-60.66).
2023-03-14 02:40:47,243 - INFO - sysstat is already the newest version (12.5.2-2ubuntu0.1).
2023-03-14 02:40:47,243 - INFO - The following packages were automatically installed and are no longer required:
2023-03-14 02:40:47,244 - INFO - cgroupfs-mount libltdl7 pigz
2023-03-14 02:40:47,244 - INFO - Use 'sudo apt autoremove' to remove them.
2023-03-14 02:40:47,244 - INFO - 0 upgraded, 0 newly installed, 0 to remove and 41 not upgraded.
2023-03-14 02:40:47,244 - INFO - WARNING: apt does not have a stable CLI interface. Use with caution in scripts.
2023-03-14 02:40:48,316 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:40:48,317 - INFO - 
2023-03-14 02:40:49,358 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:40:49,358 - INFO - performance
2023-03-14 02:40:49,453 - INFO - Run on test AiPipeline_20230314024045_38B6_NON_AMX_BF16_6
2023-03-14 02:40:49,455 - INFO - TT=AiPipeline_20230314024045_38B6_NON_AMX_BF16_6,WRKDIR=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 02:40:49,458 - INFO - -----------loop num:1/3------------
2023-03-14 02:40:59,463 - INFO - 1.  fetch_emon.sh
2023-03-14 02:40:59,464 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 02:41:00,815 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 02:41:00,816 - INFO - "ansible_facts": {
2023-03-14 02:41:00,816 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 02:41:00,816 - INFO - },
2023-03-14 02:41:00,816 - INFO - "changed": false,
2023-03-14 02:41:00,816 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 02:41:00,816 - INFO - "dest": "runemon.sh",
2023-03-14 02:41:00,816 - INFO - "gid": 1007,
2023-03-14 02:41:00,816 - INFO - "group": "ansible",
2023-03-14 02:41:00,816 - INFO - "mode": "0755",
2023-03-14 02:41:00,816 - INFO - "owner": "ansible",
2023-03-14 02:41:00,817 - INFO - "path": "runemon.sh",
2023-03-14 02:41:00,817 - INFO - "size": 452,
2023-03-14 02:41:00,817 - INFO - "state": "file",
2023-03-14 02:41:00,817 - INFO - "uid": 1006
2023-03-14 02:41:00,817 - INFO - }
2023-03-14 02:41:02,200 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 02:41:02,200 - INFO - "ansible_facts": {
2023-03-14 02:41:02,201 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 02:41:02,201 - INFO - },
2023-03-14 02:41:02,201 - INFO - "changed": false,
2023-03-14 02:41:02,201 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 02:41:02,201 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 02:41:02,201 - INFO - "gid": 1007,
2023-03-14 02:41:02,201 - INFO - "group": "ansible",
2023-03-14 02:41:02,201 - INFO - "mode": "0664",
2023-03-14 02:41:02,201 - INFO - "owner": "ansible",
2023-03-14 02:41:02,201 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 02:41:02,201 - INFO - "size": 23423,
2023-03-14 02:41:02,202 - INFO - "state": "file",
2023-03-14 02:41:02,202 - INFO - "uid": 1006
2023-03-14 02:41:02,202 - INFO - }
2023-03-14 02:41:03,256 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:41:03,257 - INFO - 
2023-03-14 02:41:04,281 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:41:04,282 - INFO - 
2023-03-14 02:41:04,379 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 02:41:09,381 - INFO - Collecting 30 seconds sar data background
2023-03-14 02:41:11,336 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:41:11,336 - INFO - 
2023-03-14 02:41:13,395 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:41:13,395 - INFO - 
2023-03-14 02:41:15,507 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:41:15,508 - INFO - 
2023-03-14 02:41:17,571 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:41:17,572 - INFO - 
2023-03-14 02:41:17,672 - INFO - Collecting EMON data
2023-03-14 02:41:49,222 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:41:49,223 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 02:41:49,223 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 02:41:49,223 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 02:41:49,223 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 02:41:49,223 - INFO - LD_LIBRARY_PATH=
2023-03-14 02:41:49,223 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 02:41:49,223 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 02:41:49,224 - INFO - EMON collector successfully stopped.
2023-03-14 02:41:49,333 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 02:42:19,336 - INFO - Copy dat files
2023-03-14 02:42:20,357 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:42:20,358 - INFO - "changed": true,
2023-03-14 02:42:20,358 - INFO - "checksum": "620434ea85dfe303be7ddc5f5551730ad31aec99",
2023-03-14 02:42:20,358 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 02:42:20,358 - INFO - "md5sum": "e465f4f06da79cce98ebbad646e66c13",
2023-03-14 02:42:20,358 - INFO - "remote_checksum": "620434ea85dfe303be7ddc5f5551730ad31aec99",
2023-03-14 02:42:20,358 - INFO - "remote_md5sum": null
2023-03-14 02:42:20,358 - INFO - }
2023-03-14 02:42:21,448 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:42:21,449 - INFO - "changed": true,
2023-03-14 02:42:21,449 - INFO - "checksum": "9869d865bdaaeb62e56d64a6af7fa45ed48a975b",
2023-03-14 02:42:21,449 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 02:42:21,449 - INFO - "md5sum": "6d4754f0f7f6f030960e5895ffadada3",
2023-03-14 02:42:21,449 - INFO - "remote_checksum": "9869d865bdaaeb62e56d64a6af7fa45ed48a975b",
2023-03-14 02:42:21,449 - INFO - "remote_md5sum": null
2023-03-14 02:42:21,449 - INFO - }
2023-03-14 02:42:22,551 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:42:22,551 - INFO - "changed": true,
2023-03-14 02:42:22,551 - INFO - "checksum": "44d49a742cf42c47e1906ca0acc37da6f4d54d00",
2023-03-14 02:42:22,551 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 02:42:22,551 - INFO - "md5sum": "bd661eb08698db102347c21902109bea",
2023-03-14 02:42:22,551 - INFO - "remote_checksum": "44d49a742cf42c47e1906ca0acc37da6f4d54d00",
2023-03-14 02:42:22,552 - INFO - "remote_md5sum": null
2023-03-14 02:42:22,552 - INFO - }
2023-03-14 02:42:23,687 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:42:23,687 - INFO - "changed": true,
2023-03-14 02:42:23,687 - INFO - "checksum": "eba2daf48e98922cccf7812a85c44ed4c1bd60b5",
2023-03-14 02:42:23,687 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 02:42:23,687 - INFO - "md5sum": "fffd9c9586d1484aaaefca07afdc6947",
2023-03-14 02:42:23,687 - INFO - "remote_checksum": "eba2daf48e98922cccf7812a85c44ed4c1bd60b5",
2023-03-14 02:42:23,688 - INFO - "remote_md5sum": null
2023-03-14 02:42:23,688 - INFO - }
2023-03-14 02:42:24,879 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:42:24,880 - INFO - "changed": true,
2023-03-14 02:42:24,880 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 02:42:24,880 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 02:42:24,880 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 02:42:24,880 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 02:42:24,880 - INFO - "remote_md5sum": null
2023-03-14 02:42:24,880 - INFO - }
2023-03-14 02:42:26,005 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:42:26,005 - INFO - "changed": true,
2023-03-14 02:42:26,005 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 02:42:26,005 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 02:42:26,006 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 02:42:26,006 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 02:42:26,006 - INFO - "remote_md5sum": null
2023-03-14 02:42:26,006 - INFO - }
2023-03-14 02:42:27,686 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 02:42:27,686 - INFO - "changed": true,
2023-03-14 02:42:27,686 - INFO - "checksum": "540aa75e95731d33bd920ecf185b76ba1a9981a8",
2023-03-14 02:42:27,686 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 02:42:27,686 - INFO - "md5sum": "d563719ba7b4cf1d4f45f87718efd884",
2023-03-14 02:42:27,686 - INFO - "remote_checksum": "540aa75e95731d33bd920ecf185b76ba1a9981a8",
2023-03-14 02:42:27,687 - INFO - "remote_md5sum": null
2023-03-14 02:42:27,687 - INFO - }
2023-03-14 02:42:27,784 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 02:42:27,784 - INFO - 3.  collect the result
2023-03-14 02:42:27,931 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 02:42:27,931 - INFO - metric_name is: cpu_usage
2023-03-14 02:42:27,946 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678786947.923, '0.07523140277778818']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678786947.923, '0.07080489444445749']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678786947.923, '0.06778998055555752']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678786947.923, '0.07078591666666195']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678786947.923, '0.07278522499999679']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678786947.923, '0.07720010833333314']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678786947.923, '0.0012833222222219042']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod5596ede8_3ad4_43ab_b624_7f229e363d13.slice/cri-containerd-0a8ae2f55061745486d3ce4fce7f5b971e45678846c3b58ea4b1db250b1bfa37.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0a8ae2f55061745486d3ce4fce7f5b971e45678846c3b58ea4b1db250b1bfa37', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'kubelet'}, 'value': [1678786947.923, '51.09575126111109']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678786947.923, '0.009367474999999103']}, {'metric': {'container': 'init-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-podc3254323_8e16_4da1_901e_8c964e953a3f.slice/cri-containerd-59663057b7e49b195b9ff9c218b30cfc13f263f21d2c63bacf0730373ad8def7.scope', 'image': 'docker.io/library/busybox:1.31', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '59663057b7e49b195b9ff9c218b30cfc13f263f21d2c63bacf0730373ad8def7', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-944m5', 'service': 'kubelet'}, 'value': [1678786947.923, '0.000230475']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678786947.923, '0.001095188888888919']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678786947.923, '0.021276741666666668']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678786947.923, '0']}]
2023-03-14 02:42:27,946 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 02:42:27,946 - INFO - metric_name is: memory_usage
2023-03-14 02:42:27,946 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678786947.928, '386162688']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678786947.928, '386564096']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678786947.928, '386572288']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678786947.928, '386277376']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678786947.928, '386441216']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678786947.928, '386260992']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678786947.928, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2'}, 'value': [1678786947.928, '524075008']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678786947.928, '5093224448']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-944m5'}, 'value': [1678786947.928, '479232']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678786947.928, '15294464']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678786947.928, '2445246464']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678786947.928, '847872']}]
2023-03-14 02:42:27,946 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 02:42:27,946 - INFO - metric_name is: ei_infer_fps
2023-03-14 02:42:27,946 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.56:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678786947.932, '142.47817251997213']}]
2023-03-14 02:42:27,947 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 02:42:27,947 - INFO - metric_name is: ei_drop_fps
2023-03-14 02:42:27,947 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.56:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678786947.936, '27.565982595010023']}]
2023-03-14 02:42:27,947 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 02:42:27,947 - INFO - metric_name is: ei_scale_ratio
2023-03-14 02:42:27,947 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.56:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-847589bfbf-kxhq2', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678786947.939, '1.194306518815742']}]
2023-03-14 02:42:27,947 - INFO - Results written to metrics/38B6_NON_AMX_BF16_metrics_20230314_024227.txt
2023-03-14 02:42:28,015 - INFO - sleep 120 seconds for the next round ...
2023-03-14 02:44:28,018 - INFO - -----------loop num:2/3------------
2023-03-14 02:44:38,024 - INFO - 1.  fetch_emon.sh
2023-03-14 02:44:38,026 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 02:44:39,949 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 02:44:39,949 - INFO - "ansible_facts": {
2023-03-14 02:44:39,950 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 02:44:39,950 - INFO - },
2023-03-14 02:44:39,950 - INFO - "changed": false,
2023-03-14 02:44:39,950 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 02:44:39,950 - INFO - "dest": "runemon.sh",
2023-03-14 02:44:39,950 - INFO - "gid": 1007,
2023-03-14 02:44:39,950 - INFO - "group": "ansible",
2023-03-14 02:44:39,950 - INFO - "mode": "0755",
2023-03-14 02:44:39,950 - INFO - "owner": "ansible",
2023-03-14 02:44:39,950 - INFO - "path": "runemon.sh",
2023-03-14 02:44:39,950 - INFO - "size": 452,
2023-03-14 02:44:39,950 - INFO - "state": "file",
2023-03-14 02:44:39,951 - INFO - "uid": 1006
2023-03-14 02:44:39,951 - INFO - }
2023-03-14 02:44:41,341 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 02:44:41,342 - INFO - "ansible_facts": {
2023-03-14 02:44:41,342 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 02:44:41,342 - INFO - },
2023-03-14 02:44:41,342 - INFO - "changed": false,
2023-03-14 02:44:41,342 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 02:44:41,342 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 02:44:41,343 - INFO - "gid": 1007,
2023-03-14 02:44:41,343 - INFO - "group": "ansible",
2023-03-14 02:44:41,343 - INFO - "mode": "0664",
2023-03-14 02:44:41,343 - INFO - "owner": "ansible",
2023-03-14 02:44:41,343 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 02:44:41,343 - INFO - "size": 23423,
2023-03-14 02:44:41,343 - INFO - "state": "file",
2023-03-14 02:44:41,343 - INFO - "uid": 1006
2023-03-14 02:44:41,343 - INFO - }
2023-03-14 02:44:42,410 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:44:42,410 - INFO - 
2023-03-14 02:44:43,592 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:44:43,593 - INFO - 
2023-03-14 02:44:43,710 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 02:44:48,713 - INFO - Collecting 30 seconds sar data background
2023-03-14 02:44:50,694 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:44:50,694 - INFO - 
2023-03-14 02:44:52,755 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:44:52,756 - INFO - 
2023-03-14 02:44:54,822 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:44:54,823 - INFO - 
2023-03-14 02:44:56,881 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:44:56,881 - INFO - 
2023-03-14 02:44:56,980 - INFO - Collecting EMON data
2023-03-14 02:45:28,507 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 02:45:28,508 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 02:45:28,508 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 02:45:28,508 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 02:45:28,508 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 02:45:28,508 - INFO - LD_LIBRARY_PATH=
2023-03-14 02:45:28,508 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 02:45:28,508 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 02:45:28,508 - INFO - EMON collector successfully stopped.
2023-03-14 02:45:28,614 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 02:58:19,520 - INFO - Starting batch deployment...
2023-03-14 02:58:19,523 - INFO - ------------- scenario: 1/5 ------------
2023-03-14 02:58:19,523 - INFO - Begin set_deployment_env of scenario : AMX_BF16 ...
2023-03-14 02:58:19,557 - INFO - Setting environment variables for scenario AMX_BF16...
2023-03-14 02:58:19,578 - INFO - Setting resource requests and limits for scenario AMX_BF16...
2023-03-14 02:58:19,598 - INFO - after patch_body
2023-03-14 02:59:00,897 - INFO - Starting batch deployment...
2023-03-14 02:59:00,899 - INFO - ------------- scenario: 1/5 ------------
2023-03-14 02:59:00,899 - INFO - Begin set_deployment_env of scenario : AMX_BF16 ...
2023-03-14 02:59:00,938 - INFO - Setting environment variables for scenario AMX_BF16...
2023-03-14 02:59:00,961 - INFO - Setting resource requests and limits for scenario AMX_BF16...
2023-03-14 02:59:00,979 - INFO - after patch_body
2023-03-14 02:59:19,863 - INFO - Starting batch deployment...
2023-03-14 02:59:19,865 - INFO - ------------- scenario: 1/5 ------------
2023-03-14 02:59:19,865 - INFO - Begin set_deployment_env of scenario : AMX_BF16 ...
2023-03-14 02:59:19,904 - INFO - Setting environment variables for scenario AMX_BF16...
2023-03-14 02:59:19,923 - INFO - Setting resource requests and limits for scenario AMX_BF16...
2023-03-14 02:59:19,942 - INFO - after patch_body
2023-03-14 02:59:19,997 - INFO - Will delete the pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-944m5 ...
2023-03-14 02:59:20,014 - INFO - Will delete the pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-ncq6w ...
2023-03-14 02:59:20,030 - INFO - Finished delete all the pod of deploy: ei-infer-deployment-pose-bf16-amx-01 in scenario: AMX_BF16
2023-03-14 02:59:20,030 - INFO - Waiting for 1 pods to be ready for scenario AMX_BF16...
2023-03-14 02:59:20,087 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-944m5 status:Running
2023-03-14 02:59:20,087 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-tn6lf status:Pending
2023-03-14 02:59:20,087 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-dk8c5 status:Pending
2023-03-14 02:59:20,088 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-ncq6w status:Pending
2023-03-14 02:59:20,088 - INFO - All 1 pods are ready for scenario AMX_BF16
2023-03-14 02:59:20,089 - INFO - Finished scenario AMX_BF16
2023-03-14 02:59:20,089 - INFO - wait for 2m to get stable metrics ...
2023-03-14 03:17:01,323 - INFO - Starting batch deployment...
2023-03-14 03:17:01,325 - INFO - ------------- scenario: 1/5 ------------
2023-03-14 03:17:01,325 - INFO - Begin set_deployment_env of scenario : AMX_BF16 ...
2023-03-14 03:17:01,363 - INFO - Setting environment variables for scenario AMX_BF16...
2023-03-14 03:17:01,382 - INFO - Setting resource requests and limits for scenario AMX_BF16...
2023-03-14 03:17:01,401 - INFO - after patch_body
2023-03-14 03:17:01,401 - INFO - Waiting for 1 pods to be ready for scenario AMX_BF16...
2023-03-14 03:17:01,462 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:18:24,747 - INFO - Starting batch deployment...
2023-03-14 03:18:24,750 - INFO - ------------- scenario: 1/5 ------------
2023-03-14 03:18:24,750 - INFO - Begin set_deployment_env of scenario : AMX_BF16 ...
2023-03-14 03:18:24,792 - INFO - Setting environment variables for scenario AMX_BF16...
2023-03-14 03:18:24,813 - INFO - Setting resource requests and limits for scenario AMX_BF16...
2023-03-14 03:18:24,831 - INFO - after patch_body
2023-03-14 03:18:24,831 - INFO - Waiting for 1 pods to be ready for scenario AMX_BF16...
2023-03-14 03:18:24,896 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:18:24,896 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:18:24,896 - INFO - All 1 pods are ready for scenario AMX_BF16
2023-03-14 03:18:24,897 - INFO - Finished scenario AMX_BF16
2023-03-14 03:18:24,897 - INFO - wait for 2m to get stable metrics ...
2023-03-14 03:19:23,279 - INFO - Starting batch deployment...
2023-03-14 03:19:23,282 - INFO - ------------- scenario: 1/5 ------------
2023-03-14 03:19:23,282 - INFO - Begin set_deployment_env of scenario : AMX_BF16 ...
2023-03-14 03:19:23,323 - INFO - Setting environment variables for scenario AMX_BF16...
2023-03-14 03:19:23,344 - INFO - Setting resource requests and limits for scenario AMX_BF16...
2023-03-14 03:19:23,360 - INFO - after patch_body
2023-03-14 03:19:23,360 - INFO - Waiting for 1 pods to be ready for scenario AMX_BF16...
2023-03-14 03:19:23,427 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:19:59,744 - INFO - Starting batch deployment...
2023-03-14 03:19:59,746 - INFO - ------------- scenario: 1/5 ------------
2023-03-14 03:19:59,746 - INFO - Begin set_deployment_env of scenario : AMX_BF16 ...
2023-03-14 03:19:59,780 - INFO - Setting environment variables for scenario AMX_BF16...
2023-03-14 03:19:59,797 - INFO - Setting resource requests and limits for scenario AMX_BF16...
2023-03-14 03:19:59,813 - INFO - after patch_body
2023-03-14 03:19:59,814 - INFO - Waiting for 1 pods to be ready for scenario AMX_BF16...
2023-03-14 03:19:59,883 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:19:59,883 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:19:59,883 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:19:59,883 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:19:59,883 - INFO - Waiting for 0 more pods to be ready for scenario AMX_BF16. Elapsed time: 0.07 seconds
2023-03-14 03:20:09,919 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:20:09,919 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:20:09,919 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:20:09,919 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:20:09,919 - INFO - Waiting for -1 more pods to be ready for scenario AMX_BF16. Elapsed time: 10.11 seconds
2023-03-14 03:20:19,954 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:20:19,955 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:20:19,955 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:20:19,955 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:20:19,955 - INFO - Waiting for -2 more pods to be ready for scenario AMX_BF16. Elapsed time: 20.14 seconds
2023-03-14 03:20:29,992 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:20:29,993 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:20:29,993 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:20:29,993 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:20:29,993 - INFO - Waiting for -3 more pods to be ready for scenario AMX_BF16. Elapsed time: 30.18 seconds
2023-03-14 03:20:40,025 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:20:40,025 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:20:40,026 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:20:40,026 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:20:40,026 - INFO - Waiting for -4 more pods to be ready for scenario AMX_BF16. Elapsed time: 40.21 seconds
2023-03-14 03:24:10,194 - INFO - Starting batch deployment...
2023-03-14 03:24:10,197 - INFO - ------------- scenario: 1/5 ------------
2023-03-14 03:24:10,197 - INFO - Begin set_deployment_env of scenario : AMX_BF16 ...
2023-03-14 03:24:10,231 - INFO - Setting environment variables for scenario AMX_BF16...
2023-03-14 03:24:10,249 - INFO - Setting resource requests and limits for scenario AMX_BF16...
2023-03-14 03:24:10,266 - INFO - after patch_body
2023-03-14 03:24:10,266 - INFO - Waiting for 1 pods to be ready for scenario AMX_BF16...
2023-03-14 03:24:10,336 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:24:10,336 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:24:10,336 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:24:10,336 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:24:10,336 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_BF16. Elapsed time: 0.07 seconds
2023-03-14 03:24:20,373 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:24:20,373 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:24:20,373 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:24:20,373 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:24:20,374 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_BF16. Elapsed time: 10.11 seconds
2023-03-14 03:24:30,412 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:24:30,412 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:24:30,412 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:24:30,412 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:24:30,412 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_BF16. Elapsed time: 20.15 seconds
2023-03-14 03:24:40,447 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:24:40,447 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:24:40,447 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:24:40,447 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:24:40,448 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_BF16. Elapsed time: 30.18 seconds
2023-03-14 03:24:50,484 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:24:50,484 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:24:50,485 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:24:50,485 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:24:50,485 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_BF16. Elapsed time: 40.22 seconds
2023-03-14 03:25:00,520 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:25:00,521 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:25:00,521 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:25:00,521 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:25:00,521 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_BF16. Elapsed time: 50.25 seconds
2023-03-14 03:25:10,559 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:25:10,559 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:25:10,559 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:25:10,559 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:25:10,559 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_BF16. Elapsed time: 60.29 seconds
2023-03-14 03:25:20,595 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:25:20,595 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:25:20,595 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:25:20,595 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:25:20,595 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_BF16. Elapsed time: 70.33 seconds
2023-03-14 03:25:30,631 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:25:30,632 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:25:30,632 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:25:30,632 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:25:30,632 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_BF16. Elapsed time: 80.37 seconds
2023-03-14 03:25:40,669 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:25:40,669 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:25:40,670 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:25:40,670 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:25:40,670 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_BF16. Elapsed time: 90.40 seconds
2023-03-14 03:25:50,707 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:25:50,707 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:25:50,707 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:25:50,707 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:25:50,707 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_BF16. Elapsed time: 100.44 seconds
2023-03-14 03:26:00,745 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Pending
2023-03-14 03:26:00,745 - INFO - notready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:26:00,745 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf status:Running
2023-03-14 03:26:00,745 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-847589bfbf-f48hf
2023-03-14 03:26:00,745 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_BF16. Elapsed time: 110.48 seconds
2023-03-14 03:26:10,774 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Running
2023-03-14 03:26:10,774 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:26:10,774 - INFO - All 1 pods are ready for scenario AMX_BF16
2023-03-14 03:26:10,775 - INFO - Finished scenario AMX_BF16
2023-03-14 03:26:10,775 - INFO - wait for 2m to get stable metrics ...
2023-03-14 03:28:10,876 - INFO - Running benchmarking script for scenario AMX_BF16...
2023-03-14 03:28:10,887 - INFO - TS=20230314032810
2023-03-14 03:28:12,850 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:28:12,851 - INFO - Reading package lists...
2023-03-14 03:28:12,851 - INFO - Building dependency tree...
2023-03-14 03:28:12,851 - INFO - Reading state information...
2023-03-14 03:28:12,851 - INFO - linux-tools-5.15.0-60-generic is already the newest version (5.15.0-60.66).
2023-03-14 03:28:12,851 - INFO - sysstat is already the newest version (12.5.2-2ubuntu0.1).
2023-03-14 03:28:12,851 - INFO - The following packages were automatically installed and are no longer required:
2023-03-14 03:28:12,851 - INFO - cgroupfs-mount libltdl7 pigz
2023-03-14 03:28:12,851 - INFO - Use 'sudo apt autoremove' to remove them.
2023-03-14 03:28:12,851 - INFO - 0 upgraded, 0 newly installed, 0 to remove and 41 not upgraded.
2023-03-14 03:28:12,851 - INFO - WARNING: apt does not have a stable CLI interface. Use with caution in scripts.
2023-03-14 03:28:13,943 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:28:13,944 - INFO - 
2023-03-14 03:28:15,043 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:28:15,043 - INFO - performance
2023-03-14 03:28:15,140 - INFO - Run on test AiPipeline_20230314032810_83F2_AMX_BF16_6
2023-03-14 03:28:15,140 - INFO - TT=AiPipeline_20230314032810_83F2_AMX_BF16_6,WRKDIR=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 03:28:15,146 - INFO - -----------loop num:1/3------------
2023-03-14 03:28:25,152 - INFO - 1.  fetch_emon.sh
2023-03-14 03:28:25,153 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 03:28:26,432 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 03:28:26,432 - INFO - "ansible_facts": {
2023-03-14 03:28:26,432 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 03:28:26,432 - INFO - },
2023-03-14 03:28:26,432 - INFO - "changed": false,
2023-03-14 03:28:26,432 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 03:28:26,433 - INFO - "dest": "runemon.sh",
2023-03-14 03:28:26,433 - INFO - "gid": 1007,
2023-03-14 03:28:26,433 - INFO - "group": "ansible",
2023-03-14 03:28:26,433 - INFO - "mode": "0755",
2023-03-14 03:28:26,433 - INFO - "owner": "ansible",
2023-03-14 03:28:26,433 - INFO - "path": "runemon.sh",
2023-03-14 03:28:26,433 - INFO - "size": 452,
2023-03-14 03:28:26,433 - INFO - "state": "file",
2023-03-14 03:28:26,433 - INFO - "uid": 1006
2023-03-14 03:28:26,433 - INFO - }
2023-03-14 03:28:27,830 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 03:28:27,830 - INFO - "ansible_facts": {
2023-03-14 03:28:27,830 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 03:28:27,830 - INFO - },
2023-03-14 03:28:27,830 - INFO - "changed": false,
2023-03-14 03:28:27,830 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 03:28:27,831 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 03:28:27,831 - INFO - "gid": 1007,
2023-03-14 03:28:27,831 - INFO - "group": "ansible",
2023-03-14 03:28:27,831 - INFO - "mode": "0664",
2023-03-14 03:28:27,831 - INFO - "owner": "ansible",
2023-03-14 03:28:27,831 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 03:28:27,831 - INFO - "size": 23423,
2023-03-14 03:28:27,831 - INFO - "state": "file",
2023-03-14 03:28:27,831 - INFO - "uid": 1006
2023-03-14 03:28:27,831 - INFO - }
2023-03-14 03:28:28,890 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:28:28,890 - INFO - 
2023-03-14 03:28:29,947 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:28:29,947 - INFO - 
2023-03-14 03:28:30,040 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 03:28:35,043 - INFO - Collecting 30 seconds sar data background
2023-03-14 03:28:36,999 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:28:37,000 - INFO - 
2023-03-14 03:28:39,072 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:28:39,072 - INFO - 
2023-03-14 03:28:41,171 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:28:41,172 - INFO - 
2023-03-14 03:28:43,240 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:28:43,240 - INFO - 
2023-03-14 03:28:43,338 - INFO - Collecting EMON data
2023-03-14 03:29:14,925 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:29:14,926 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 03:29:14,926 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 03:29:14,926 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 03:29:14,926 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 03:29:14,927 - INFO - LD_LIBRARY_PATH=
2023-03-14 03:29:14,927 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 03:29:14,927 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 03:29:14,927 - INFO - EMON collector successfully stopped.
2023-03-14 03:29:15,039 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 03:29:45,042 - INFO - Copy dat files
2023-03-14 03:29:46,067 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:29:46,067 - INFO - "changed": true,
2023-03-14 03:29:46,068 - INFO - "checksum": "61aedfdf7d8fce50b2047fb9512bde2efdabbe58",
2023-03-14 03:29:46,068 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 03:29:46,068 - INFO - "md5sum": "eb22b2f0085f0b990639a2317ada626f",
2023-03-14 03:29:46,068 - INFO - "remote_checksum": "61aedfdf7d8fce50b2047fb9512bde2efdabbe58",
2023-03-14 03:29:46,068 - INFO - "remote_md5sum": null
2023-03-14 03:29:46,068 - INFO - }
2023-03-14 03:29:47,185 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:29:47,185 - INFO - "changed": true,
2023-03-14 03:29:47,186 - INFO - "checksum": "3da016b91c43b8327a8c036fd0787d8d61f946a9",
2023-03-14 03:29:47,186 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 03:29:47,186 - INFO - "md5sum": "c839a1a6f3fd3bdc9c0dcbddd5ac7e50",
2023-03-14 03:29:47,186 - INFO - "remote_checksum": "3da016b91c43b8327a8c036fd0787d8d61f946a9",
2023-03-14 03:29:47,186 - INFO - "remote_md5sum": null
2023-03-14 03:29:47,186 - INFO - }
2023-03-14 03:29:48,318 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:29:48,318 - INFO - "changed": true,
2023-03-14 03:29:48,319 - INFO - "checksum": "4edff58ba36a9afff476a424522a21d0d7556488",
2023-03-14 03:29:48,319 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 03:29:48,319 - INFO - "md5sum": "51002c0303d1e890958741eb2777e3bc",
2023-03-14 03:29:48,319 - INFO - "remote_checksum": "4edff58ba36a9afff476a424522a21d0d7556488",
2023-03-14 03:29:48,319 - INFO - "remote_md5sum": null
2023-03-14 03:29:48,319 - INFO - }
2023-03-14 03:29:49,460 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:29:49,461 - INFO - "changed": true,
2023-03-14 03:29:49,461 - INFO - "checksum": "122f60b292ca9eb34baf91ca988c4242957fd302",
2023-03-14 03:29:49,461 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 03:29:49,461 - INFO - "md5sum": "802f5f476434fb7af7db71533902b884",
2023-03-14 03:29:49,461 - INFO - "remote_checksum": "122f60b292ca9eb34baf91ca988c4242957fd302",
2023-03-14 03:29:49,461 - INFO - "remote_md5sum": null
2023-03-14 03:29:49,461 - INFO - }
2023-03-14 03:29:50,577 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:29:50,577 - INFO - "changed": true,
2023-03-14 03:29:50,577 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 03:29:50,577 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 03:29:50,577 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 03:29:50,577 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 03:29:50,578 - INFO - "remote_md5sum": null
2023-03-14 03:29:50,578 - INFO - }
2023-03-14 03:29:51,679 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:29:51,679 - INFO - "changed": true,
2023-03-14 03:29:51,679 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 03:29:51,680 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 03:29:51,680 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 03:29:51,680 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 03:29:51,680 - INFO - "remote_md5sum": null
2023-03-14 03:29:51,680 - INFO - }
2023-03-14 03:29:53,345 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:29:53,346 - INFO - "changed": true,
2023-03-14 03:29:53,346 - INFO - "checksum": "49e304f67635e16d76e118e8217f3fa7736b9867",
2023-03-14 03:29:53,346 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 03:29:53,346 - INFO - "md5sum": "d35662181d54dd8eab39fdfdf7a1594e",
2023-03-14 03:29:53,346 - INFO - "remote_checksum": "49e304f67635e16d76e118e8217f3fa7736b9867",
2023-03-14 03:29:53,346 - INFO - "remote_md5sum": null
2023-03-14 03:29:53,346 - INFO - }
2023-03-14 03:29:53,447 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 03:29:53,448 - INFO - 3.  collect the result
2023-03-14 03:29:53,608 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 03:29:53,609 - INFO - metric_name is: cpu_usage
2023-03-14 03:29:53,627 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678789793.601, '0.0714991444444422']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678789793.601, '0.06967531944444796']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678789793.601, '0.07064756666668472']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678789793.601, '0.07071054444443992']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678789793.601, '0.07179727777777063']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678789793.601, '0.06726307499999773']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678789793.601, '0.0011686388888891642']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod24fba7e0_3841_48e6_8f48_3f5725caeaa2.slice/cri-containerd-083f38a11ed8dc478448134a6ad0ee00ff8a95506c2f1745d343007cedff1db5.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '083f38a11ed8dc478448134a6ad0ee00ff8a95506c2f1745d343007cedff1db5', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq', 'service': 'kubelet'}, 'value': [1678789793.601, '50.42326652116499']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678789793.601, '0.009672908333328047']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678789793.601, '0.0010890305555562917']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678789793.601, '0.020216116666665583']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678789793.601, '0']}]
2023-03-14 03:29:53,627 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 03:29:53,627 - INFO - metric_name is: memory_usage
2023-03-14 03:29:53,627 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678789793.606, '386162688']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678789793.606, '386564096']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678789793.606, '386572288']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678789793.606, '386146304']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678789793.606, '386441216']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678789793.606, '386002944']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678789793.606, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq'}, 'value': [1678789793.606, '525000704']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678789793.606, '5093195776']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678789793.606, '15294464']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678789793.606, '2445004800']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678789793.606, '847872']}]
2023-03-14 03:29:53,627 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 03:29:53,627 - INFO - metric_name is: ei_infer_fps
2023-03-14 03:29:53,628 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.24:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678789793.61, '144.11574669315277']}]
2023-03-14 03:29:53,628 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 03:29:53,628 - INFO - metric_name is: ei_drop_fps
2023-03-14 03:29:53,628 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.24:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678789793.614, '26.103329105925827']}]
2023-03-14 03:29:53,628 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 03:29:53,628 - INFO - metric_name is: ei_scale_ratio
2023-03-14 03:29:53,628 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.24:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678789793.618, '1.182935439702762']}]
2023-03-14 03:29:53,628 - INFO - Results written to metrics/83F2_AMX_BF16_metrics_20230314_032953.txt
2023-03-14 03:29:53,695 - INFO - sleep 120 seconds for the next round ...
2023-03-14 03:31:53,698 - INFO - -----------loop num:2/3------------
2023-03-14 03:32:03,704 - INFO - 1.  fetch_emon.sh
2023-03-14 03:32:03,706 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 03:32:05,614 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 03:32:05,614 - INFO - "ansible_facts": {
2023-03-14 03:32:05,614 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 03:32:05,614 - INFO - },
2023-03-14 03:32:05,614 - INFO - "changed": false,
2023-03-14 03:32:05,614 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 03:32:05,615 - INFO - "dest": "runemon.sh",
2023-03-14 03:32:05,615 - INFO - "gid": 1007,
2023-03-14 03:32:05,615 - INFO - "group": "ansible",
2023-03-14 03:32:05,615 - INFO - "mode": "0755",
2023-03-14 03:32:05,615 - INFO - "owner": "ansible",
2023-03-14 03:32:05,615 - INFO - "path": "runemon.sh",
2023-03-14 03:32:05,615 - INFO - "size": 452,
2023-03-14 03:32:05,615 - INFO - "state": "file",
2023-03-14 03:32:05,615 - INFO - "uid": 1006
2023-03-14 03:32:05,615 - INFO - }
2023-03-14 03:32:06,983 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 03:32:06,984 - INFO - "ansible_facts": {
2023-03-14 03:32:06,984 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 03:32:06,984 - INFO - },
2023-03-14 03:32:06,984 - INFO - "changed": false,
2023-03-14 03:32:06,984 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 03:32:06,984 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 03:32:06,984 - INFO - "gid": 1007,
2023-03-14 03:32:06,984 - INFO - "group": "ansible",
2023-03-14 03:32:06,984 - INFO - "mode": "0664",
2023-03-14 03:32:06,985 - INFO - "owner": "ansible",
2023-03-14 03:32:06,985 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 03:32:06,985 - INFO - "size": 23423,
2023-03-14 03:32:06,985 - INFO - "state": "file",
2023-03-14 03:32:06,985 - INFO - "uid": 1006
2023-03-14 03:32:06,985 - INFO - }
2023-03-14 03:32:08,046 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:32:08,047 - INFO - 
2023-03-14 03:32:09,088 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:32:09,088 - INFO - 
2023-03-14 03:32:09,183 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 03:32:14,186 - INFO - Collecting 30 seconds sar data background
2023-03-14 03:32:16,163 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:32:16,164 - INFO - 
2023-03-14 03:32:18,224 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:32:18,225 - INFO - 
2023-03-14 03:32:20,248 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:32:20,248 - INFO - 
2023-03-14 03:32:22,320 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:32:22,321 - INFO - 
2023-03-14 03:32:22,417 - INFO - Collecting EMON data
2023-03-14 03:32:53,978 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:32:53,979 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 03:32:53,979 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 03:32:53,979 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 03:32:53,979 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 03:32:53,979 - INFO - LD_LIBRARY_PATH=
2023-03-14 03:32:53,979 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 03:32:53,979 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 03:32:53,980 - INFO - EMON collector successfully stopped.
2023-03-14 03:32:54,071 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 03:33:24,073 - INFO - Copy dat files
2023-03-14 03:33:25,112 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:33:25,112 - INFO - "changed": true,
2023-03-14 03:33:25,113 - INFO - "checksum": "e5d64a17b35c4475af4aea631e0881f78b0253f1",
2023-03-14 03:33:25,113 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 03:33:25,113 - INFO - "md5sum": "4aae0799b9e08e08f161e8b852b2f698",
2023-03-14 03:33:25,113 - INFO - "remote_checksum": "e5d64a17b35c4475af4aea631e0881f78b0253f1",
2023-03-14 03:33:25,113 - INFO - "remote_md5sum": null
2023-03-14 03:33:25,113 - INFO - }
2023-03-14 03:33:26,219 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:33:26,219 - INFO - "changed": true,
2023-03-14 03:33:26,219 - INFO - "checksum": "8d4703890c84d384b367e7c1c8fd3d04690eb30c",
2023-03-14 03:33:26,219 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 03:33:26,220 - INFO - "md5sum": "1be406579ce090335409c7684f3264b0",
2023-03-14 03:33:26,220 - INFO - "remote_checksum": "8d4703890c84d384b367e7c1c8fd3d04690eb30c",
2023-03-14 03:33:26,220 - INFO - "remote_md5sum": null
2023-03-14 03:33:26,220 - INFO - }
2023-03-14 03:33:27,364 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:33:27,364 - INFO - "changed": true,
2023-03-14 03:33:27,364 - INFO - "checksum": "b873adebac6fd896f9854aa23220464211d3dce3",
2023-03-14 03:33:27,364 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 03:33:27,364 - INFO - "md5sum": "5371e2db63c4483d8cbc09cc5ac3383f",
2023-03-14 03:33:27,364 - INFO - "remote_checksum": "b873adebac6fd896f9854aa23220464211d3dce3",
2023-03-14 03:33:27,365 - INFO - "remote_md5sum": null
2023-03-14 03:33:27,365 - INFO - }
2023-03-14 03:33:28,531 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:33:28,532 - INFO - "changed": true,
2023-03-14 03:33:28,532 - INFO - "checksum": "16e9cbebccd5af71c12844cc66355ed1236d2343",
2023-03-14 03:33:28,532 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 03:33:28,532 - INFO - "md5sum": "b02ff95a7b790aeac95cad5b981f8201",
2023-03-14 03:33:28,532 - INFO - "remote_checksum": "16e9cbebccd5af71c12844cc66355ed1236d2343",
2023-03-14 03:33:28,532 - INFO - "remote_md5sum": null
2023-03-14 03:33:28,532 - INFO - }
2023-03-14 03:33:29,680 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:33:29,680 - INFO - "changed": true,
2023-03-14 03:33:29,680 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 03:33:29,681 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 03:33:29,681 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 03:33:29,681 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 03:33:29,681 - INFO - "remote_md5sum": null
2023-03-14 03:33:29,681 - INFO - }
2023-03-14 03:33:30,776 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:33:30,776 - INFO - "changed": true,
2023-03-14 03:33:30,777 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 03:33:30,777 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 03:33:30,777 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 03:33:30,777 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 03:33:30,777 - INFO - "remote_md5sum": null
2023-03-14 03:33:30,777 - INFO - }
2023-03-14 03:33:32,381 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:33:32,382 - INFO - "changed": true,
2023-03-14 03:33:32,382 - INFO - "checksum": "4766644e5ff89d6d465d647ae367db21b1ee445a",
2023-03-14 03:33:32,382 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 03:33:32,382 - INFO - "md5sum": "c623ce7bd575eae1e20baaa132169e4c",
2023-03-14 03:33:32,382 - INFO - "remote_checksum": "4766644e5ff89d6d465d647ae367db21b1ee445a",
2023-03-14 03:33:32,382 - INFO - "remote_md5sum": null
2023-03-14 03:33:32,382 - INFO - }
2023-03-14 03:33:32,477 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 03:33:32,478 - INFO - 3.  collect the result
2023-03-14 03:33:32,639 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 03:33:32,640 - INFO - metric_name is: cpu_usage
2023-03-14 03:33:32,655 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678790012.632, '0.0751403416666714']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678790012.632, '0.07821974444444398']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678790012.632, '0.07271472777777793']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678790012.632, '0.07260848611112021']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678790012.632, '0.07017087222220651']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678790012.632, '0.0751648722222146']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678790012.632, '0.0011282249999999925']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod24fba7e0_3841_48e6_8f48_3f5725caeaa2.slice/cri-containerd-083f38a11ed8dc478448134a6ad0ee00ff8a95506c2f1745d343007cedff1db5.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '083f38a11ed8dc478448134a6ad0ee00ff8a95506c2f1745d343007cedff1db5', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq', 'service': 'kubelet'}, 'value': [1678790012.632, '49.81370116388889']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678790012.632, '0.010513133333334836']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678790012.632, '0.001104769444445234']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678790012.632, '0.018809372222224535']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678790012.632, '0']}]
2023-03-14 03:33:32,655 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 03:33:32,655 - INFO - metric_name is: memory_usage
2023-03-14 03:33:32,655 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678790012.637, '386293760']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678790012.637, '386543616']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678790012.637, '386445312']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678790012.637, '386146304']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678790012.637, '386621440']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678790012.637, '386007040']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678790012.637, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq'}, 'value': [1678790012.637, '524242944']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678790012.637, '5093154816']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678790012.637, '15294464']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678790012.637, '2445348864']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678790012.637, '847872']}]
2023-03-14 03:33:32,656 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 03:33:32,656 - INFO - metric_name is: ei_infer_fps
2023-03-14 03:33:32,656 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.24:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678790012.641, '142.2913449096273']}]
2023-03-14 03:33:32,656 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 03:33:32,656 - INFO - metric_name is: ei_drop_fps
2023-03-14 03:33:32,656 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.24:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678790012.645, '27.040945309910835']}]
2023-03-14 03:33:32,656 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 03:33:32,656 - INFO - metric_name is: ei_scale_ratio
2023-03-14 03:33:32,656 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.24:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678790012.648, '1.1929317676002156']}]
2023-03-14 03:33:32,656 - INFO - Results written to metrics/83F2_AMX_BF16_metrics_20230314_033332.txt
2023-03-14 03:33:32,725 - INFO - sleep 120 seconds for the next round ...
2023-03-14 03:35:32,728 - INFO - -----------loop num:3/3------------
2023-03-14 03:35:42,734 - INFO - 1.  fetch_emon.sh
2023-03-14 03:35:42,735 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 03:35:44,671 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 03:35:44,672 - INFO - "ansible_facts": {
2023-03-14 03:35:44,672 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 03:35:44,672 - INFO - },
2023-03-14 03:35:44,672 - INFO - "changed": false,
2023-03-14 03:35:44,672 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 03:35:44,672 - INFO - "dest": "runemon.sh",
2023-03-14 03:35:44,672 - INFO - "gid": 1007,
2023-03-14 03:35:44,672 - INFO - "group": "ansible",
2023-03-14 03:35:44,673 - INFO - "mode": "0755",
2023-03-14 03:35:44,673 - INFO - "owner": "ansible",
2023-03-14 03:35:44,673 - INFO - "path": "runemon.sh",
2023-03-14 03:35:44,673 - INFO - "size": 452,
2023-03-14 03:35:44,673 - INFO - "state": "file",
2023-03-14 03:35:44,673 - INFO - "uid": 1006
2023-03-14 03:35:44,673 - INFO - }
2023-03-14 03:35:46,058 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 03:35:46,058 - INFO - "ansible_facts": {
2023-03-14 03:35:46,059 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 03:35:46,059 - INFO - },
2023-03-14 03:35:46,059 - INFO - "changed": false,
2023-03-14 03:35:46,059 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 03:35:46,059 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 03:35:46,059 - INFO - "gid": 1007,
2023-03-14 03:35:46,059 - INFO - "group": "ansible",
2023-03-14 03:35:46,059 - INFO - "mode": "0664",
2023-03-14 03:35:46,059 - INFO - "owner": "ansible",
2023-03-14 03:35:46,059 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 03:35:46,059 - INFO - "size": 23423,
2023-03-14 03:35:46,060 - INFO - "state": "file",
2023-03-14 03:35:46,060 - INFO - "uid": 1006
2023-03-14 03:35:46,060 - INFO - }
2023-03-14 03:35:47,134 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:35:47,134 - INFO - 
2023-03-14 03:35:48,181 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:35:48,181 - INFO - 
2023-03-14 03:35:48,280 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 03:35:53,282 - INFO - Collecting 30 seconds sar data background
2023-03-14 03:35:55,249 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:35:55,250 - INFO - 
2023-03-14 03:35:57,302 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:35:57,302 - INFO - 
2023-03-14 03:35:59,357 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:35:59,357 - INFO - 
2023-03-14 03:36:01,444 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:36:01,444 - INFO - 
2023-03-14 03:36:01,546 - INFO - Collecting EMON data
2023-03-14 03:36:33,099 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:36:33,100 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 03:36:33,100 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 03:36:33,100 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 03:36:33,100 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 03:36:33,100 - INFO - LD_LIBRARY_PATH=
2023-03-14 03:36:33,100 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 03:36:33,100 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 03:36:33,100 - INFO - EMON collector successfully stopped.
2023-03-14 03:36:33,315 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 03:37:03,318 - INFO - Copy dat files
2023-03-14 03:37:04,331 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:37:04,331 - INFO - "changed": true,
2023-03-14 03:37:04,331 - INFO - "checksum": "0daba1b9b32625af92a6969aa5cdeabe90bb1f5b",
2023-03-14 03:37:04,331 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 03:37:04,331 - INFO - "md5sum": "c6dd7a0df6eb29a70c6f583464c6a9cc",
2023-03-14 03:37:04,331 - INFO - "remote_checksum": "0daba1b9b32625af92a6969aa5cdeabe90bb1f5b",
2023-03-14 03:37:04,331 - INFO - "remote_md5sum": null
2023-03-14 03:37:04,332 - INFO - }
2023-03-14 03:37:05,572 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:37:05,572 - INFO - "changed": true,
2023-03-14 03:37:05,572 - INFO - "checksum": "5812aa19b46b8c9ab064db0d7c0cb69cd684f7d2",
2023-03-14 03:37:05,572 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 03:37:05,572 - INFO - "md5sum": "36f30f099eb5002ccf65b47689ce0e71",
2023-03-14 03:37:05,572 - INFO - "remote_checksum": "5812aa19b46b8c9ab064db0d7c0cb69cd684f7d2",
2023-03-14 03:37:05,572 - INFO - "remote_md5sum": null
2023-03-14 03:37:05,573 - INFO - }
2023-03-14 03:37:06,688 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:37:06,688 - INFO - "changed": true,
2023-03-14 03:37:06,688 - INFO - "checksum": "d1a2f09010fdc890f32c0b65c0dc2bb63435e2f5",
2023-03-14 03:37:06,688 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 03:37:06,688 - INFO - "md5sum": "3c1b389942a6db3f07f4ed9912d6e5e4",
2023-03-14 03:37:06,688 - INFO - "remote_checksum": "d1a2f09010fdc890f32c0b65c0dc2bb63435e2f5",
2023-03-14 03:37:06,689 - INFO - "remote_md5sum": null
2023-03-14 03:37:06,689 - INFO - }
2023-03-14 03:37:07,842 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:37:07,842 - INFO - "changed": true,
2023-03-14 03:37:07,842 - INFO - "checksum": "391b8b3150f5a05b53a9888dd30a6d3d3823014a",
2023-03-14 03:37:07,842 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 03:37:07,842 - INFO - "md5sum": "c885fe5e436c21a1c3d60ae89dd1ceaf",
2023-03-14 03:37:07,842 - INFO - "remote_checksum": "391b8b3150f5a05b53a9888dd30a6d3d3823014a",
2023-03-14 03:37:07,843 - INFO - "remote_md5sum": null
2023-03-14 03:37:07,843 - INFO - }
2023-03-14 03:37:08,956 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:37:08,957 - INFO - "changed": true,
2023-03-14 03:37:08,957 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 03:37:08,957 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 03:37:08,957 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 03:37:08,957 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 03:37:08,957 - INFO - "remote_md5sum": null
2023-03-14 03:37:08,957 - INFO - }
2023-03-14 03:37:10,077 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:37:10,078 - INFO - "changed": true,
2023-03-14 03:37:10,078 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 03:37:10,078 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 03:37:10,078 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 03:37:10,078 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 03:37:10,078 - INFO - "remote_md5sum": null
2023-03-14 03:37:10,078 - INFO - }
2023-03-14 03:37:11,684 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:37:11,685 - INFO - "changed": true,
2023-03-14 03:37:11,685 - INFO - "checksum": "7805ef6df619dbc8b91df8955d398e7c15c40b09",
2023-03-14 03:37:11,685 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 03:37:11,685 - INFO - "md5sum": "81856f89f74d4b9e77a98dee848151c3",
2023-03-14 03:37:11,685 - INFO - "remote_checksum": "7805ef6df619dbc8b91df8955d398e7c15c40b09",
2023-03-14 03:37:11,685 - INFO - "remote_md5sum": null
2023-03-14 03:37:11,685 - INFO - }
2023-03-14 03:37:11,786 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 03:37:11,786 - INFO - 3.  collect the result
2023-03-14 03:37:11,930 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 03:37:11,930 - INFO - metric_name is: cpu_usage
2023-03-14 03:37:11,945 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678790231.923, '0.07107267499999984']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678790231.923, '0.07318988333333133']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678790231.923, '0.06955132222222649']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678790231.923, '0.07651390277777763']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678790231.923, '0.07553885277778438']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678790231.923, '0.0738035666666595']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678790231.923, '0.0012713194444447455']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod24fba7e0_3841_48e6_8f48_3f5725caeaa2.slice/cri-containerd-083f38a11ed8dc478448134a6ad0ee00ff8a95506c2f1745d343007cedff1db5.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '083f38a11ed8dc478448134a6ad0ee00ff8a95506c2f1745d343007cedff1db5', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq', 'service': 'kubelet'}, 'value': [1678790231.923, '50.00712070833332']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678790231.923, '0.009718511111112901']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678790231.923, '0.0011167999999997847']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678790231.923, '0.019219850000003032']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678790231.923, '0']}]
2023-03-14 03:37:11,946 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 03:37:11,946 - INFO - metric_name is: memory_usage
2023-03-14 03:37:11,946 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678790231.927, '386166784']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678790231.927, '386560000']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678790231.927, '386551808']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678790231.927, '386146304']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678790231.927, '386494464']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678790231.927, '386134016']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678790231.927, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq'}, 'value': [1678790231.927, '524242944']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678790231.927, '5093269504']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678790231.927, '15167488']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678790231.927, '2445066240']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678790231.927, '847872']}]
2023-03-14 03:37:11,946 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 03:37:11,946 - INFO - metric_name is: ei_infer_fps
2023-03-14 03:37:11,946 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.24:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678790231.932, '147.1139812574034']}]
2023-03-14 03:37:11,946 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 03:37:11,946 - INFO - metric_name is: ei_drop_fps
2023-03-14 03:37:11,947 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.24:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678790231.935, '23.10692004971437']}]
2023-03-14 03:37:11,947 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 03:37:11,947 - INFO - metric_name is: ei_scale_ratio
2023-03-14 03:37:11,947 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.24:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678790231.939, '1.1575776741000636']}]
2023-03-14 03:37:11,947 - INFO - Results written to metrics/83F2_AMX_BF16_metrics_20230314_033711.txt
2023-03-14 03:37:12,013 - INFO - ------------- scenario: 2/5 ------------
2023-03-14 03:37:12,013 - INFO - Begin set_deployment_env of scenario : NON_AMX_BF16 ...
2023-03-14 03:37:12,063 - INFO - Setting environment variables for scenario NON_AMX_BF16...
2023-03-14 03:37:12,083 - INFO - Setting resource requests and limits for scenario NON_AMX_BF16...
2023-03-14 03:37:12,102 - INFO - after patch_body
2023-03-14 03:37:12,102 - INFO - Waiting for 1 pods to be ready for scenario NON_AMX_BF16...
2023-03-14 03:37:12,165 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq status:Running
2023-03-14 03:37:12,166 - INFO - ready_pods.append :ei-infer-deployment-pose-bf16-amx-01-78f8c89bb7-zxnkq
2023-03-14 03:37:12,166 - INFO - All 1 pods are ready for scenario NON_AMX_BF16
2023-03-14 03:37:12,167 - INFO - Finished scenario NON_AMX_BF16
2023-03-14 03:37:12,167 - INFO - wait for 2m to get stable metrics ...
2023-03-14 03:42:53,434 - INFO - Starting batch deployment...
2023-03-14 03:43:45,915 - INFO - Starting batch deployment...
2023-03-14 03:43:45,917 - INFO - ------------- scenario: 1/4 ------------
2023-03-14 03:43:45,917 - INFO - Begin set_deployment_env of scenario : NON_AMX_BF16 ...
2023-03-14 03:43:45,956 - INFO - Setting environment variables for scenario NON_AMX_BF16...
2023-03-14 03:43:45,978 - INFO - Setting resource requests and limits for scenario NON_AMX_BF16...
2023-03-14 03:43:45,997 - INFO - after patch_body wait for 30 seconds to enable the new pods
2023-03-14 03:44:16,027 - INFO - Waiting for 1 pods to be ready for scenario NON_AMX_BF16...
2023-03-14 03:44:16,110 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:44:16,110 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:44:16,110 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 0.08 seconds
2023-03-14 03:44:26,148 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:44:26,149 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:44:26,149 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 10.12 seconds
2023-03-14 03:44:36,185 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:44:36,186 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:44:36,186 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 20.16 seconds
2023-03-14 03:44:46,223 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:44:46,223 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:44:46,223 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 30.20 seconds
2023-03-14 03:44:56,260 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:44:56,260 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:44:56,260 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 40.23 seconds
2023-03-14 03:45:06,295 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:45:06,296 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:45:06,296 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 50.27 seconds
2023-03-14 03:45:16,343 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:45:16,343 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:45:16,343 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 60.32 seconds
2023-03-14 03:45:26,380 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:45:26,381 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:45:26,381 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 70.35 seconds
2023-03-14 03:45:36,418 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:45:36,419 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:45:36,419 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 80.39 seconds
2023-03-14 03:45:46,456 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:45:46,456 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:45:46,456 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 90.43 seconds
2023-03-14 03:45:56,504 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:45:56,504 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:45:56,504 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 100.48 seconds
2023-03-14 03:46:06,540 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:46:06,540 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:46:06,540 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 110.51 seconds
2023-03-14 03:46:17,002 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:46:17,002 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:46:17,002 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 120.97 seconds
2023-03-14 03:46:27,034 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:46:27,034 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:46:27,034 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 131.01 seconds
2023-03-14 03:46:37,067 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:46:37,068 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:46:37,068 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 141.04 seconds
2023-03-14 03:46:47,105 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:46:47,105 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:46:47,105 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 151.08 seconds
2023-03-14 03:46:57,141 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:46:57,142 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:46:57,142 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 161.11 seconds
2023-03-14 03:47:07,178 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:47:07,178 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:47:07,178 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 171.15 seconds
2023-03-14 03:47:17,216 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:47:17,216 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:47:17,216 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 181.19 seconds
2023-03-14 03:47:27,253 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:47:27,253 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:47:27,253 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 191.23 seconds
2023-03-14 03:47:37,292 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:47:37,292 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:47:37,292 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 201.26 seconds
2023-03-14 03:47:47,329 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:47:47,329 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:47:47,329 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 211.30 seconds
2023-03-14 03:47:57,367 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:47:57,368 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:47:57,368 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 221.34 seconds
2023-03-14 03:48:07,404 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:48:07,405 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:48:07,405 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 231.38 seconds
2023-03-14 03:48:17,439 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:48:17,440 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:48:17,440 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 241.41 seconds
2023-03-14 03:48:27,476 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:48:27,476 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:48:27,476 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 251.45 seconds
2023-03-14 03:48:37,512 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:48:37,513 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:48:37,513 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 261.48 seconds
2023-03-14 03:48:47,549 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:48:47,549 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:48:47,549 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 271.52 seconds
2023-03-14 03:48:57,585 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:48:57,585 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:48:57,585 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 281.56 seconds
2023-03-14 03:49:07,620 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:49:07,621 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:49:07,621 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 291.59 seconds
2023-03-14 03:49:17,657 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:49:17,657 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:49:17,657 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 301.63 seconds
2023-03-14 03:49:27,686 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:49:27,686 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:49:27,686 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 311.66 seconds
2023-03-14 03:49:37,723 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:49:37,723 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:49:37,724 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 321.70 seconds
2023-03-14 03:49:47,760 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:49:47,760 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:49:47,760 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 331.73 seconds
2023-03-14 03:49:57,797 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:49:57,797 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:49:57,798 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 341.77 seconds
2023-03-14 03:50:07,835 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:50:07,835 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:50:07,835 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 351.81 seconds
2023-03-14 03:50:17,871 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:50:17,871 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:50:17,872 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 361.84 seconds
2023-03-14 03:50:27,908 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:50:27,908 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:50:27,908 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 371.88 seconds
2023-03-14 03:50:37,945 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:50:37,945 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:50:37,945 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 381.92 seconds
2023-03-14 03:50:47,982 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:50:47,982 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:50:47,982 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 391.95 seconds
2023-03-14 03:50:58,015 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:50:58,016 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:50:58,016 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 401.99 seconds
2023-03-14 03:51:08,053 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:51:08,054 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:51:08,054 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 412.03 seconds
2023-03-14 03:51:18,090 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-59f74ff9dd-lbj2p status:Running
2023-03-14 03:51:18,091 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Pending
2023-03-14 03:51:18,091 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario NON_AMX_BF16. Elapsed time: 422.06 seconds
2023-03-14 03:51:28,120 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 03:51:28,120 - INFO - All 1 pods are ready for scenario NON_AMX_BF16
2023-03-14 03:51:28,121 - INFO - Finished scenario NON_AMX_BF16
2023-03-14 03:51:28,121 - INFO - wait for 2m to get stable metrics ...
2023-03-14 03:53:28,222 - INFO - Running benchmarking script for scenario NON_AMX_BF16...
2023-03-14 03:53:28,233 - INFO - TS=20230314035328
2023-03-14 03:53:30,288 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:53:30,288 - INFO - Reading package lists...
2023-03-14 03:53:30,288 - INFO - Building dependency tree...
2023-03-14 03:53:30,288 - INFO - Reading state information...
2023-03-14 03:53:30,288 - INFO - linux-tools-5.15.0-60-generic is already the newest version (5.15.0-60.66).
2023-03-14 03:53:30,288 - INFO - sysstat is already the newest version (12.5.2-2ubuntu0.1).
2023-03-14 03:53:30,288 - INFO - The following packages were automatically installed and are no longer required:
2023-03-14 03:53:30,289 - INFO - cgroupfs-mount libltdl7 pigz
2023-03-14 03:53:30,289 - INFO - Use 'sudo apt autoremove' to remove them.
2023-03-14 03:53:30,289 - INFO - 0 upgraded, 0 newly installed, 0 to remove and 41 not upgraded.
2023-03-14 03:53:30,289 - INFO - WARNING: apt does not have a stable CLI interface. Use with caution in scripts.
2023-03-14 03:53:31,376 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:53:31,376 - INFO - 
2023-03-14 03:53:32,412 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:53:32,412 - INFO - performance
2023-03-14 03:53:32,510 - INFO - Run on test AiPipeline_20230314035328_7573_NON_AMX_BF16_6
2023-03-14 03:53:32,510 - INFO - TT=AiPipeline_20230314035328_7573_NON_AMX_BF16_6,WRKDIR=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 03:53:32,516 - INFO - -----------loop num:1/3------------
2023-03-14 03:53:42,520 - INFO - 1.  fetch_emon.sh
2023-03-14 03:53:42,522 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 03:53:43,833 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 03:53:43,833 - INFO - "ansible_facts": {
2023-03-14 03:53:43,834 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 03:53:43,834 - INFO - },
2023-03-14 03:53:43,834 - INFO - "changed": false,
2023-03-14 03:53:43,834 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 03:53:43,834 - INFO - "dest": "runemon.sh",
2023-03-14 03:53:43,834 - INFO - "gid": 1007,
2023-03-14 03:53:43,834 - INFO - "group": "ansible",
2023-03-14 03:53:43,834 - INFO - "mode": "0755",
2023-03-14 03:53:43,834 - INFO - "owner": "ansible",
2023-03-14 03:53:43,834 - INFO - "path": "runemon.sh",
2023-03-14 03:53:43,834 - INFO - "size": 452,
2023-03-14 03:53:43,834 - INFO - "state": "file",
2023-03-14 03:53:43,835 - INFO - "uid": 1006
2023-03-14 03:53:43,835 - INFO - }
2023-03-14 03:53:45,283 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 03:53:45,283 - INFO - "ansible_facts": {
2023-03-14 03:53:45,284 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 03:53:45,284 - INFO - },
2023-03-14 03:53:45,284 - INFO - "changed": false,
2023-03-14 03:53:45,284 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 03:53:45,284 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 03:53:45,284 - INFO - "gid": 1007,
2023-03-14 03:53:45,284 - INFO - "group": "ansible",
2023-03-14 03:53:45,284 - INFO - "mode": "0664",
2023-03-14 03:53:45,284 - INFO - "owner": "ansible",
2023-03-14 03:53:45,284 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 03:53:45,284 - INFO - "size": 23423,
2023-03-14 03:53:45,284 - INFO - "state": "file",
2023-03-14 03:53:45,285 - INFO - "uid": 1006
2023-03-14 03:53:45,285 - INFO - }
2023-03-14 03:53:46,367 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:53:46,367 - INFO - 
2023-03-14 03:53:47,465 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:53:47,465 - INFO - 
2023-03-14 03:53:47,559 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 03:53:52,562 - INFO - Collecting 30 seconds sar data background
2023-03-14 03:53:54,567 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:53:54,568 - INFO - 
2023-03-14 03:53:56,637 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:53:56,638 - INFO - 
2023-03-14 03:53:58,697 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:53:58,697 - INFO - 
2023-03-14 03:54:00,846 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:54:00,846 - INFO - 
2023-03-14 03:54:00,942 - INFO - Collecting EMON data
2023-03-14 03:54:32,480 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:54:32,481 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 03:54:32,481 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 03:54:32,481 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 03:54:32,481 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 03:54:32,481 - INFO - LD_LIBRARY_PATH=
2023-03-14 03:54:32,481 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 03:54:32,481 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 03:54:32,481 - INFO - EMON collector successfully stopped.
2023-03-14 03:54:32,587 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 03:55:02,589 - INFO - Copy dat files
2023-03-14 03:55:03,688 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:55:03,688 - INFO - "changed": true,
2023-03-14 03:55:03,689 - INFO - "checksum": "3dc07a9b7b4d1199eaeb1485c90bb54ac87df8f2",
2023-03-14 03:55:03,689 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 03:55:03,689 - INFO - "md5sum": "9c62dcf1d6e214c442b8573b95f1d393",
2023-03-14 03:55:03,689 - INFO - "remote_checksum": "3dc07a9b7b4d1199eaeb1485c90bb54ac87df8f2",
2023-03-14 03:55:03,689 - INFO - "remote_md5sum": null
2023-03-14 03:55:03,689 - INFO - }
2023-03-14 03:55:04,881 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:55:04,881 - INFO - "changed": true,
2023-03-14 03:55:04,882 - INFO - "checksum": "52536d22ceb867d712253e5b4bb38f72e2198a95",
2023-03-14 03:55:04,882 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 03:55:04,882 - INFO - "md5sum": "6388baaa5f89b67e8824c0a3a27c3c3d",
2023-03-14 03:55:04,882 - INFO - "remote_checksum": "52536d22ceb867d712253e5b4bb38f72e2198a95",
2023-03-14 03:55:04,882 - INFO - "remote_md5sum": null
2023-03-14 03:55:04,882 - INFO - }
2023-03-14 03:55:05,989 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:55:05,990 - INFO - "changed": true,
2023-03-14 03:55:05,990 - INFO - "checksum": "6703040675ecf784a3f696dd8aba9c156067e525",
2023-03-14 03:55:05,990 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 03:55:05,990 - INFO - "md5sum": "62c2dd88cf8b29653e784922b9fd4425",
2023-03-14 03:55:05,990 - INFO - "remote_checksum": "6703040675ecf784a3f696dd8aba9c156067e525",
2023-03-14 03:55:05,990 - INFO - "remote_md5sum": null
2023-03-14 03:55:05,990 - INFO - }
2023-03-14 03:55:07,181 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:55:07,181 - INFO - "changed": true,
2023-03-14 03:55:07,181 - INFO - "checksum": "ff49d6d09a6629273e396daea670490c13301672",
2023-03-14 03:55:07,181 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 03:55:07,181 - INFO - "md5sum": "68426a780b0efc1888096c3f1aa843fb",
2023-03-14 03:55:07,181 - INFO - "remote_checksum": "ff49d6d09a6629273e396daea670490c13301672",
2023-03-14 03:55:07,182 - INFO - "remote_md5sum": null
2023-03-14 03:55:07,182 - INFO - }
2023-03-14 03:55:08,310 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:55:08,311 - INFO - "changed": true,
2023-03-14 03:55:08,311 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 03:55:08,311 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 03:55:08,311 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 03:55:08,311 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 03:55:08,311 - INFO - "remote_md5sum": null
2023-03-14 03:55:08,311 - INFO - }
2023-03-14 03:55:09,390 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:55:09,391 - INFO - "changed": true,
2023-03-14 03:55:09,391 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 03:55:09,391 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 03:55:09,391 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 03:55:09,391 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 03:55:09,391 - INFO - "remote_md5sum": null
2023-03-14 03:55:09,391 - INFO - }
2023-03-14 03:55:11,238 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:55:11,238 - INFO - "changed": true,
2023-03-14 03:55:11,238 - INFO - "checksum": "63cd7b444cef7b302112c781f72f5c162ab28a7c",
2023-03-14 03:55:11,238 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 03:55:11,238 - INFO - "md5sum": "164c9e86625153c38d5ce5835649ef98",
2023-03-14 03:55:11,238 - INFO - "remote_checksum": "63cd7b444cef7b302112c781f72f5c162ab28a7c",
2023-03-14 03:55:11,238 - INFO - "remote_md5sum": null
2023-03-14 03:55:11,239 - INFO - }
2023-03-14 03:55:11,342 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 03:55:11,342 - INFO - 3.  collect the result
2023-03-14 03:55:11,506 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 03:55:11,506 - INFO - metric_name is: cpu_usage
2023-03-14 03:55:11,521 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678791311.498, '0.07187960833333717']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678791311.498, '0.07565950555556103']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678791311.498, '0.06795653888888814']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678791311.498, '0.07581214444444412']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678791311.498, '0.06486318888887076']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678791311.498, '0.07642904166666792']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678791311.498, '0.0009491333333329521']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod9725ba63_d422_4851_a274_771a8ec615b6.slice/cri-containerd-ad361212f7e5cf5d08f33692562b3b5b53835cbd99b4d399a3e06a901303d4d7.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'ad361212f7e5cf5d08f33692562b3b5b53835cbd99b4d399a3e06a901303d4d7', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx', 'service': 'kubelet'}, 'value': [1678791311.498, '50.31693000833333']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678791311.498, '0.009398583333333791']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678791311.498, '0.001139294444444911']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678791311.498, '0.017581463888889932']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678791311.498, '0']}]
2023-03-14 03:55:11,522 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 03:55:11,522 - INFO - metric_name is: memory_usage
2023-03-14 03:55:11,522 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678791311.503, '386162688']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678791311.503, '386437120']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678791311.503, '386699264']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678791311.503, '386150400']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678791311.503, '386494464']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678791311.503, '386134016']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678791311.503, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx'}, 'value': [1678791311.503, '539275264']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678791311.503, '5093126144']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678791311.503, '15958016']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678791311.503, '2445230080']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678791311.503, '847872']}]
2023-03-14 03:55:11,522 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 03:55:11,522 - INFO - metric_name is: ei_infer_fps
2023-03-14 03:55:11,522 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.11:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678791311.507, '114.31940953940355']}]
2023-03-14 03:55:11,522 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 03:55:11,522 - INFO - metric_name is: ei_drop_fps
2023-03-14 03:55:11,522 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.11:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678791311.511, '55.43571669773687']}]
2023-03-14 03:55:11,522 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 03:55:11,522 - INFO - metric_name is: ei_scale_ratio
2023-03-14 03:55:11,523 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.11:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678791311.514, '1.4850862970742575']}]
2023-03-14 03:55:11,526 - INFO - Results written to metrics/7573_NON_AMX_BF16_metrics_20230314_035511.txt
2023-03-14 03:55:11,589 - INFO - sleep 120 seconds for the next round ...
2023-03-14 03:57:11,592 - INFO - -----------loop num:2/3------------
2023-03-14 03:57:21,598 - INFO - 1.  fetch_emon.sh
2023-03-14 03:57:21,600 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 03:57:23,487 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 03:57:23,487 - INFO - "ansible_facts": {
2023-03-14 03:57:23,487 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 03:57:23,487 - INFO - },
2023-03-14 03:57:23,487 - INFO - "changed": false,
2023-03-14 03:57:23,488 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 03:57:23,488 - INFO - "dest": "runemon.sh",
2023-03-14 03:57:23,488 - INFO - "gid": 1007,
2023-03-14 03:57:23,488 - INFO - "group": "ansible",
2023-03-14 03:57:23,488 - INFO - "mode": "0755",
2023-03-14 03:57:23,488 - INFO - "owner": "ansible",
2023-03-14 03:57:23,488 - INFO - "path": "runemon.sh",
2023-03-14 03:57:23,488 - INFO - "size": 452,
2023-03-14 03:57:23,488 - INFO - "state": "file",
2023-03-14 03:57:23,488 - INFO - "uid": 1006
2023-03-14 03:57:23,488 - INFO - }
2023-03-14 03:57:24,906 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 03:57:24,906 - INFO - "ansible_facts": {
2023-03-14 03:57:24,907 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 03:57:24,907 - INFO - },
2023-03-14 03:57:24,907 - INFO - "changed": false,
2023-03-14 03:57:24,907 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 03:57:24,907 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 03:57:24,907 - INFO - "gid": 1007,
2023-03-14 03:57:24,907 - INFO - "group": "ansible",
2023-03-14 03:57:24,907 - INFO - "mode": "0664",
2023-03-14 03:57:24,907 - INFO - "owner": "ansible",
2023-03-14 03:57:24,907 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 03:57:24,907 - INFO - "size": 23423,
2023-03-14 03:57:24,908 - INFO - "state": "file",
2023-03-14 03:57:24,908 - INFO - "uid": 1006
2023-03-14 03:57:24,908 - INFO - }
2023-03-14 03:57:25,982 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:57:25,983 - INFO - 
2023-03-14 03:57:27,131 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:57:27,131 - INFO - 
2023-03-14 03:57:27,229 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 03:57:32,231 - INFO - Collecting 30 seconds sar data background
2023-03-14 03:57:34,201 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:57:34,201 - INFO - 
2023-03-14 03:57:36,291 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:57:36,291 - INFO - 
2023-03-14 03:57:38,359 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:57:38,360 - INFO - 
2023-03-14 03:57:40,425 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:57:40,426 - INFO - 
2023-03-14 03:57:40,527 - INFO - Collecting EMON data
2023-03-14 03:58:12,020 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 03:58:12,021 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 03:58:12,021 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 03:58:12,021 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 03:58:12,021 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 03:58:12,021 - INFO - LD_LIBRARY_PATH=
2023-03-14 03:58:12,021 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 03:58:12,022 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 03:58:12,022 - INFO - EMON collector successfully stopped.
2023-03-14 03:58:12,136 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 03:58:42,139 - INFO - Copy dat files
2023-03-14 03:58:43,151 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:58:43,151 - INFO - "changed": true,
2023-03-14 03:58:43,151 - INFO - "checksum": "5128d343ad7fbe92b1e6512195233909ea0801c5",
2023-03-14 03:58:43,151 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 03:58:43,151 - INFO - "md5sum": "552872d3db5559caaf82de5eded120b7",
2023-03-14 03:58:43,151 - INFO - "remote_checksum": "5128d343ad7fbe92b1e6512195233909ea0801c5",
2023-03-14 03:58:43,152 - INFO - "remote_md5sum": null
2023-03-14 03:58:43,152 - INFO - }
2023-03-14 03:58:44,293 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:58:44,293 - INFO - "changed": true,
2023-03-14 03:58:44,293 - INFO - "checksum": "5ffc1e296c51671514e9820f3d68e0b6586f3c94",
2023-03-14 03:58:44,294 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 03:58:44,294 - INFO - "md5sum": "5adc1ff5d29e46a02ae3a3481a95e27f",
2023-03-14 03:58:44,294 - INFO - "remote_checksum": "5ffc1e296c51671514e9820f3d68e0b6586f3c94",
2023-03-14 03:58:44,294 - INFO - "remote_md5sum": null
2023-03-14 03:58:44,294 - INFO - }
2023-03-14 03:58:45,397 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:58:45,398 - INFO - "changed": true,
2023-03-14 03:58:45,398 - INFO - "checksum": "3160db29ce7bb51177f67c81740f7c4cbb874729",
2023-03-14 03:58:45,398 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 03:58:45,398 - INFO - "md5sum": "d221be4b0f335bd2beef75e7c8f0a9a0",
2023-03-14 03:58:45,398 - INFO - "remote_checksum": "3160db29ce7bb51177f67c81740f7c4cbb874729",
2023-03-14 03:58:45,398 - INFO - "remote_md5sum": null
2023-03-14 03:58:45,398 - INFO - }
2023-03-14 03:58:46,544 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:58:46,544 - INFO - "changed": true,
2023-03-14 03:58:46,544 - INFO - "checksum": "8ee12eb745c776b64e7daa1f41150303693f8869",
2023-03-14 03:58:46,544 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 03:58:46,544 - INFO - "md5sum": "ab8f5ccc852be1b3d72650f964df1075",
2023-03-14 03:58:46,545 - INFO - "remote_checksum": "8ee12eb745c776b64e7daa1f41150303693f8869",
2023-03-14 03:58:46,545 - INFO - "remote_md5sum": null
2023-03-14 03:58:46,545 - INFO - }
2023-03-14 03:58:47,657 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:58:47,658 - INFO - "changed": true,
2023-03-14 03:58:47,658 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 03:58:47,658 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 03:58:47,658 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 03:58:47,658 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 03:58:47,658 - INFO - "remote_md5sum": null
2023-03-14 03:58:47,658 - INFO - }
2023-03-14 03:58:48,751 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:58:48,751 - INFO - "changed": true,
2023-03-14 03:58:48,751 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 03:58:48,751 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 03:58:48,751 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 03:58:48,751 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 03:58:48,752 - INFO - "remote_md5sum": null
2023-03-14 03:58:48,752 - INFO - }
2023-03-14 03:58:50,461 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 03:58:50,462 - INFO - "changed": true,
2023-03-14 03:58:50,462 - INFO - "checksum": "8eccb7d694fc233095198b6beaadae303bb1e6d0",
2023-03-14 03:58:50,462 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 03:58:50,462 - INFO - "md5sum": "220b4621f0881aae4b2c7dc53ae48a22",
2023-03-14 03:58:50,462 - INFO - "remote_checksum": "8eccb7d694fc233095198b6beaadae303bb1e6d0",
2023-03-14 03:58:50,462 - INFO - "remote_md5sum": null
2023-03-14 03:58:50,462 - INFO - }
2023-03-14 03:58:50,563 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 03:58:50,563 - INFO - 3.  collect the result
2023-03-14 03:58:50,724 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 03:58:50,725 - INFO - metric_name is: cpu_usage
2023-03-14 03:58:50,739 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678791530.717, '0.07695439722221838']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678791530.717, '0.07383829166666248']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678791530.717, '0.07320182499999847']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678791530.717, '0.0822059944444441']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678791530.717, '0.07588911944443073']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678791530.717, '0.07357873333333675']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678791530.717, '0.000928019444444001']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod9725ba63_d422_4851_a274_771a8ec615b6.slice/cri-containerd-ad361212f7e5cf5d08f33692562b3b5b53835cbd99b4d399a3e06a901303d4d7.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'ad361212f7e5cf5d08f33692562b3b5b53835cbd99b4d399a3e06a901303d4d7', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx', 'service': 'kubelet'}, 'value': [1678791530.717, '49.06460588888888']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678791530.717, '0.009244430555554572']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678791530.717, '0.0011626916666664833']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678791530.717, '0.016010955555553767']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678791530.717, '0']}]
2023-03-14 03:58:50,740 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 03:58:50,740 - INFO - metric_name is: memory_usage
2023-03-14 03:58:50,740 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678791530.722, '386166784']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678791530.722, '386564096']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678791530.722, '386445312']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678791530.722, '386150400']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678791530.722, '386621440']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678791530.722, '386007040']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678791530.722, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx'}, 'value': [1678791530.722, '539447296']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678791530.722, '5093195776']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678791530.722, '15556608']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678791530.722, '2445037568']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678791530.722, '847872']}]
2023-03-14 03:58:50,740 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 03:58:50,740 - INFO - metric_name is: ei_infer_fps
2023-03-14 03:58:50,740 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.11:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678791530.725, '111.896300518589']}]
2023-03-14 03:58:50,740 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 03:58:50,740 - INFO - metric_name is: ei_drop_fps
2023-03-14 03:58:50,740 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.11:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678791530.729, '57.78524875167622']}]
2023-03-14 03:58:50,740 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 03:58:50,741 - INFO - metric_name is: ei_scale_ratio
2023-03-14 03:58:50,741 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.11:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678791530.732, '1.5176264300075788']}]
2023-03-14 03:58:50,741 - INFO - Results written to metrics/7573_NON_AMX_BF16_metrics_20230314_035850.txt
2023-03-14 03:58:50,808 - INFO - sleep 120 seconds for the next round ...
2023-03-14 04:00:50,811 - INFO - -----------loop num:3/3------------
2023-03-14 04:01:00,817 - INFO - 1.  fetch_emon.sh
2023-03-14 04:01:00,818 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 04:01:02,767 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:01:02,767 - INFO - "ansible_facts": {
2023-03-14 04:01:02,768 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:01:02,768 - INFO - },
2023-03-14 04:01:02,768 - INFO - "changed": false,
2023-03-14 04:01:02,768 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 04:01:02,768 - INFO - "dest": "runemon.sh",
2023-03-14 04:01:02,768 - INFO - "gid": 1007,
2023-03-14 04:01:02,768 - INFO - "group": "ansible",
2023-03-14 04:01:02,768 - INFO - "mode": "0755",
2023-03-14 04:01:02,768 - INFO - "owner": "ansible",
2023-03-14 04:01:02,768 - INFO - "path": "runemon.sh",
2023-03-14 04:01:02,768 - INFO - "size": 452,
2023-03-14 04:01:02,769 - INFO - "state": "file",
2023-03-14 04:01:02,769 - INFO - "uid": 1006
2023-03-14 04:01:02,769 - INFO - }
2023-03-14 04:01:04,322 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:01:04,322 - INFO - "ansible_facts": {
2023-03-14 04:01:04,322 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:01:04,323 - INFO - },
2023-03-14 04:01:04,323 - INFO - "changed": false,
2023-03-14 04:01:04,323 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 04:01:04,323 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 04:01:04,323 - INFO - "gid": 1007,
2023-03-14 04:01:04,323 - INFO - "group": "ansible",
2023-03-14 04:01:04,323 - INFO - "mode": "0664",
2023-03-14 04:01:04,323 - INFO - "owner": "ansible",
2023-03-14 04:01:04,323 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 04:01:04,323 - INFO - "size": 23423,
2023-03-14 04:01:04,323 - INFO - "state": "file",
2023-03-14 04:01:04,323 - INFO - "uid": 1006
2023-03-14 04:01:04,323 - INFO - }
2023-03-14 04:01:05,382 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:01:05,382 - INFO - 
2023-03-14 04:01:06,459 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:01:06,459 - INFO - 
2023-03-14 04:01:06,554 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 04:01:11,557 - INFO - Collecting 30 seconds sar data background
2023-03-14 04:01:13,535 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:01:13,535 - INFO - 
2023-03-14 04:01:15,664 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:01:15,665 - INFO - 
2023-03-14 04:01:17,719 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:01:17,719 - INFO - 
2023-03-14 04:01:19,785 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:01:19,785 - INFO - 
2023-03-14 04:01:19,885 - INFO - Collecting EMON data
2023-03-14 04:01:51,369 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:01:51,370 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 04:01:51,370 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 04:01:51,370 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 04:01:51,370 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 04:01:51,370 - INFO - LD_LIBRARY_PATH=
2023-03-14 04:01:51,370 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 04:01:51,370 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 04:01:51,370 - INFO - EMON collector successfully stopped.
2023-03-14 04:01:51,468 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 04:02:21,471 - INFO - Copy dat files
2023-03-14 04:02:22,479 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:02:22,479 - INFO - "changed": true,
2023-03-14 04:02:22,479 - INFO - "checksum": "cd08beaba5d7eb2e19ed0c9838e7652600cb68f6",
2023-03-14 04:02:22,480 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 04:02:22,480 - INFO - "md5sum": "3d03012b9c9bf4f849b4937332fcaf0f",
2023-03-14 04:02:22,480 - INFO - "remote_checksum": "cd08beaba5d7eb2e19ed0c9838e7652600cb68f6",
2023-03-14 04:02:22,480 - INFO - "remote_md5sum": null
2023-03-14 04:02:22,480 - INFO - }
2023-03-14 04:02:23,578 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:02:23,579 - INFO - "changed": true,
2023-03-14 04:02:23,579 - INFO - "checksum": "29e1eded203288f1c9fc7afe5fb6c574516ec397",
2023-03-14 04:02:23,579 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 04:02:23,579 - INFO - "md5sum": "24c3c18d1193d112b71779da6dc04160",
2023-03-14 04:02:23,579 - INFO - "remote_checksum": "29e1eded203288f1c9fc7afe5fb6c574516ec397",
2023-03-14 04:02:23,579 - INFO - "remote_md5sum": null
2023-03-14 04:02:23,579 - INFO - }
2023-03-14 04:02:24,739 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:02:24,739 - INFO - "changed": true,
2023-03-14 04:02:24,739 - INFO - "checksum": "df4d2e9a8d5977a2cbad7b96fea1d26f73d6d691",
2023-03-14 04:02:24,739 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 04:02:24,739 - INFO - "md5sum": "5c5ab697a0d18c849ebce0082a218fd7",
2023-03-14 04:02:24,739 - INFO - "remote_checksum": "df4d2e9a8d5977a2cbad7b96fea1d26f73d6d691",
2023-03-14 04:02:24,739 - INFO - "remote_md5sum": null
2023-03-14 04:02:24,740 - INFO - }
2023-03-14 04:02:25,883 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:02:25,884 - INFO - "changed": true,
2023-03-14 04:02:25,884 - INFO - "checksum": "20a4a29ce13e17e6e6fc765222132f4b4d440890",
2023-03-14 04:02:25,884 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 04:02:25,884 - INFO - "md5sum": "4dbcc801f7e5ce4bc1caa5b5d0f94c6a",
2023-03-14 04:02:25,884 - INFO - "remote_checksum": "20a4a29ce13e17e6e6fc765222132f4b4d440890",
2023-03-14 04:02:25,884 - INFO - "remote_md5sum": null
2023-03-14 04:02:25,884 - INFO - }
2023-03-14 04:02:26,977 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:02:26,977 - INFO - "changed": true,
2023-03-14 04:02:26,978 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:02:26,978 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 04:02:26,978 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 04:02:26,978 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:02:26,978 - INFO - "remote_md5sum": null
2023-03-14 04:02:26,978 - INFO - }
2023-03-14 04:02:28,055 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:02:28,056 - INFO - "changed": true,
2023-03-14 04:02:28,056 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:02:28,056 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 04:02:28,056 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 04:02:28,056 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:02:28,056 - INFO - "remote_md5sum": null
2023-03-14 04:02:28,056 - INFO - }
2023-03-14 04:02:29,667 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:02:29,667 - INFO - "changed": true,
2023-03-14 04:02:29,667 - INFO - "checksum": "2cf107e6140cf49462d409995b7699f0ddf60a0b",
2023-03-14 04:02:29,668 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 04:02:29,668 - INFO - "md5sum": "eaa1c110a882793c0edfc759ed074d89",
2023-03-14 04:02:29,668 - INFO - "remote_checksum": "2cf107e6140cf49462d409995b7699f0ddf60a0b",
2023-03-14 04:02:29,668 - INFO - "remote_md5sum": null
2023-03-14 04:02:29,668 - INFO - }
2023-03-14 04:02:29,769 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 04:02:29,769 - INFO - 3.  collect the result
2023-03-14 04:02:29,941 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 04:02:29,941 - INFO - metric_name is: cpu_usage
2023-03-14 04:02:29,964 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678791749.927, '0.07485209999999319']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678791749.927, '0.07485763055556162']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678791749.927, '0.07806498055555898']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678791749.927, '0.07191164722222917']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678791749.927, '0.0732898861111203']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678791749.927, '0.0775729999999991']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678791749.927, '0.0013228722222218417']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod9725ba63_d422_4851_a274_771a8ec615b6.slice/cri-containerd-ad361212f7e5cf5d08f33692562b3b5b53835cbd99b4d399a3e06a901303d4d7.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'ad361212f7e5cf5d08f33692562b3b5b53835cbd99b4d399a3e06a901303d4d7', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx', 'service': 'kubelet'}, 'value': [1678791749.927, '48.70190871111111']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678791749.927, '0.008969516666669126']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678791749.927, '0.0011600472222211364']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678791749.927, '0.016704202777774905']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678791749.927, '0']}]
2023-03-14 04:02:29,964 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 04:02:29,964 - INFO - metric_name is: memory_usage
2023-03-14 04:02:29,965 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678791749.94, '386289664']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678791749.94, '386691072']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678791749.94, '386445312']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678791749.94, '386166784']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678791749.94, '386621440']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678791749.94, '386117632']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678791749.94, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx'}, 'value': [1678791749.94, '539181056']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678791749.94, '5093068800']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678791749.94, '15171584']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678791749.94, '2445467648']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678791749.94, '847872']}]
2023-03-14 04:02:29,965 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 04:02:29,965 - INFO - metric_name is: ei_infer_fps
2023-03-14 04:02:29,965 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.11:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678791749.946, '110.83616520697996']}]
2023-03-14 04:02:29,965 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 04:02:29,965 - INFO - metric_name is: ei_drop_fps
2023-03-14 04:02:29,965 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.11:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678791749.951, '58.79106466472405']}]
2023-03-14 04:02:29,965 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 04:02:29,965 - INFO - metric_name is: ei_scale_ratio
2023-03-14 04:02:29,965 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.11:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678791749.957, '1.5307057450998054']}]
2023-03-14 04:02:29,966 - INFO - Results written to metrics/7573_NON_AMX_BF16_metrics_20230314_040229.txt
2023-03-14 04:02:30,070 - INFO - ------------- scenario: 2/4 ------------
2023-03-14 04:02:30,070 - INFO - Begin set_deployment_env of scenario : VNNI_INT8 ...
2023-03-14 04:02:30,127 - INFO - Setting environment variables for scenario VNNI_INT8...
2023-03-14 04:02:30,147 - INFO - Setting resource requests and limits for scenario VNNI_INT8...
2023-03-14 04:02:30,166 - INFO - after patch_body wait for 30 seconds to enable the new pods
2023-03-14 04:03:00,196 - INFO - Waiting for 1 pods to be ready for scenario VNNI_INT8...
2023-03-14 04:03:00,277 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:03:00,277 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:03:00,278 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 0.08 seconds
2023-03-14 04:03:10,311 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:03:10,312 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:03:10,312 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 10.11 seconds
2023-03-14 04:03:20,348 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:03:20,349 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:03:20,349 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 20.15 seconds
2023-03-14 04:03:30,384 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:03:30,385 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:03:30,385 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 30.19 seconds
2023-03-14 04:03:40,421 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:03:40,421 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:03:40,421 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 40.22 seconds
2023-03-14 04:03:50,458 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:03:50,458 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:03:50,458 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 50.26 seconds
2023-03-14 04:04:00,494 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:04:00,494 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:04:00,494 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 60.30 seconds
2023-03-14 04:04:10,558 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:04:10,558 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:04:10,558 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 70.36 seconds
2023-03-14 04:04:20,593 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:04:20,594 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:04:20,594 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 80.40 seconds
2023-03-14 04:04:30,631 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:04:30,632 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:04:30,632 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 90.43 seconds
2023-03-14 04:04:40,668 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:04:40,668 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:04:40,669 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 100.47 seconds
2023-03-14 04:04:50,704 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:04:50,705 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:04:50,705 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 110.51 seconds
2023-03-14 04:05:00,739 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:05:00,739 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:05:00,739 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 120.54 seconds
2023-03-14 04:05:10,775 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:05:10,776 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:05:10,776 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 130.58 seconds
2023-03-14 04:05:20,812 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:05:20,812 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:05:20,812 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 140.62 seconds
2023-03-14 04:05:30,848 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:05:30,848 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:05:30,848 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 150.65 seconds
2023-03-14 04:05:40,886 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:05:40,886 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:05:40,886 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 160.69 seconds
2023-03-14 04:05:50,922 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:05:50,923 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:05:50,923 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 170.73 seconds
2023-03-14 04:06:00,958 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:06:00,959 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:06:00,959 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 180.76 seconds
2023-03-14 04:06:10,996 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:06:10,997 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:06:10,997 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 190.80 seconds
2023-03-14 04:06:21,033 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:06:21,033 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:06:21,033 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 200.84 seconds
2023-03-14 04:06:31,070 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:06:31,070 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:06:31,070 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 210.87 seconds
2023-03-14 04:06:41,106 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:06:41,107 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:06:41,107 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 220.91 seconds
2023-03-14 04:06:51,145 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:06:51,146 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:06:51,146 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 230.95 seconds
2023-03-14 04:07:01,182 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:07:01,182 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:07:01,183 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 240.99 seconds
2023-03-14 04:07:11,219 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:07:11,220 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:07:11,220 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 251.02 seconds
2023-03-14 04:07:21,258 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:07:21,258 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:07:21,258 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 261.06 seconds
2023-03-14 04:07:31,293 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:07:31,293 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:07:31,293 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 271.10 seconds
2023-03-14 04:07:41,329 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:07:41,330 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:07:41,330 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 281.13 seconds
2023-03-14 04:07:51,365 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:07:51,365 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:07:51,365 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 291.17 seconds
2023-03-14 04:08:01,401 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:08:01,402 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:08:01,402 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 301.20 seconds
2023-03-14 04:08:11,453 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:08:11,454 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:08:11,454 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 311.26 seconds
2023-03-14 04:08:21,490 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:08:21,490 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:08:21,491 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 321.29 seconds
2023-03-14 04:08:31,527 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:08:31,528 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:08:31,528 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 331.33 seconds
2023-03-14 04:08:41,564 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:08:41,564 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:08:41,565 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 341.37 seconds
2023-03-14 04:08:51,603 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:08:51,603 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:08:51,603 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 351.41 seconds
2023-03-14 04:09:01,639 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:09:01,640 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:09:01,640 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 361.44 seconds
2023-03-14 04:09:11,676 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:09:11,677 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:09:11,677 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 371.48 seconds
2023-03-14 04:09:21,711 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:09:21,712 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:09:21,712 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 381.51 seconds
2023-03-14 04:09:31,747 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:09:31,747 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:09:31,747 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 391.55 seconds
2023-03-14 04:09:41,782 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:09:41,782 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:09:41,782 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 401.59 seconds
2023-03-14 04:09:51,818 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:09:51,818 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:09:51,818 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 411.62 seconds
2023-03-14 04:10:01,856 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:10:01,857 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:10:01,857 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 421.66 seconds
2023-03-14 04:10:11,894 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:10:11,894 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:10:11,895 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 431.70 seconds
2023-03-14 04:10:21,932 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:10:21,933 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:10:21,933 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 441.74 seconds
2023-03-14 04:10:31,969 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:10:31,969 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:10:31,969 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 451.77 seconds
2023-03-14 04:10:42,004 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:10:42,004 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:10:42,004 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 461.81 seconds
2023-03-14 04:10:52,041 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:10:52,041 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:10:52,041 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 471.84 seconds
2023-03-14 04:11:02,071 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:11:02,071 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:11:02,071 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 481.87 seconds
2023-03-14 04:11:12,107 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:11:12,107 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:11:12,107 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 491.91 seconds
2023-03-14 04:11:22,142 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:11:22,142 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:11:22,142 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 501.95 seconds
2023-03-14 04:11:32,178 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:11:32,178 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:11:32,179 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 511.98 seconds
2023-03-14 04:11:42,215 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:11:42,216 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:11:42,216 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 522.02 seconds
2023-03-14 04:11:52,251 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:11:52,251 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:11:52,251 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 532.05 seconds
2023-03-14 04:12:02,289 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:12:02,290 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:12:02,290 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 542.09 seconds
2023-03-14 04:12:12,327 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:12:12,328 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:12:12,328 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 552.13 seconds
2023-03-14 04:12:22,363 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:12:22,363 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:12:22,363 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 562.17 seconds
2023-03-14 04:12:32,399 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:12:32,399 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:12:32,399 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 572.20 seconds
2023-03-14 04:12:42,434 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Pending
2023-03-14 04:12:42,434 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-c45d7d99d-qzjnx status:Running
2023-03-14 04:12:42,434 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario VNNI_INT8. Elapsed time: 582.24 seconds
2023-03-14 04:12:52,463 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Running
2023-03-14 04:12:52,463 - INFO - All 1 pods are ready for scenario VNNI_INT8
2023-03-14 04:12:52,464 - INFO - Finished scenario VNNI_INT8
2023-03-14 04:12:52,464 - INFO - wait for 2m to get stable metrics ...
2023-03-14 04:14:52,565 - INFO - Running benchmarking script for scenario VNNI_INT8...
2023-03-14 04:14:52,576 - INFO - TS=20230314041452
2023-03-14 04:14:54,591 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:14:54,591 - INFO - Reading package lists...
2023-03-14 04:14:54,591 - INFO - Building dependency tree...
2023-03-14 04:14:54,592 - INFO - Reading state information...
2023-03-14 04:14:54,592 - INFO - linux-tools-5.15.0-60-generic is already the newest version (5.15.0-60.66).
2023-03-14 04:14:54,592 - INFO - sysstat is already the newest version (12.5.2-2ubuntu0.1).
2023-03-14 04:14:54,592 - INFO - The following packages were automatically installed and are no longer required:
2023-03-14 04:14:54,592 - INFO - cgroupfs-mount libltdl7 pigz
2023-03-14 04:14:54,592 - INFO - Use 'sudo apt autoremove' to remove them.
2023-03-14 04:14:54,592 - INFO - 0 upgraded, 0 newly installed, 0 to remove and 41 not upgraded.
2023-03-14 04:14:54,592 - INFO - WARNING: apt does not have a stable CLI interface. Use with caution in scripts.
2023-03-14 04:14:55,679 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:14:55,679 - INFO - 
2023-03-14 04:14:56,741 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:14:56,741 - INFO - performance
2023-03-14 04:14:56,840 - INFO - Run on test AiPipeline_20230314041452_7573_VNNI_INT8_6
2023-03-14 04:14:56,840 - INFO - TT=AiPipeline_20230314041452_7573_VNNI_INT8_6,WRKDIR=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 04:14:56,845 - INFO - -----------loop num:1/3------------
2023-03-14 04:15:06,851 - INFO - 1.  fetch_emon.sh
2023-03-14 04:15:06,853 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 04:15:08,160 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:15:08,160 - INFO - "ansible_facts": {
2023-03-14 04:15:08,160 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:15:08,160 - INFO - },
2023-03-14 04:15:08,161 - INFO - "changed": false,
2023-03-14 04:15:08,161 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 04:15:08,161 - INFO - "dest": "runemon.sh",
2023-03-14 04:15:08,161 - INFO - "gid": 1007,
2023-03-14 04:15:08,161 - INFO - "group": "ansible",
2023-03-14 04:15:08,161 - INFO - "mode": "0755",
2023-03-14 04:15:08,161 - INFO - "owner": "ansible",
2023-03-14 04:15:08,161 - INFO - "path": "runemon.sh",
2023-03-14 04:15:08,161 - INFO - "size": 452,
2023-03-14 04:15:08,161 - INFO - "state": "file",
2023-03-14 04:15:08,161 - INFO - "uid": 1006
2023-03-14 04:15:08,161 - INFO - }
2023-03-14 04:15:09,615 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:15:09,616 - INFO - "ansible_facts": {
2023-03-14 04:15:09,616 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:15:09,616 - INFO - },
2023-03-14 04:15:09,616 - INFO - "changed": false,
2023-03-14 04:15:09,616 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 04:15:09,616 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 04:15:09,616 - INFO - "gid": 1007,
2023-03-14 04:15:09,616 - INFO - "group": "ansible",
2023-03-14 04:15:09,616 - INFO - "mode": "0664",
2023-03-14 04:15:09,616 - INFO - "owner": "ansible",
2023-03-14 04:15:09,617 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 04:15:09,617 - INFO - "size": 23423,
2023-03-14 04:15:09,617 - INFO - "state": "file",
2023-03-14 04:15:09,617 - INFO - "uid": 1006
2023-03-14 04:15:09,617 - INFO - }
2023-03-14 04:15:10,688 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:15:10,689 - INFO - 
2023-03-14 04:15:11,734 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:15:11,734 - INFO - 
2023-03-14 04:15:11,834 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 04:15:16,837 - INFO - Collecting 30 seconds sar data background
2023-03-14 04:15:18,807 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:15:18,807 - INFO - 
2023-03-14 04:15:20,641 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:15:20,642 - INFO - 
2023-03-14 04:15:22,689 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:15:22,689 - INFO - 
2023-03-14 04:15:24,757 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:15:24,758 - INFO - 
2023-03-14 04:15:24,855 - INFO - Collecting EMON data
2023-03-14 04:15:56,394 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:15:56,395 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 04:15:56,395 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 04:15:56,395 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 04:15:56,395 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 04:15:56,395 - INFO - LD_LIBRARY_PATH=
2023-03-14 04:15:56,395 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 04:15:56,395 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 04:15:56,395 - INFO - EMON collector successfully stopped.
2023-03-14 04:15:56,499 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 04:16:26,502 - INFO - Copy dat files
2023-03-14 04:16:27,550 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:16:27,550 - INFO - "changed": true,
2023-03-14 04:16:27,550 - INFO - "checksum": "6641e5740330dc7da9523617da66421804063c2a",
2023-03-14 04:16:27,550 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 04:16:27,551 - INFO - "md5sum": "e0b0fcb8aa463bdd7788f03cd4646c00",
2023-03-14 04:16:27,551 - INFO - "remote_checksum": "6641e5740330dc7da9523617da66421804063c2a",
2023-03-14 04:16:27,551 - INFO - "remote_md5sum": null
2023-03-14 04:16:27,551 - INFO - }
2023-03-14 04:16:28,656 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:16:28,657 - INFO - "changed": true,
2023-03-14 04:16:28,657 - INFO - "checksum": "5fef9a14a5dfc42f0e0ef9c00d7d6866f516930e",
2023-03-14 04:16:28,657 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 04:16:28,657 - INFO - "md5sum": "01cefba77ee38b6f01594a015fca5e68",
2023-03-14 04:16:28,657 - INFO - "remote_checksum": "5fef9a14a5dfc42f0e0ef9c00d7d6866f516930e",
2023-03-14 04:16:28,657 - INFO - "remote_md5sum": null
2023-03-14 04:16:28,657 - INFO - }
2023-03-14 04:16:29,737 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:16:29,737 - INFO - "changed": true,
2023-03-14 04:16:29,737 - INFO - "checksum": "568c4cc41fb9322a96fe2a52f870624d615965ac",
2023-03-14 04:16:29,737 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 04:16:29,737 - INFO - "md5sum": "601db64527bd148a77877729fea5cd8a",
2023-03-14 04:16:29,737 - INFO - "remote_checksum": "568c4cc41fb9322a96fe2a52f870624d615965ac",
2023-03-14 04:16:29,737 - INFO - "remote_md5sum": null
2023-03-14 04:16:29,738 - INFO - }
2023-03-14 04:16:30,800 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:16:30,801 - INFO - "changed": true,
2023-03-14 04:16:30,801 - INFO - "checksum": "198efee9cb6c2f57f0df68721df1ed2f5b7931df",
2023-03-14 04:16:30,801 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 04:16:30,801 - INFO - "md5sum": "19e27da30538432060aaa04d57aa7c7a",
2023-03-14 04:16:30,801 - INFO - "remote_checksum": "198efee9cb6c2f57f0df68721df1ed2f5b7931df",
2023-03-14 04:16:30,801 - INFO - "remote_md5sum": null
2023-03-14 04:16:30,801 - INFO - }
2023-03-14 04:16:31,906 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:16:31,907 - INFO - "changed": true,
2023-03-14 04:16:31,907 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:16:31,907 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 04:16:31,907 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 04:16:31,907 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:16:31,907 - INFO - "remote_md5sum": null
2023-03-14 04:16:31,907 - INFO - }
2023-03-14 04:16:32,993 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:16:32,994 - INFO - "changed": true,
2023-03-14 04:16:32,994 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:16:32,994 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 04:16:32,994 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 04:16:32,994 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:16:32,994 - INFO - "remote_md5sum": null
2023-03-14 04:16:32,994 - INFO - }
2023-03-14 04:16:34,619 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:16:34,620 - INFO - "changed": true,
2023-03-14 04:16:34,620 - INFO - "checksum": "393ca17f2d6beaf636ac1f5af0ab66a32f0bcfce",
2023-03-14 04:16:34,620 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 04:16:34,620 - INFO - "md5sum": "7e2e1165a0c705df6b42fa26cfd7d1d1",
2023-03-14 04:16:34,620 - INFO - "remote_checksum": "393ca17f2d6beaf636ac1f5af0ab66a32f0bcfce",
2023-03-14 04:16:34,620 - INFO - "remote_md5sum": null
2023-03-14 04:16:34,620 - INFO - }
2023-03-14 04:16:34,720 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 04:16:34,720 - INFO - 3.  collect the result
2023-03-14 04:16:34,880 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 04:16:34,881 - INFO - metric_name is: cpu_usage
2023-03-14 04:16:34,895 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678792594.873, '0.07278472222224082']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678792594.873, '0.07020220833333546']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678792594.873, '0.0785072194444385']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678792594.873, '0.0697650944444528']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678792594.873, '0.07349720833333574']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678792594.873, '0.0715695027777656']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678792594.873, '0.0012404805555553998']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-podabbe880f_57aa_41fc_b6db_50a2ffd8340f.slice/cri-containerd-1602d1cefc3d47d8317753710223848ed02f5d2416ce5439a2105926db9894d3.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1602d1cefc3d47d8317753710223848ed02f5d2416ce5439a2105926db9894d3', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr', 'service': 'kubelet'}, 'value': [1678792594.873, '48.61547335555556']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678792594.873, '0.01148270277778162']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678792594.873, '0.001070230555555756']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678792594.873, '0.022466847222221982']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678792594.873, '0']}]
2023-03-14 04:16:34,895 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 04:16:34,895 - INFO - metric_name is: memory_usage
2023-03-14 04:16:34,896 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678792594.878, '386166784']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678792594.878, '386433024']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678792594.878, '386445312']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678792594.878, '386146304']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678792594.878, '386494464']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678792594.878, '386113536']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678792594.878, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr'}, 'value': [1678792594.878, '333606912']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678792594.878, '5093195776']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678792594.878, '15175680']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678792594.878, '2444783616']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678792594.878, '847872']}]
2023-03-14 04:16:34,896 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 04:16:34,896 - INFO - metric_name is: ei_infer_fps
2023-03-14 04:16:34,896 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.20:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678792594.882, '161.58390557628857']}]
2023-03-14 04:16:34,896 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 04:16:34,896 - INFO - metric_name is: ei_drop_fps
2023-03-14 04:16:34,896 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.20:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678792594.885, '8.734286060868913']}]
2023-03-14 04:16:34,896 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 04:16:34,896 - INFO - metric_name is: ei_scale_ratio
2023-03-14 04:16:34,896 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.20:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678792594.888, '1.0543236721414238']}]
2023-03-14 04:16:34,896 - INFO - Results written to metrics/7573_VNNI_INT8_metrics_20230314_041634.txt
2023-03-14 04:16:34,963 - INFO - sleep 120 seconds for the next round ...
2023-03-14 04:18:34,965 - INFO - -----------loop num:2/3------------
2023-03-14 04:18:44,971 - INFO - 1.  fetch_emon.sh
2023-03-14 04:18:44,973 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 04:18:46,838 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:18:46,838 - INFO - "ansible_facts": {
2023-03-14 04:18:46,838 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:18:46,838 - INFO - },
2023-03-14 04:18:46,838 - INFO - "changed": false,
2023-03-14 04:18:46,839 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 04:18:46,839 - INFO - "dest": "runemon.sh",
2023-03-14 04:18:46,839 - INFO - "gid": 1007,
2023-03-14 04:18:46,839 - INFO - "group": "ansible",
2023-03-14 04:18:46,839 - INFO - "mode": "0755",
2023-03-14 04:18:46,839 - INFO - "owner": "ansible",
2023-03-14 04:18:46,839 - INFO - "path": "runemon.sh",
2023-03-14 04:18:46,839 - INFO - "size": 452,
2023-03-14 04:18:46,839 - INFO - "state": "file",
2023-03-14 04:18:46,839 - INFO - "uid": 1006
2023-03-14 04:18:46,839 - INFO - }
2023-03-14 04:18:48,213 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:18:48,213 - INFO - "ansible_facts": {
2023-03-14 04:18:48,213 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:18:48,214 - INFO - },
2023-03-14 04:18:48,214 - INFO - "changed": false,
2023-03-14 04:18:48,214 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 04:18:48,214 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 04:18:48,214 - INFO - "gid": 1007,
2023-03-14 04:18:48,214 - INFO - "group": "ansible",
2023-03-14 04:18:48,214 - INFO - "mode": "0664",
2023-03-14 04:18:48,214 - INFO - "owner": "ansible",
2023-03-14 04:18:48,214 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 04:18:48,214 - INFO - "size": 23423,
2023-03-14 04:18:48,214 - INFO - "state": "file",
2023-03-14 04:18:48,214 - INFO - "uid": 1006
2023-03-14 04:18:48,215 - INFO - }
2023-03-14 04:18:49,265 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:18:49,266 - INFO - 
2023-03-14 04:18:50,306 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:18:50,306 - INFO - 
2023-03-14 04:18:50,405 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 04:18:55,408 - INFO - Collecting 30 seconds sar data background
2023-03-14 04:18:57,381 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:18:57,381 - INFO - 
2023-03-14 04:18:59,429 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:18:59,429 - INFO - 
2023-03-14 04:19:01,516 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:19:01,517 - INFO - 
2023-03-14 04:19:03,605 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:19:03,605 - INFO - 
2023-03-14 04:19:03,706 - INFO - Collecting EMON data
2023-03-14 04:19:35,365 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:19:35,366 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 04:19:35,366 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 04:19:35,366 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 04:19:35,366 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 04:19:35,366 - INFO - LD_LIBRARY_PATH=
2023-03-14 04:19:35,366 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 04:19:35,366 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 04:19:35,366 - INFO - EMON collector successfully stopped.
2023-03-14 04:19:35,472 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 04:20:05,475 - INFO - Copy dat files
2023-03-14 04:20:06,490 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:20:06,490 - INFO - "changed": true,
2023-03-14 04:20:06,491 - INFO - "checksum": "5092f8d75f9007e07e081f6e23e98186e50d60db",
2023-03-14 04:20:06,491 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 04:20:06,491 - INFO - "md5sum": "9d022f141d980341d2f8a70bf0062b82",
2023-03-14 04:20:06,491 - INFO - "remote_checksum": "5092f8d75f9007e07e081f6e23e98186e50d60db",
2023-03-14 04:20:06,491 - INFO - "remote_md5sum": null
2023-03-14 04:20:06,491 - INFO - }
2023-03-14 04:20:07,599 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:20:07,599 - INFO - "changed": true,
2023-03-14 04:20:07,599 - INFO - "checksum": "f4e9253d169d0879de5bce8e0555fefa46b63300",
2023-03-14 04:20:07,599 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 04:20:07,599 - INFO - "md5sum": "d6e5115f012e6cc046a1b0e8204b76a3",
2023-03-14 04:20:07,599 - INFO - "remote_checksum": "f4e9253d169d0879de5bce8e0555fefa46b63300",
2023-03-14 04:20:07,599 - INFO - "remote_md5sum": null
2023-03-14 04:20:07,600 - INFO - }
2023-03-14 04:20:08,696 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:20:08,697 - INFO - "changed": true,
2023-03-14 04:20:08,697 - INFO - "checksum": "5abd91f766f674196f1af55208a561a02c82fe70",
2023-03-14 04:20:08,697 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 04:20:08,697 - INFO - "md5sum": "0b1b7bf42e5500a91a4253bf9c889834",
2023-03-14 04:20:08,697 - INFO - "remote_checksum": "5abd91f766f674196f1af55208a561a02c82fe70",
2023-03-14 04:20:08,697 - INFO - "remote_md5sum": null
2023-03-14 04:20:08,697 - INFO - }
2023-03-14 04:20:09,898 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:20:09,898 - INFO - "changed": true,
2023-03-14 04:20:09,898 - INFO - "checksum": "3f2d18647944eab262314f5bbfd3504bb7349ed7",
2023-03-14 04:20:09,899 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 04:20:09,899 - INFO - "md5sum": "fd10c6e7360e2bf7f7e41f88e75e6571",
2023-03-14 04:20:09,899 - INFO - "remote_checksum": "3f2d18647944eab262314f5bbfd3504bb7349ed7",
2023-03-14 04:20:09,899 - INFO - "remote_md5sum": null
2023-03-14 04:20:09,899 - INFO - }
2023-03-14 04:20:11,013 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:20:11,014 - INFO - "changed": true,
2023-03-14 04:20:11,014 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:20:11,014 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 04:20:11,014 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 04:20:11,014 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:20:11,014 - INFO - "remote_md5sum": null
2023-03-14 04:20:11,014 - INFO - }
2023-03-14 04:20:12,109 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:20:12,109 - INFO - "changed": true,
2023-03-14 04:20:12,109 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:20:12,109 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 04:20:12,109 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 04:20:12,109 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:20:12,109 - INFO - "remote_md5sum": null
2023-03-14 04:20:12,110 - INFO - }
2023-03-14 04:20:13,698 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:20:13,699 - INFO - "changed": true,
2023-03-14 04:20:13,699 - INFO - "checksum": "91cfddf211b67cebd3e3f034f4b1360db0e42fa2",
2023-03-14 04:20:13,699 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 04:20:13,699 - INFO - "md5sum": "a363ae7df9ed3425229555f758c7d5fc",
2023-03-14 04:20:13,699 - INFO - "remote_checksum": "91cfddf211b67cebd3e3f034f4b1360db0e42fa2",
2023-03-14 04:20:13,699 - INFO - "remote_md5sum": null
2023-03-14 04:20:13,699 - INFO - }
2023-03-14 04:20:13,802 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 04:20:13,803 - INFO - 3.  collect the result
2023-03-14 04:20:13,962 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 04:20:13,962 - INFO - metric_name is: cpu_usage
2023-03-14 04:20:13,976 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678792813.955, '0.0738430666666621']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678792813.955, '0.07324620000000423']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678792813.955, '0.08055737777777823']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678792813.955, '0.07367492222221901']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678792813.955, '0.0749163694444481']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678792813.955, '0.0755493722222228']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678792813.955, '0.0012572361111106525']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-podabbe880f_57aa_41fc_b6db_50a2ffd8340f.slice/cri-containerd-1602d1cefc3d47d8317753710223848ed02f5d2416ce5439a2105926db9894d3.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1602d1cefc3d47d8317753710223848ed02f5d2416ce5439a2105926db9894d3', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr', 'service': 'kubelet'}, 'value': [1678792813.955, '53.878791694444445']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678792813.955, '0.011222327777780566']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678792813.955, '0.0010504944444442621']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678792813.955, '0.020185327777777377']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678792813.955, '0']}]
2023-03-14 04:20:13,977 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 04:20:13,977 - INFO - metric_name is: memory_usage
2023-03-14 04:20:13,977 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678792813.959, '386166784']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678792813.959, '386437120']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678792813.959, '386441216']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678792813.959, '386277376']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678792813.959, '386519040']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678792813.959, '386007040']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678792813.959, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr'}, 'value': [1678792813.959, '333692928']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678792813.959, '5093330944']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678792813.959, '15429632']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678792813.959, '2445627392']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678792813.959, '847872']}]
2023-03-14 04:20:13,977 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 04:20:13,977 - INFO - metric_name is: ei_infer_fps
2023-03-14 04:20:13,977 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.20:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678792813.963, '165.87474996925437']}]
2023-03-14 04:20:13,978 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 04:20:13,978 - INFO - metric_name is: ei_drop_fps
2023-03-14 04:20:13,978 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.20:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678792813.967, '4.1609220613121005']}]
2023-03-14 04:20:13,978 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 04:20:13,978 - INFO - metric_name is: ei_scale_ratio
2023-03-14 04:20:13,978 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.20:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678792813.97, '1.0251586467804132']}]
2023-03-14 04:20:13,978 - INFO - Results written to metrics/7573_VNNI_INT8_metrics_20230314_042013.txt
2023-03-14 04:20:14,043 - INFO - sleep 120 seconds for the next round ...
2023-03-14 04:22:14,046 - INFO - -----------loop num:3/3------------
2023-03-14 04:22:24,052 - INFO - 1.  fetch_emon.sh
2023-03-14 04:22:24,054 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 04:22:25,953 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:22:25,954 - INFO - "ansible_facts": {
2023-03-14 04:22:25,954 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:22:25,954 - INFO - },
2023-03-14 04:22:25,954 - INFO - "changed": false,
2023-03-14 04:22:25,954 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 04:22:25,954 - INFO - "dest": "runemon.sh",
2023-03-14 04:22:25,954 - INFO - "gid": 1007,
2023-03-14 04:22:25,954 - INFO - "group": "ansible",
2023-03-14 04:22:25,954 - INFO - "mode": "0755",
2023-03-14 04:22:25,954 - INFO - "owner": "ansible",
2023-03-14 04:22:25,954 - INFO - "path": "runemon.sh",
2023-03-14 04:22:25,954 - INFO - "size": 452,
2023-03-14 04:22:25,955 - INFO - "state": "file",
2023-03-14 04:22:25,955 - INFO - "uid": 1006
2023-03-14 04:22:25,955 - INFO - }
2023-03-14 04:22:27,353 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:22:27,354 - INFO - "ansible_facts": {
2023-03-14 04:22:27,354 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:22:27,354 - INFO - },
2023-03-14 04:22:27,354 - INFO - "changed": false,
2023-03-14 04:22:27,354 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 04:22:27,354 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 04:22:27,354 - INFO - "gid": 1007,
2023-03-14 04:22:27,354 - INFO - "group": "ansible",
2023-03-14 04:22:27,354 - INFO - "mode": "0664",
2023-03-14 04:22:27,354 - INFO - "owner": "ansible",
2023-03-14 04:22:27,354 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 04:22:27,355 - INFO - "size": 23423,
2023-03-14 04:22:27,355 - INFO - "state": "file",
2023-03-14 04:22:27,355 - INFO - "uid": 1006
2023-03-14 04:22:27,355 - INFO - }
2023-03-14 04:22:28,432 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:22:28,432 - INFO - 
2023-03-14 04:22:29,511 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:22:29,511 - INFO - 
2023-03-14 04:22:29,612 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 04:22:34,614 - INFO - Collecting 30 seconds sar data background
2023-03-14 04:22:36,588 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:22:36,588 - INFO - 
2023-03-14 04:22:38,657 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:22:38,658 - INFO - 
2023-03-14 04:22:40,694 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:22:40,695 - INFO - 
2023-03-14 04:22:42,788 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:22:42,788 - INFO - 
2023-03-14 04:22:42,893 - INFO - Collecting EMON data
2023-03-14 04:23:14,438 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:23:14,438 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 04:23:14,439 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 04:23:14,439 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 04:23:14,439 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 04:23:14,439 - INFO - LD_LIBRARY_PATH=
2023-03-14 04:23:14,439 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 04:23:14,439 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 04:23:14,439 - INFO - EMON collector successfully stopped.
2023-03-14 04:23:14,539 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 04:23:44,542 - INFO - Copy dat files
2023-03-14 04:23:45,553 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:23:45,553 - INFO - "changed": true,
2023-03-14 04:23:45,553 - INFO - "checksum": "90723e62de7b740f7086c92b925e854be7c577c8",
2023-03-14 04:23:45,554 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 04:23:45,554 - INFO - "md5sum": "96c3ed7f061ebd60a660fdfbfc4d4bec",
2023-03-14 04:23:45,554 - INFO - "remote_checksum": "90723e62de7b740f7086c92b925e854be7c577c8",
2023-03-14 04:23:45,554 - INFO - "remote_md5sum": null
2023-03-14 04:23:45,554 - INFO - }
2023-03-14 04:23:46,657 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:23:46,658 - INFO - "changed": true,
2023-03-14 04:23:46,658 - INFO - "checksum": "55bdedfe98b9e552f4e543445ecaa5935bbf7aa9",
2023-03-14 04:23:46,658 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 04:23:46,658 - INFO - "md5sum": "574b51a912285a203df196b5eb310c54",
2023-03-14 04:23:46,658 - INFO - "remote_checksum": "55bdedfe98b9e552f4e543445ecaa5935bbf7aa9",
2023-03-14 04:23:46,658 - INFO - "remote_md5sum": null
2023-03-14 04:23:46,658 - INFO - }
2023-03-14 04:23:47,750 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:23:47,751 - INFO - "changed": true,
2023-03-14 04:23:47,751 - INFO - "checksum": "b9fee9cb3be719596388a90934c2c1493f547817",
2023-03-14 04:23:47,751 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 04:23:47,751 - INFO - "md5sum": "9c3c4eb165c5522bfff418da4fb2eb08",
2023-03-14 04:23:47,751 - INFO - "remote_checksum": "b9fee9cb3be719596388a90934c2c1493f547817",
2023-03-14 04:23:47,751 - INFO - "remote_md5sum": null
2023-03-14 04:23:47,751 - INFO - }
2023-03-14 04:23:48,886 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:23:48,887 - INFO - "changed": true,
2023-03-14 04:23:48,887 - INFO - "checksum": "bcc110af772bf561a556436d853c3b8885dd87d6",
2023-03-14 04:23:48,887 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 04:23:48,887 - INFO - "md5sum": "0456d3fa8625735316a2ca58c8f5d455",
2023-03-14 04:23:48,887 - INFO - "remote_checksum": "bcc110af772bf561a556436d853c3b8885dd87d6",
2023-03-14 04:23:48,887 - INFO - "remote_md5sum": null
2023-03-14 04:23:48,887 - INFO - }
2023-03-14 04:23:49,979 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:23:49,980 - INFO - "changed": true,
2023-03-14 04:23:49,980 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:23:49,980 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 04:23:49,980 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 04:23:49,980 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:23:49,980 - INFO - "remote_md5sum": null
2023-03-14 04:23:49,980 - INFO - }
2023-03-14 04:23:51,078 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:23:51,078 - INFO - "changed": true,
2023-03-14 04:23:51,078 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:23:51,078 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 04:23:51,078 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 04:23:51,079 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:23:51,079 - INFO - "remote_md5sum": null
2023-03-14 04:23:51,079 - INFO - }
2023-03-14 04:23:52,680 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:23:52,681 - INFO - "changed": true,
2023-03-14 04:23:52,681 - INFO - "checksum": "6bb0d726e5052df9129cfedc257cef1b98b30518",
2023-03-14 04:23:52,681 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 04:23:52,681 - INFO - "md5sum": "7f5cf8373bd0c1b12592d32f5c959e0b",
2023-03-14 04:23:52,681 - INFO - "remote_checksum": "6bb0d726e5052df9129cfedc257cef1b98b30518",
2023-03-14 04:23:52,681 - INFO - "remote_md5sum": null
2023-03-14 04:23:52,681 - INFO - }
2023-03-14 04:23:52,783 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 04:23:52,784 - INFO - 3.  collect the result
2023-03-14 04:23:52,943 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 04:23:52,943 - INFO - metric_name is: cpu_usage
2023-03-14 04:23:52,958 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678793032.936, '0.07785744722221151']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678793032.936, '0.07163745277776899']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678793032.936, '0.07283720000000862']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678793032.936, '0.0847423249999944']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678793032.936, '0.07179052777778958']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678793032.936, '0.07317658888889329']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678793032.936, '0.00125061944444427']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-podabbe880f_57aa_41fc_b6db_50a2ffd8340f.slice/cri-containerd-1602d1cefc3d47d8317753710223848ed02f5d2416ce5439a2105926db9894d3.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1602d1cefc3d47d8317753710223848ed02f5d2416ce5439a2105926db9894d3', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr', 'service': 'kubelet'}, 'value': [1678793032.936, '47.49512164444445']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678793032.936, '0.011435005555555714']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678793032.936, '0.0010813527777764243']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678793032.936, '0.020654958333334937']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678793032.936, '0']}]
2023-03-14 04:23:52,959 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 04:23:52,959 - INFO - metric_name is: memory_usage
2023-03-14 04:23:52,959 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678793032.941, '386162688']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678793032.941, '386437120']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678793032.941, '386441216']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678793032.941, '386256896']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678793032.941, '386494464']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678793032.941, '386134016']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678793032.941, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr'}, 'value': [1678793032.941, '333357056']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678793032.941, '5093228544']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678793032.941, '15290368']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678793032.941, '2445430784']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678793032.941, '847872']}]
2023-03-14 04:23:52,959 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 04:23:52,959 - INFO - metric_name is: ei_infer_fps
2023-03-14 04:23:52,959 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.20:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678793032.945, '165.10567701326556']}]
2023-03-14 04:23:52,959 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 04:23:52,959 - INFO - metric_name is: ei_drop_fps
2023-03-14 04:23:52,959 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.20:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678793032.948, '5.011576844311924']}]
2023-03-14 04:23:52,959 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 04:23:52,960 - INFO - metric_name is: ei_scale_ratio
2023-03-14 04:23:52,960 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.20:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678793032.952, '1.0305251282788706']}]
2023-03-14 04:23:52,960 - INFO - Results written to metrics/7573_VNNI_INT8_metrics_20230314_042352.txt
2023-03-14 04:23:53,027 - INFO - ------------- scenario: 3/4 ------------
2023-03-14 04:23:53,028 - INFO - Begin set_deployment_env of scenario : NON_VNNI_INT8 ...
2023-03-14 04:23:53,076 - INFO - Setting environment variables for scenario NON_VNNI_INT8...
2023-03-14 04:23:53,096 - INFO - Setting resource requests and limits for scenario NON_VNNI_INT8...
2023-03-14 04:23:53,116 - INFO - after patch_body wait for 30 seconds to enable the new pods
2023-03-14 04:24:23,146 - INFO - Waiting for 1 pods to be ready for scenario NON_VNNI_INT8...
2023-03-14 04:24:23,226 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:24:23,226 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-7f766b5658-xbwtr status:Running
2023-03-14 04:24:23,226 - INFO - Waiting for -1 more pods to be ready, there are 0 not ready pods for scenario NON_VNNI_INT8. Elapsed time: 0.08 seconds
2023-03-14 04:24:33,247 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:24:33,248 - INFO - All 1 pods are ready for scenario NON_VNNI_INT8
2023-03-14 04:24:33,249 - INFO - Finished scenario NON_VNNI_INT8
2023-03-14 04:24:33,249 - INFO - wait for 2m to get stable metrics ...
2023-03-14 04:26:33,349 - INFO - Running benchmarking script for scenario NON_VNNI_INT8...
2023-03-14 04:26:33,361 - INFO - TS=20230314042633
2023-03-14 04:26:35,354 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:26:35,354 - INFO - Reading package lists...
2023-03-14 04:26:35,354 - INFO - Building dependency tree...
2023-03-14 04:26:35,354 - INFO - Reading state information...
2023-03-14 04:26:35,354 - INFO - linux-tools-5.15.0-60-generic is already the newest version (5.15.0-60.66).
2023-03-14 04:26:35,354 - INFO - sysstat is already the newest version (12.5.2-2ubuntu0.1).
2023-03-14 04:26:35,355 - INFO - The following packages were automatically installed and are no longer required:
2023-03-14 04:26:35,355 - INFO - cgroupfs-mount libltdl7 pigz
2023-03-14 04:26:35,355 - INFO - Use 'sudo apt autoremove' to remove them.
2023-03-14 04:26:35,355 - INFO - 0 upgraded, 0 newly installed, 0 to remove and 41 not upgraded.
2023-03-14 04:26:35,355 - INFO - WARNING: apt does not have a stable CLI interface. Use with caution in scripts.
2023-03-14 04:26:36,438 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:26:36,439 - INFO - 
2023-03-14 04:26:37,502 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:26:37,503 - INFO - performance
2023-03-14 04:26:37,602 - INFO - Run on test AiPipeline_20230314042633_7573_NON_VNNI_INT8_6
2023-03-14 04:26:37,603 - INFO - TT=AiPipeline_20230314042633_7573_NON_VNNI_INT8_6,WRKDIR=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 04:26:37,607 - INFO - -----------loop num:1/3------------
2023-03-14 04:26:47,613 - INFO - 1.  fetch_emon.sh
2023-03-14 04:26:47,614 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 04:26:48,919 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:26:48,920 - INFO - "ansible_facts": {
2023-03-14 04:26:48,920 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:26:48,920 - INFO - },
2023-03-14 04:26:48,920 - INFO - "changed": false,
2023-03-14 04:26:48,920 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 04:26:48,920 - INFO - "dest": "runemon.sh",
2023-03-14 04:26:48,920 - INFO - "gid": 1007,
2023-03-14 04:26:48,920 - INFO - "group": "ansible",
2023-03-14 04:26:48,921 - INFO - "mode": "0755",
2023-03-14 04:26:48,921 - INFO - "owner": "ansible",
2023-03-14 04:26:48,921 - INFO - "path": "runemon.sh",
2023-03-14 04:26:48,921 - INFO - "size": 452,
2023-03-14 04:26:48,921 - INFO - "state": "file",
2023-03-14 04:26:48,921 - INFO - "uid": 1006
2023-03-14 04:26:48,921 - INFO - }
2023-03-14 04:26:50,309 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:26:50,310 - INFO - "ansible_facts": {
2023-03-14 04:26:50,310 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:26:50,310 - INFO - },
2023-03-14 04:26:50,310 - INFO - "changed": false,
2023-03-14 04:26:50,310 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 04:26:50,310 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 04:26:50,311 - INFO - "gid": 1007,
2023-03-14 04:26:50,311 - INFO - "group": "ansible",
2023-03-14 04:26:50,311 - INFO - "mode": "0664",
2023-03-14 04:26:50,311 - INFO - "owner": "ansible",
2023-03-14 04:26:50,311 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 04:26:50,311 - INFO - "size": 23423,
2023-03-14 04:26:50,311 - INFO - "state": "file",
2023-03-14 04:26:50,311 - INFO - "uid": 1006
2023-03-14 04:26:50,311 - INFO - }
2023-03-14 04:26:51,390 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:26:51,391 - INFO - 
2023-03-14 04:26:52,443 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:26:52,443 - INFO - 
2023-03-14 04:26:52,541 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 04:26:57,544 - INFO - Collecting 30 seconds sar data background
2023-03-14 04:26:59,549 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:26:59,550 - INFO - 
2023-03-14 04:27:01,623 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:27:01,623 - INFO - 
2023-03-14 04:27:03,722 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:27:03,723 - INFO - 
2023-03-14 04:27:05,817 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:27:05,817 - INFO - 
2023-03-14 04:27:05,918 - INFO - Collecting EMON data
2023-03-14 04:27:37,401 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:27:37,402 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 04:27:37,402 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 04:27:37,402 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 04:27:37,402 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 04:27:37,402 - INFO - LD_LIBRARY_PATH=
2023-03-14 04:27:37,402 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 04:27:37,402 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 04:27:37,402 - INFO - EMON collector successfully stopped.
2023-03-14 04:27:37,503 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 04:28:07,506 - INFO - Copy dat files
2023-03-14 04:28:08,522 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:28:08,522 - INFO - "changed": true,
2023-03-14 04:28:08,522 - INFO - "checksum": "df15543d80dbd97e8c58b0d76c613319c5a5346e",
2023-03-14 04:28:08,522 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 04:28:08,522 - INFO - "md5sum": "ef157e1f14011fc33f96eb1019b4b590",
2023-03-14 04:28:08,522 - INFO - "remote_checksum": "df15543d80dbd97e8c58b0d76c613319c5a5346e",
2023-03-14 04:28:08,523 - INFO - "remote_md5sum": null
2023-03-14 04:28:08,523 - INFO - }
2023-03-14 04:28:09,630 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:28:09,630 - INFO - "changed": true,
2023-03-14 04:28:09,630 - INFO - "checksum": "7b9c743f541f2608a54214693bfe5ddd283e6340",
2023-03-14 04:28:09,630 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 04:28:09,630 - INFO - "md5sum": "71a35e78d4f624f24f9886434504f08c",
2023-03-14 04:28:09,630 - INFO - "remote_checksum": "7b9c743f541f2608a54214693bfe5ddd283e6340",
2023-03-14 04:28:09,630 - INFO - "remote_md5sum": null
2023-03-14 04:28:09,631 - INFO - }
2023-03-14 04:28:10,744 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:28:10,745 - INFO - "changed": true,
2023-03-14 04:28:10,745 - INFO - "checksum": "17a61125316ae843c227968a403c277b3075d249",
2023-03-14 04:28:10,745 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 04:28:10,745 - INFO - "md5sum": "2de9eb27cc3a0cb6d6a944a4ef6c3d79",
2023-03-14 04:28:10,745 - INFO - "remote_checksum": "17a61125316ae843c227968a403c277b3075d249",
2023-03-14 04:28:10,745 - INFO - "remote_md5sum": null
2023-03-14 04:28:10,745 - INFO - }
2023-03-14 04:28:11,891 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:28:11,892 - INFO - "changed": true,
2023-03-14 04:28:11,892 - INFO - "checksum": "1e847580a86fa3ee5aefd910b920d9093984c74c",
2023-03-14 04:28:11,892 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 04:28:11,892 - INFO - "md5sum": "1d6bfdcf0177fafd3da8fa5a793f1095",
2023-03-14 04:28:11,892 - INFO - "remote_checksum": "1e847580a86fa3ee5aefd910b920d9093984c74c",
2023-03-14 04:28:11,892 - INFO - "remote_md5sum": null
2023-03-14 04:28:11,892 - INFO - }
2023-03-14 04:28:12,992 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:28:12,992 - INFO - "changed": true,
2023-03-14 04:28:12,992 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:28:12,992 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 04:28:12,992 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 04:28:12,992 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:28:12,992 - INFO - "remote_md5sum": null
2023-03-14 04:28:12,993 - INFO - }
2023-03-14 04:28:14,098 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:28:14,099 - INFO - "changed": true,
2023-03-14 04:28:14,099 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:28:14,099 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 04:28:14,099 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 04:28:14,099 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:28:14,099 - INFO - "remote_md5sum": null
2023-03-14 04:28:14,099 - INFO - }
2023-03-14 04:28:15,720 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:28:15,721 - INFO - "changed": true,
2023-03-14 04:28:15,721 - INFO - "checksum": "9bdaf1aaadc160e62a138668e17c348f5e088f1f",
2023-03-14 04:28:15,721 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 04:28:15,721 - INFO - "md5sum": "791191a8fb551188ba60714ec47fc6de",
2023-03-14 04:28:15,721 - INFO - "remote_checksum": "9bdaf1aaadc160e62a138668e17c348f5e088f1f",
2023-03-14 04:28:15,721 - INFO - "remote_md5sum": null
2023-03-14 04:28:15,721 - INFO - }
2023-03-14 04:28:15,825 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 04:28:15,826 - INFO - 3.  collect the result
2023-03-14 04:28:15,984 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 04:28:15,984 - INFO - metric_name is: cpu_usage
2023-03-14 04:28:15,999 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678793295.977, '0.07316094166665911']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678793295.977, '0.07181304722221789']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678793295.977, '0.07520718611110877']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678793295.977, '0.07539692777777923']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678793295.977, '0.0759218749999996']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678793295.977, '0.07203623888888412']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678793295.977, '0.0013078888888887578']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod47f6888a_3d02_4fb9_9b96_ebf154941819.slice/cri-containerd-075a9c03a3b821d967c3641a1fa3205fc39862683fd509391f04fa524f9ba48a.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '075a9c03a3b821d967c3641a1fa3205fc39862683fd509391f04fa524f9ba48a', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4', 'service': 'kubelet'}, 'value': [1678793295.977, '52.21303014722221']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678793295.977, '0.00985595833333011']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678793295.977, '0.0011080638888883083']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678793295.977, '0.018773558333332906']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678793295.977, '0']}]
2023-03-14 04:28:16,000 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 04:28:16,000 - INFO - metric_name is: memory_usage
2023-03-14 04:28:16,000 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678793295.981, '386162688']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678793295.981, '386437120']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678793295.981, '386658304']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678793295.981, '386277376']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678793295.981, '386748416']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678793295.981, '386134016']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678793295.981, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4'}, 'value': [1678793295.981, '331935744']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678793295.981, '5093220352']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678793295.981, '15294464']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678793295.981, '2445189120']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678793295.981, '847872']}]
2023-03-14 04:28:16,000 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 04:28:16,000 - INFO - metric_name is: ei_infer_fps
2023-03-14 04:28:16,001 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.28:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678793295.985, '144.62713519924813']}]
2023-03-14 04:28:16,001 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 04:28:16,001 - INFO - metric_name is: ei_drop_fps
2023-03-14 04:28:16,001 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.28:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678793295.988, '25.156242721566453']}]
2023-03-14 04:28:16,001 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 04:28:16,001 - INFO - metric_name is: ei_scale_ratio
2023-03-14 04:28:16,001 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.28:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678793295.992, '1.1740577189148493']}]
2023-03-14 04:28:16,001 - INFO - Results written to metrics/7573_NON_VNNI_INT8_metrics_20230314_042815.txt
2023-03-14 04:28:16,068 - INFO - sleep 120 seconds for the next round ...
2023-03-14 04:30:16,071 - INFO - -----------loop num:2/3------------
2023-03-14 04:30:26,077 - INFO - 1.  fetch_emon.sh
2023-03-14 04:30:26,079 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 04:30:27,985 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:30:27,985 - INFO - "ansible_facts": {
2023-03-14 04:30:27,986 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:30:27,986 - INFO - },
2023-03-14 04:30:27,986 - INFO - "changed": false,
2023-03-14 04:30:27,986 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 04:30:27,986 - INFO - "dest": "runemon.sh",
2023-03-14 04:30:27,986 - INFO - "gid": 1007,
2023-03-14 04:30:27,986 - INFO - "group": "ansible",
2023-03-14 04:30:27,986 - INFO - "mode": "0755",
2023-03-14 04:30:27,986 - INFO - "owner": "ansible",
2023-03-14 04:30:27,986 - INFO - "path": "runemon.sh",
2023-03-14 04:30:27,986 - INFO - "size": 452,
2023-03-14 04:30:27,986 - INFO - "state": "file",
2023-03-14 04:30:27,987 - INFO - "uid": 1006
2023-03-14 04:30:27,987 - INFO - }
2023-03-14 04:30:29,434 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:30:29,435 - INFO - "ansible_facts": {
2023-03-14 04:30:29,435 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:30:29,435 - INFO - },
2023-03-14 04:30:29,435 - INFO - "changed": false,
2023-03-14 04:30:29,435 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 04:30:29,435 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 04:30:29,435 - INFO - "gid": 1007,
2023-03-14 04:30:29,435 - INFO - "group": "ansible",
2023-03-14 04:30:29,436 - INFO - "mode": "0664",
2023-03-14 04:30:29,436 - INFO - "owner": "ansible",
2023-03-14 04:30:29,436 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 04:30:29,436 - INFO - "size": 23423,
2023-03-14 04:30:29,436 - INFO - "state": "file",
2023-03-14 04:30:29,436 - INFO - "uid": 1006
2023-03-14 04:30:29,436 - INFO - }
2023-03-14 04:30:30,545 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:30:30,545 - INFO - 
2023-03-14 04:30:31,719 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:30:31,719 - INFO - 
2023-03-14 04:30:31,817 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 04:30:36,819 - INFO - Collecting 30 seconds sar data background
2023-03-14 04:30:38,790 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:30:38,791 - INFO - 
2023-03-14 04:30:40,852 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:30:40,852 - INFO - 
2023-03-14 04:30:42,894 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:30:42,894 - INFO - 
2023-03-14 04:30:44,966 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:30:44,966 - INFO - 
2023-03-14 04:30:45,069 - INFO - Collecting EMON data
2023-03-14 04:31:16,645 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:31:16,646 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 04:31:16,646 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 04:31:16,646 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 04:31:16,646 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 04:31:16,646 - INFO - LD_LIBRARY_PATH=
2023-03-14 04:31:16,646 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 04:31:16,646 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 04:31:16,646 - INFO - EMON collector successfully stopped.
2023-03-14 04:31:16,753 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 04:31:46,756 - INFO - Copy dat files
2023-03-14 04:31:47,763 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:31:47,764 - INFO - "changed": true,
2023-03-14 04:31:47,764 - INFO - "checksum": "45195ce343949178bd5b07112ff66ead1b1188d6",
2023-03-14 04:31:47,764 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 04:31:47,764 - INFO - "md5sum": "a00ddafeb908d138cea6a9a25aabff8f",
2023-03-14 04:31:47,764 - INFO - "remote_checksum": "45195ce343949178bd5b07112ff66ead1b1188d6",
2023-03-14 04:31:47,764 - INFO - "remote_md5sum": null
2023-03-14 04:31:47,764 - INFO - }
2023-03-14 04:31:48,873 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:31:48,874 - INFO - "changed": true,
2023-03-14 04:31:48,874 - INFO - "checksum": "2a0b2dfc917f9b239d178d1fcecfd0e29aad06be",
2023-03-14 04:31:48,874 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 04:31:48,874 - INFO - "md5sum": "bb8f3a4e73c2807044d7ad3b896127e7",
2023-03-14 04:31:48,874 - INFO - "remote_checksum": "2a0b2dfc917f9b239d178d1fcecfd0e29aad06be",
2023-03-14 04:31:48,874 - INFO - "remote_md5sum": null
2023-03-14 04:31:48,874 - INFO - }
2023-03-14 04:31:49,967 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:31:49,967 - INFO - "changed": true,
2023-03-14 04:31:49,968 - INFO - "checksum": "87a6f5a7228c65cd9e3a471f16d4d3af5a7224a5",
2023-03-14 04:31:49,968 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 04:31:49,968 - INFO - "md5sum": "09a44717271b109ffea3f5421c481629",
2023-03-14 04:31:49,968 - INFO - "remote_checksum": "87a6f5a7228c65cd9e3a471f16d4d3af5a7224a5",
2023-03-14 04:31:49,968 - INFO - "remote_md5sum": null
2023-03-14 04:31:49,968 - INFO - }
2023-03-14 04:31:51,113 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:31:51,113 - INFO - "changed": true,
2023-03-14 04:31:51,114 - INFO - "checksum": "4e5ef86bdfd6f4645af0c462cf1d6a1fd09498a4",
2023-03-14 04:31:51,114 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 04:31:51,114 - INFO - "md5sum": "8cea2f5b8b4c90bc051d78e5868a006a",
2023-03-14 04:31:51,114 - INFO - "remote_checksum": "4e5ef86bdfd6f4645af0c462cf1d6a1fd09498a4",
2023-03-14 04:31:51,114 - INFO - "remote_md5sum": null
2023-03-14 04:31:51,114 - INFO - }
2023-03-14 04:31:52,242 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:31:52,242 - INFO - "changed": true,
2023-03-14 04:31:52,242 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:31:52,242 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 04:31:52,242 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 04:31:52,243 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:31:52,243 - INFO - "remote_md5sum": null
2023-03-14 04:31:52,243 - INFO - }
2023-03-14 04:31:53,374 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:31:53,375 - INFO - "changed": true,
2023-03-14 04:31:53,375 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:31:53,375 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 04:31:53,375 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 04:31:53,375 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:31:53,375 - INFO - "remote_md5sum": null
2023-03-14 04:31:53,375 - INFO - }
2023-03-14 04:31:55,045 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:31:55,045 - INFO - "changed": true,
2023-03-14 04:31:55,045 - INFO - "checksum": "ee19f58c121cd7f3e75a18fceef8c06af226b2ce",
2023-03-14 04:31:55,045 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 04:31:55,045 - INFO - "md5sum": "5886b3ab5fad80df8f744ce10cef494d",
2023-03-14 04:31:55,046 - INFO - "remote_checksum": "ee19f58c121cd7f3e75a18fceef8c06af226b2ce",
2023-03-14 04:31:55,046 - INFO - "remote_md5sum": null
2023-03-14 04:31:55,046 - INFO - }
2023-03-14 04:31:55,155 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 04:31:55,156 - INFO - 3.  collect the result
2023-03-14 04:31:55,315 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 04:31:55,316 - INFO - metric_name is: cpu_usage
2023-03-14 04:31:55,330 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678793515.309, '0.07587530833332291']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678793515.309, '0.07472233611111327']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678793515.309, '0.07382985277778667']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678793515.309, '0.0765807027777656']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678793515.309, '0.07148513055555869']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678793515.309, '0.0708805916666582']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678793515.309, '0.0012433555555554044']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod47f6888a_3d02_4fb9_9b96_ebf154941819.slice/cri-containerd-075a9c03a3b821d967c3641a1fa3205fc39862683fd509391f04fa524f9ba48a.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '075a9c03a3b821d967c3641a1fa3205fc39862683fd509391f04fa524f9ba48a', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4', 'service': 'kubelet'}, 'value': [1678793515.309, '50.852820727777775']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678793515.309, '0.01059692222222313']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678793515.309, '0.001140902777778289']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678793515.309, '0.018861852777778645']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678793515.309, '0']}]
2023-03-14 04:31:55,330 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 04:31:55,330 - INFO - metric_name is: memory_usage
2023-03-14 04:31:55,331 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678793515.313, '386166784']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678793515.313, '386437120']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678793515.313, '386445312']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678793515.313, '386277376']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678793515.313, '386494464']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678793515.313, '386134016']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678793515.313, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4'}, 'value': [1678793515.313, '331759616']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678793515.313, '5093163008']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678793515.313, '15298560']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678793515.313, '2445565952']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678793515.313, '847872']}]
2023-03-14 04:31:55,331 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 04:31:55,331 - INFO - metric_name is: ei_infer_fps
2023-03-14 04:31:55,331 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.28:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678793515.317, '145.32466500123576']}]
2023-03-14 04:31:55,331 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 04:31:55,331 - INFO - metric_name is: ei_drop_fps
2023-03-14 04:31:55,331 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.28:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678793515.321, '24.801727544155703']}]
2023-03-14 04:31:55,331 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 04:31:55,331 - INFO - metric_name is: ei_scale_ratio
2023-03-14 04:31:55,331 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.28:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678793515.324, '1.1708308993801155']}]
2023-03-14 04:31:55,331 - INFO - Results written to metrics/7573_NON_VNNI_INT8_metrics_20230314_043155.txt
2023-03-14 04:31:55,395 - INFO - sleep 120 seconds for the next round ...
2023-03-14 04:33:55,398 - INFO - -----------loop num:3/3------------
2023-03-14 04:34:05,404 - INFO - 1.  fetch_emon.sh
2023-03-14 04:34:05,406 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 04:34:07,306 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:34:07,306 - INFO - "ansible_facts": {
2023-03-14 04:34:07,306 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:34:07,307 - INFO - },
2023-03-14 04:34:07,307 - INFO - "changed": false,
2023-03-14 04:34:07,307 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 04:34:07,307 - INFO - "dest": "runemon.sh",
2023-03-14 04:34:07,307 - INFO - "gid": 1007,
2023-03-14 04:34:07,307 - INFO - "group": "ansible",
2023-03-14 04:34:07,307 - INFO - "mode": "0755",
2023-03-14 04:34:07,307 - INFO - "owner": "ansible",
2023-03-14 04:34:07,307 - INFO - "path": "runemon.sh",
2023-03-14 04:34:07,307 - INFO - "size": 452,
2023-03-14 04:34:07,307 - INFO - "state": "file",
2023-03-14 04:34:07,307 - INFO - "uid": 1006
2023-03-14 04:34:07,308 - INFO - }
2023-03-14 04:34:08,713 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:34:08,713 - INFO - "ansible_facts": {
2023-03-14 04:34:08,714 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:34:08,714 - INFO - },
2023-03-14 04:34:08,714 - INFO - "changed": false,
2023-03-14 04:34:08,714 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 04:34:08,714 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 04:34:08,714 - INFO - "gid": 1007,
2023-03-14 04:34:08,714 - INFO - "group": "ansible",
2023-03-14 04:34:08,714 - INFO - "mode": "0664",
2023-03-14 04:34:08,714 - INFO - "owner": "ansible",
2023-03-14 04:34:08,714 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 04:34:08,714 - INFO - "size": 23423,
2023-03-14 04:34:08,714 - INFO - "state": "file",
2023-03-14 04:34:08,715 - INFO - "uid": 1006
2023-03-14 04:34:08,715 - INFO - }
2023-03-14 04:34:09,791 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:34:09,792 - INFO - 
2023-03-14 04:34:10,847 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:34:10,847 - INFO - 
2023-03-14 04:34:10,944 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 04:34:15,947 - INFO - Collecting 30 seconds sar data background
2023-03-14 04:34:17,920 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:34:17,921 - INFO - 
2023-03-14 04:34:19,971 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:34:19,971 - INFO - 
2023-03-14 04:34:22,137 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:34:22,137 - INFO - 
2023-03-14 04:34:24,246 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:34:24,246 - INFO - 
2023-03-14 04:34:24,342 - INFO - Collecting EMON data
2023-03-14 04:34:55,889 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:34:55,889 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 04:34:55,889 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 04:34:55,889 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 04:34:55,889 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 04:34:55,889 - INFO - LD_LIBRARY_PATH=
2023-03-14 04:34:55,889 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 04:34:55,889 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 04:34:55,890 - INFO - EMON collector successfully stopped.
2023-03-14 04:34:56,002 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 04:35:26,005 - INFO - Copy dat files
2023-03-14 04:35:27,020 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:35:27,021 - INFO - "changed": true,
2023-03-14 04:35:27,021 - INFO - "checksum": "c637ef0e9858c5d6343ea02e86fe1b9cde145faf",
2023-03-14 04:35:27,021 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 04:35:27,021 - INFO - "md5sum": "efd3da225e9d9a54437b897ed6e3832b",
2023-03-14 04:35:27,021 - INFO - "remote_checksum": "c637ef0e9858c5d6343ea02e86fe1b9cde145faf",
2023-03-14 04:35:27,021 - INFO - "remote_md5sum": null
2023-03-14 04:35:27,021 - INFO - }
2023-03-14 04:35:28,133 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:35:28,133 - INFO - "changed": true,
2023-03-14 04:35:28,133 - INFO - "checksum": "faf25b787c98274de3a3069beffc35fd768e010c",
2023-03-14 04:35:28,134 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 04:35:28,134 - INFO - "md5sum": "69fc927d037db7585dcce51d9c8c7aea",
2023-03-14 04:35:28,134 - INFO - "remote_checksum": "faf25b787c98274de3a3069beffc35fd768e010c",
2023-03-14 04:35:28,134 - INFO - "remote_md5sum": null
2023-03-14 04:35:28,134 - INFO - }
2023-03-14 04:35:29,260 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:35:29,260 - INFO - "changed": true,
2023-03-14 04:35:29,260 - INFO - "checksum": "abe694382c11f608e741d9f9e09533b0ba730e13",
2023-03-14 04:35:29,260 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 04:35:29,261 - INFO - "md5sum": "dfc1389596f31af94641e673012f28f7",
2023-03-14 04:35:29,261 - INFO - "remote_checksum": "abe694382c11f608e741d9f9e09533b0ba730e13",
2023-03-14 04:35:29,261 - INFO - "remote_md5sum": null
2023-03-14 04:35:29,261 - INFO - }
2023-03-14 04:35:30,401 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:35:30,401 - INFO - "changed": true,
2023-03-14 04:35:30,401 - INFO - "checksum": "0662da7002a7d87cb952a222dd8ad91c77072e23",
2023-03-14 04:35:30,402 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 04:35:30,402 - INFO - "md5sum": "b5133621ff4f047b00ffaefe061fb970",
2023-03-14 04:35:30,402 - INFO - "remote_checksum": "0662da7002a7d87cb952a222dd8ad91c77072e23",
2023-03-14 04:35:30,402 - INFO - "remote_md5sum": null
2023-03-14 04:35:30,402 - INFO - }
2023-03-14 04:35:31,512 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:35:31,512 - INFO - "changed": true,
2023-03-14 04:35:31,512 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:35:31,513 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 04:35:31,513 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 04:35:31,513 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:35:31,513 - INFO - "remote_md5sum": null
2023-03-14 04:35:31,513 - INFO - }
2023-03-14 04:35:32,620 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:35:32,620 - INFO - "changed": true,
2023-03-14 04:35:32,620 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:35:32,621 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 04:35:32,621 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 04:35:32,621 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:35:32,621 - INFO - "remote_md5sum": null
2023-03-14 04:35:32,621 - INFO - }
2023-03-14 04:35:34,321 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:35:34,321 - INFO - "changed": true,
2023-03-14 04:35:34,321 - INFO - "checksum": "4fd0fd323f7a56819452f8071d2b237fc6acde9a",
2023-03-14 04:35:34,321 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 04:35:34,321 - INFO - "md5sum": "e47763f66475a0488a645a25f8654d47",
2023-03-14 04:35:34,322 - INFO - "remote_checksum": "4fd0fd323f7a56819452f8071d2b237fc6acde9a",
2023-03-14 04:35:34,322 - INFO - "remote_md5sum": null
2023-03-14 04:35:34,322 - INFO - }
2023-03-14 04:35:34,425 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 04:35:34,425 - INFO - 3.  collect the result
2023-03-14 04:35:34,571 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 04:35:34,572 - INFO - metric_name is: cpu_usage
2023-03-14 04:35:34,586 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678793734.564, '0.07058094166665493']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678793734.564, '0.07700027222221656']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678793734.564, '0.07662188611110549']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678793734.564, '0.0749064500000006']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678793734.564, '0.0726272472222263']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678793734.564, '0.07899241944445141']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678793734.564, '0.001299980555555496']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod47f6888a_3d02_4fb9_9b96_ebf154941819.slice/cri-containerd-075a9c03a3b821d967c3641a1fa3205fc39862683fd509391f04fa524f9ba48a.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '075a9c03a3b821d967c3641a1fa3205fc39862683fd509391f04fa524f9ba48a', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4', 'service': 'kubelet'}, 'value': [1678793734.564, '50.00948301666667']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678793734.564, '0.01009823333333265']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678793734.564, '0.0010373194444456303']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678793734.564, '0.01940693611111328']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678793734.564, '0']}]
2023-03-14 04:35:34,586 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 04:35:34,586 - INFO - metric_name is: memory_usage
2023-03-14 04:35:34,586 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678793734.569, '386273280']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678793734.569, '386564096']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678793734.569, '386572288']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678793734.569, '386150400']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678793734.569, '386600960']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678793734.569, '386113536']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678793734.569, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4'}, 'value': [1678793734.569, '331747328']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678793734.569, '5093220352']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678793734.569, '15167488']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678793734.569, '2445156352']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678793734.569, '847872']}]
2023-03-14 04:35:34,587 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 04:35:34,587 - INFO - metric_name is: ei_infer_fps
2023-03-14 04:35:34,587 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.28:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678793734.573, '149.2281935044229']}]
2023-03-14 04:35:34,587 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 04:35:34,587 - INFO - metric_name is: ei_drop_fps
2023-03-14 04:35:34,587 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.28:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678793734.576, '20.718348960057092']}]
2023-03-14 04:35:34,587 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 04:35:34,587 - INFO - metric_name is: ei_scale_ratio
2023-03-14 04:35:34,587 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.28:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678793734.58, '1.1400240682721514']}]
2023-03-14 04:35:34,587 - INFO - Results written to metrics/7573_NON_VNNI_INT8_metrics_20230314_043534.txt
2023-03-14 04:35:34,655 - INFO - ------------- scenario: 4/4 ------------
2023-03-14 04:35:34,655 - INFO - Begin set_deployment_env of scenario : AMX_IN8 ...
2023-03-14 04:35:34,706 - INFO - Setting environment variables for scenario AMX_IN8...
2023-03-14 04:35:34,724 - INFO - Setting resource requests and limits for scenario AMX_IN8...
2023-03-14 04:35:34,745 - INFO - after patch_body wait for 30 seconds to enable the new pods
2023-03-14 04:36:04,776 - INFO - Waiting for 1 pods to be ready for scenario AMX_IN8...
2023-03-14 04:36:04,853 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:36:04,853 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:36:04,853 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 0.08 seconds
2023-03-14 04:36:14,889 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:36:14,889 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:36:14,889 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 10.11 seconds
2023-03-14 04:36:24,925 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:36:24,925 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:36:24,925 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 20.15 seconds
2023-03-14 04:36:34,961 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:36:34,961 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:36:34,961 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 30.18 seconds
2023-03-14 04:36:44,999 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:36:44,999 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:36:44,999 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 40.22 seconds
2023-03-14 04:36:55,036 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:36:55,036 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:36:55,036 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 50.26 seconds
2023-03-14 04:37:05,073 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:37:05,073 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:37:05,073 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 60.30 seconds
2023-03-14 04:37:15,110 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:37:15,111 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:37:15,111 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 70.33 seconds
2023-03-14 04:37:25,146 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:37:25,146 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:37:25,146 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 80.37 seconds
2023-03-14 04:37:35,184 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:37:35,184 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:37:35,185 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 90.41 seconds
2023-03-14 04:37:45,222 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:37:45,222 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:37:45,222 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 100.45 seconds
2023-03-14 04:37:55,285 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:37:55,285 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:37:55,285 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 110.51 seconds
2023-03-14 04:38:05,321 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:38:05,321 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:38:05,321 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 120.54 seconds
2023-03-14 04:38:15,356 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:38:15,357 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:38:15,357 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 130.58 seconds
2023-03-14 04:38:25,393 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:38:25,393 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:38:25,393 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 140.62 seconds
2023-03-14 04:38:35,428 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:38:35,429 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:38:35,429 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 150.65 seconds
2023-03-14 04:38:45,465 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:38:45,465 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:38:45,465 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 160.69 seconds
2023-03-14 04:38:55,500 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:38:55,500 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:38:55,500 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 170.72 seconds
2023-03-14 04:39:05,525 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:39:05,526 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:39:05,526 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 180.75 seconds
2023-03-14 04:39:15,561 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:39:15,561 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:39:15,561 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 190.78 seconds
2023-03-14 04:39:25,597 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:39:25,597 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:39:25,598 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 200.82 seconds
2023-03-14 04:39:35,632 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:39:35,632 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:39:35,633 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 210.86 seconds
2023-03-14 04:39:45,668 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:39:45,669 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:39:45,669 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 220.89 seconds
2023-03-14 04:39:55,704 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:39:55,704 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:39:55,705 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 230.93 seconds
2023-03-14 04:40:05,740 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:40:05,741 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:40:05,741 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 240.96 seconds
2023-03-14 04:40:15,778 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:40:15,778 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:40:15,778 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 251.00 seconds
2023-03-14 04:40:25,814 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:40:25,814 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:40:25,814 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 261.04 seconds
2023-03-14 04:40:35,852 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:40:35,852 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:40:35,852 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 271.08 seconds
2023-03-14 04:40:45,886 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:40:45,886 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:40:45,886 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 281.11 seconds
2023-03-14 04:40:55,923 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:40:55,924 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:40:55,924 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 291.15 seconds
2023-03-14 04:41:05,959 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:41:05,960 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:41:05,960 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 301.18 seconds
2023-03-14 04:41:15,994 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:41:15,994 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:41:15,994 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 311.22 seconds
2023-03-14 04:41:26,033 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:41:26,033 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:41:26,034 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 321.26 seconds
2023-03-14 04:41:36,070 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:41:36,070 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:41:36,070 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 331.29 seconds
2023-03-14 04:41:46,106 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:41:46,107 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:41:46,107 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 341.33 seconds
2023-03-14 04:41:56,144 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:41:56,144 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:41:56,145 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 351.37 seconds
2023-03-14 04:42:06,182 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:42:06,182 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:42:06,182 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 361.41 seconds
2023-03-14 04:42:16,219 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:42:16,219 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:42:16,219 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 371.44 seconds
2023-03-14 04:42:26,257 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:42:26,258 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:42:26,258 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 381.48 seconds
2023-03-14 04:42:36,296 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:42:36,296 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:42:36,296 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 391.52 seconds
2023-03-14 04:42:46,335 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:42:46,335 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:42:46,335 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 401.56 seconds
2023-03-14 04:42:56,374 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:42:56,374 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:42:56,374 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 411.60 seconds
2023-03-14 04:43:06,412 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:43:06,412 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:43:06,413 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 421.64 seconds
2023-03-14 04:43:16,470 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:43:16,470 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:43:16,470 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 431.69 seconds
2023-03-14 04:43:26,506 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:43:26,507 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:43:26,507 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 441.73 seconds
2023-03-14 04:43:36,545 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:43:36,545 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:43:36,545 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 451.77 seconds
2023-03-14 04:43:46,582 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:43:46,582 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:43:46,582 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 461.81 seconds
2023-03-14 04:43:56,621 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:43:56,621 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:43:56,622 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 471.84 seconds
2023-03-14 04:44:06,656 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:44:06,656 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:44:06,657 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 481.88 seconds
2023-03-14 04:44:16,693 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:44:16,693 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:44:16,693 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 491.92 seconds
2023-03-14 04:44:26,729 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:44:26,729 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:44:26,729 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 501.95 seconds
2023-03-14 04:44:36,766 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:44:36,766 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:44:36,766 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 511.99 seconds
2023-03-14 04:44:46,803 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:44:46,804 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:44:46,804 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 522.03 seconds
2023-03-14 04:44:56,838 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:44:56,838 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:44:56,838 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 532.06 seconds
2023-03-14 04:45:06,874 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Pending
2023-03-14 04:45:06,874 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-748b5d64b4-gq6m4 status:Running
2023-03-14 04:45:06,874 - INFO - Waiting for 0 more pods to be ready, there are 1 not ready pods for scenario AMX_IN8. Elapsed time: 542.10 seconds
2023-03-14 04:45:16,903 - INFO - pod: ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q status:Running
2023-03-14 04:45:16,903 - INFO - All 1 pods are ready for scenario AMX_IN8
2023-03-14 04:45:16,904 - INFO - Finished scenario AMX_IN8
2023-03-14 04:45:16,905 - INFO - wait for 2m to get stable metrics ...
2023-03-14 04:47:17,005 - INFO - Running benchmarking script for scenario AMX_IN8...
2023-03-14 04:47:17,016 - INFO - TS=20230314044717
2023-03-14 04:47:18,937 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:47:18,938 - INFO - Reading package lists...
2023-03-14 04:47:18,938 - INFO - Building dependency tree...
2023-03-14 04:47:18,938 - INFO - Reading state information...
2023-03-14 04:47:18,938 - INFO - linux-tools-5.15.0-60-generic is already the newest version (5.15.0-60.66).
2023-03-14 04:47:18,938 - INFO - sysstat is already the newest version (12.5.2-2ubuntu0.1).
2023-03-14 04:47:18,938 - INFO - The following packages were automatically installed and are no longer required:
2023-03-14 04:47:18,938 - INFO - cgroupfs-mount libltdl7 pigz
2023-03-14 04:47:18,938 - INFO - Use 'sudo apt autoremove' to remove them.
2023-03-14 04:47:18,938 - INFO - 0 upgraded, 0 newly installed, 0 to remove and 41 not upgraded.
2023-03-14 04:47:18,939 - INFO - WARNING: apt does not have a stable CLI interface. Use with caution in scripts.
2023-03-14 04:47:20,037 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:47:20,037 - INFO - 
2023-03-14 04:47:21,117 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:47:21,117 - INFO - performance
2023-03-14 04:47:21,217 - INFO - Run on test AiPipeline_20230314044717_7573_AMX_IN8_6
2023-03-14 04:47:21,217 - INFO - TT=AiPipeline_20230314044717_7573_AMX_IN8_6,WRKDIR=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 04:47:21,223 - INFO - -----------loop num:1/3------------
2023-03-14 04:47:31,228 - INFO - 1.  fetch_emon.sh
2023-03-14 04:47:31,230 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 04:47:32,543 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:47:32,544 - INFO - "ansible_facts": {
2023-03-14 04:47:32,544 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:47:32,544 - INFO - },
2023-03-14 04:47:32,544 - INFO - "changed": false,
2023-03-14 04:47:32,544 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 04:47:32,544 - INFO - "dest": "runemon.sh",
2023-03-14 04:47:32,544 - INFO - "gid": 1007,
2023-03-14 04:47:32,544 - INFO - "group": "ansible",
2023-03-14 04:47:32,544 - INFO - "mode": "0755",
2023-03-14 04:47:32,544 - INFO - "owner": "ansible",
2023-03-14 04:47:32,545 - INFO - "path": "runemon.sh",
2023-03-14 04:47:32,545 - INFO - "size": 452,
2023-03-14 04:47:32,545 - INFO - "state": "file",
2023-03-14 04:47:32,545 - INFO - "uid": 1006
2023-03-14 04:47:32,545 - INFO - }
2023-03-14 04:47:33,940 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:47:33,941 - INFO - "ansible_facts": {
2023-03-14 04:47:33,941 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:47:33,941 - INFO - },
2023-03-14 04:47:33,941 - INFO - "changed": false,
2023-03-14 04:47:33,941 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 04:47:33,941 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 04:47:33,941 - INFO - "gid": 1007,
2023-03-14 04:47:33,941 - INFO - "group": "ansible",
2023-03-14 04:47:33,942 - INFO - "mode": "0664",
2023-03-14 04:47:33,942 - INFO - "owner": "ansible",
2023-03-14 04:47:33,942 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 04:47:33,942 - INFO - "size": 23423,
2023-03-14 04:47:33,942 - INFO - "state": "file",
2023-03-14 04:47:33,942 - INFO - "uid": 1006
2023-03-14 04:47:33,942 - INFO - }
2023-03-14 04:47:35,021 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:47:35,021 - INFO - 
2023-03-14 04:47:36,089 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:47:36,089 - INFO - 
2023-03-14 04:47:36,189 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 04:47:41,192 - INFO - Collecting 30 seconds sar data background
2023-03-14 04:47:43,159 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:47:43,159 - INFO - 
2023-03-14 04:47:45,219 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:47:45,220 - INFO - 
2023-03-14 04:47:47,296 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:47:47,297 - INFO - 
2023-03-14 04:47:49,359 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:47:49,360 - INFO - 
2023-03-14 04:47:49,462 - INFO - Collecting EMON data
2023-03-14 04:48:21,039 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:48:21,040 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 04:48:21,040 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 04:48:21,040 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 04:48:21,040 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 04:48:21,040 - INFO - LD_LIBRARY_PATH=
2023-03-14 04:48:21,040 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 04:48:21,040 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 04:48:21,040 - INFO - EMON collector successfully stopped.
2023-03-14 04:48:21,143 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 04:48:51,146 - INFO - Copy dat files
2023-03-14 04:48:52,208 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:48:52,208 - INFO - "changed": true,
2023-03-14 04:48:52,208 - INFO - "checksum": "99b12ce4b084233cf9d85b200d52ef7a4ed7147c",
2023-03-14 04:48:52,208 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 04:48:52,208 - INFO - "md5sum": "6373f30b71b3b976a7ee64fbc7aeb1fb",
2023-03-14 04:48:52,208 - INFO - "remote_checksum": "99b12ce4b084233cf9d85b200d52ef7a4ed7147c",
2023-03-14 04:48:52,209 - INFO - "remote_md5sum": null
2023-03-14 04:48:52,209 - INFO - }
2023-03-14 04:48:53,311 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:48:53,311 - INFO - "changed": true,
2023-03-14 04:48:53,311 - INFO - "checksum": "e0fa6c821fdad16b91404d509ab3933104a89af8",
2023-03-14 04:48:53,311 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 04:48:53,311 - INFO - "md5sum": "fdafb1e17aaebcbdcf2905ba2fb876c2",
2023-03-14 04:48:53,311 - INFO - "remote_checksum": "e0fa6c821fdad16b91404d509ab3933104a89af8",
2023-03-14 04:48:53,312 - INFO - "remote_md5sum": null
2023-03-14 04:48:53,312 - INFO - }
2023-03-14 04:48:54,469 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:48:54,469 - INFO - "changed": true,
2023-03-14 04:48:54,469 - INFO - "checksum": "58547e0ed81ae48ba4214fa23178b6bf41070184",
2023-03-14 04:48:54,470 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 04:48:54,470 - INFO - "md5sum": "2271b9645aecebea71099da24ec24567",
2023-03-14 04:48:54,470 - INFO - "remote_checksum": "58547e0ed81ae48ba4214fa23178b6bf41070184",
2023-03-14 04:48:54,470 - INFO - "remote_md5sum": null
2023-03-14 04:48:54,470 - INFO - }
2023-03-14 04:48:55,619 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:48:55,619 - INFO - "changed": true,
2023-03-14 04:48:55,619 - INFO - "checksum": "7989d0e962f70f75787559ba52eeac9c65f0c11c",
2023-03-14 04:48:55,620 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 04:48:55,620 - INFO - "md5sum": "44366b5ef8b59348275cd899226ccd60",
2023-03-14 04:48:55,620 - INFO - "remote_checksum": "7989d0e962f70f75787559ba52eeac9c65f0c11c",
2023-03-14 04:48:55,620 - INFO - "remote_md5sum": null
2023-03-14 04:48:55,620 - INFO - }
2023-03-14 04:48:56,702 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:48:56,702 - INFO - "changed": true,
2023-03-14 04:48:56,702 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:48:56,702 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 04:48:56,703 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 04:48:56,703 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:48:56,703 - INFO - "remote_md5sum": null
2023-03-14 04:48:56,703 - INFO - }
2023-03-14 04:48:57,793 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:48:57,793 - INFO - "changed": true,
2023-03-14 04:48:57,793 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:48:57,793 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 04:48:57,793 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 04:48:57,793 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:48:57,793 - INFO - "remote_md5sum": null
2023-03-14 04:48:57,793 - INFO - }
2023-03-14 04:48:59,534 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:48:59,535 - INFO - "changed": true,
2023-03-14 04:48:59,535 - INFO - "checksum": "5c60eae590ac7cc3f56728b3776d990cc01a689e",
2023-03-14 04:48:59,535 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 04:48:59,535 - INFO - "md5sum": "89d6a01f88567278b48edbe735d098db",
2023-03-14 04:48:59,535 - INFO - "remote_checksum": "5c60eae590ac7cc3f56728b3776d990cc01a689e",
2023-03-14 04:48:59,535 - INFO - "remote_md5sum": null
2023-03-14 04:48:59,535 - INFO - }
2023-03-14 04:48:59,631 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 04:48:59,631 - INFO - 3.  collect the result
2023-03-14 04:48:59,790 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 04:48:59,790 - INFO - metric_name is: cpu_usage
2023-03-14 04:48:59,805 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678794539.783, '0.07202257499999784']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678794539.783, '0.07848565833333446']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678794539.783, '0.07911423055555941']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678794539.783, '0.07831152222222751']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678794539.783, '0.07958227222223083']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678794539.783, '0.07389850000000579']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678794539.783, '0.0013404333333331426']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod2bb1e370_d60b_4967_a2d4_95610f5ea7b3.slice/cri-containerd-1803408b7565507cd8ec6b53a23fcc9c2e769e5da09ea16ed1fcf4b1eadbe5f9.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1803408b7565507cd8ec6b53a23fcc9c2e769e5da09ea16ed1fcf4b1eadbe5f9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q', 'service': 'kubelet'}, 'value': [1678794539.783, '49.038200237512456']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678794539.783, '0.010872891666667783']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678794539.783, '0.001065225000000838']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678794539.783, '0.020017705555556452']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678794539.783, '0']}]
2023-03-14 04:48:59,805 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 04:48:59,806 - INFO - metric_name is: memory_usage
2023-03-14 04:48:59,806 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678794539.788, '386293760']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678794539.788, '386564096']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678794539.788, '386572288']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678794539.788, '386379776']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678794539.788, '386494464']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678794539.788, '386134016']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678794539.788, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q'}, 'value': [1678794539.788, '347357184']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678794539.788, '5093322752']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678794539.788, '15962112']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678794539.788, '2445135872']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678794539.788, '847872']}]
2023-03-14 04:48:59,806 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 04:48:59,806 - INFO - metric_name is: ei_infer_fps
2023-03-14 04:48:59,806 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.16:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678794539.792, '159.94768571114955']}]
2023-03-14 04:48:59,806 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 04:48:59,806 - INFO - metric_name is: ei_drop_fps
2023-03-14 04:48:59,806 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.16:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678794539.795, '9.872383720462048']}]
2023-03-14 04:48:59,806 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 04:48:59,806 - INFO - metric_name is: ei_scale_ratio
2023-03-14 04:48:59,806 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.16:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678794539.799, '1.0620714820632082']}]
2023-03-14 04:48:59,806 - INFO - Results written to metrics/7573_AMX_IN8_metrics_20230314_044859.txt
2023-03-14 04:48:59,874 - INFO - sleep 120 seconds for the next round ...
2023-03-14 04:50:59,877 - INFO - -----------loop num:2/3------------
2023-03-14 04:51:09,883 - INFO - 1.  fetch_emon.sh
2023-03-14 04:51:09,884 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 04:51:11,783 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:51:11,783 - INFO - "ansible_facts": {
2023-03-14 04:51:11,783 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:51:11,783 - INFO - },
2023-03-14 04:51:11,784 - INFO - "changed": false,
2023-03-14 04:51:11,784 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 04:51:11,784 - INFO - "dest": "runemon.sh",
2023-03-14 04:51:11,784 - INFO - "gid": 1007,
2023-03-14 04:51:11,784 - INFO - "group": "ansible",
2023-03-14 04:51:11,784 - INFO - "mode": "0755",
2023-03-14 04:51:11,784 - INFO - "owner": "ansible",
2023-03-14 04:51:11,784 - INFO - "path": "runemon.sh",
2023-03-14 04:51:11,784 - INFO - "size": 452,
2023-03-14 04:51:11,784 - INFO - "state": "file",
2023-03-14 04:51:11,784 - INFO - "uid": 1006
2023-03-14 04:51:11,785 - INFO - }
2023-03-14 04:51:13,168 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:51:13,168 - INFO - "ansible_facts": {
2023-03-14 04:51:13,168 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:51:13,168 - INFO - },
2023-03-14 04:51:13,168 - INFO - "changed": false,
2023-03-14 04:51:13,168 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 04:51:13,169 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 04:51:13,169 - INFO - "gid": 1007,
2023-03-14 04:51:13,169 - INFO - "group": "ansible",
2023-03-14 04:51:13,169 - INFO - "mode": "0664",
2023-03-14 04:51:13,169 - INFO - "owner": "ansible",
2023-03-14 04:51:13,169 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 04:51:13,169 - INFO - "size": 23423,
2023-03-14 04:51:13,169 - INFO - "state": "file",
2023-03-14 04:51:13,169 - INFO - "uid": 1006
2023-03-14 04:51:13,169 - INFO - }
2023-03-14 04:51:14,269 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:51:14,269 - INFO - 
2023-03-14 04:51:15,327 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:51:15,328 - INFO - 
2023-03-14 04:51:15,531 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 04:51:20,534 - INFO - Collecting 30 seconds sar data background
2023-03-14 04:51:22,492 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:51:22,493 - INFO - 
2023-03-14 04:51:24,561 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:51:24,562 - INFO - 
2023-03-14 04:51:26,620 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:51:26,620 - INFO - 
2023-03-14 04:51:28,691 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:51:28,691 - INFO - 
2023-03-14 04:51:28,798 - INFO - Collecting EMON data
2023-03-14 04:52:00,413 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:52:00,414 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 04:52:00,414 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 04:52:00,414 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 04:52:00,414 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 04:52:00,414 - INFO - LD_LIBRARY_PATH=
2023-03-14 04:52:00,414 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 04:52:00,415 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 04:52:00,415 - INFO - EMON collector successfully stopped.
2023-03-14 04:52:00,524 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 04:52:30,527 - INFO - Copy dat files
2023-03-14 04:52:31,543 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:52:31,544 - INFO - "changed": true,
2023-03-14 04:52:31,544 - INFO - "checksum": "1104ec989108cb8b8d93965b03e8875049a3f2b5",
2023-03-14 04:52:31,544 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 04:52:31,544 - INFO - "md5sum": "f7f5f0e82875018c6ccbd555f0c5aafa",
2023-03-14 04:52:31,544 - INFO - "remote_checksum": "1104ec989108cb8b8d93965b03e8875049a3f2b5",
2023-03-14 04:52:31,544 - INFO - "remote_md5sum": null
2023-03-14 04:52:31,544 - INFO - }
2023-03-14 04:52:32,665 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:52:32,666 - INFO - "changed": true,
2023-03-14 04:52:32,666 - INFO - "checksum": "9d78c30d51e3a7b92e2d9113d8018d35524f240d",
2023-03-14 04:52:32,666 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 04:52:32,666 - INFO - "md5sum": "e56fbc8a5ee12b1a1821928b2b9e5778",
2023-03-14 04:52:32,666 - INFO - "remote_checksum": "9d78c30d51e3a7b92e2d9113d8018d35524f240d",
2023-03-14 04:52:32,666 - INFO - "remote_md5sum": null
2023-03-14 04:52:32,666 - INFO - }
2023-03-14 04:52:33,778 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:52:33,778 - INFO - "changed": true,
2023-03-14 04:52:33,779 - INFO - "checksum": "e51270408f5d54b2fc09b65941105bd46f8e0a70",
2023-03-14 04:52:33,779 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 04:52:33,779 - INFO - "md5sum": "2b82a3e6ebcb8e9c8a3cca788ebd6f7d",
2023-03-14 04:52:33,779 - INFO - "remote_checksum": "e51270408f5d54b2fc09b65941105bd46f8e0a70",
2023-03-14 04:52:33,779 - INFO - "remote_md5sum": null
2023-03-14 04:52:33,779 - INFO - }
2023-03-14 04:52:35,002 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:52:35,002 - INFO - "changed": true,
2023-03-14 04:52:35,002 - INFO - "checksum": "4d6b1ecd910ce947c1c8d79d859454c2b691a550",
2023-03-14 04:52:35,002 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 04:52:35,002 - INFO - "md5sum": "9f244d3f8d9bd9a69f92cd7b769c5948",
2023-03-14 04:52:35,002 - INFO - "remote_checksum": "4d6b1ecd910ce947c1c8d79d859454c2b691a550",
2023-03-14 04:52:35,003 - INFO - "remote_md5sum": null
2023-03-14 04:52:35,003 - INFO - }
2023-03-14 04:52:36,104 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:52:36,105 - INFO - "changed": true,
2023-03-14 04:52:36,105 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:52:36,105 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 04:52:36,105 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 04:52:36,105 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:52:36,105 - INFO - "remote_md5sum": null
2023-03-14 04:52:36,105 - INFO - }
2023-03-14 04:52:37,261 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:52:37,261 - INFO - "changed": true,
2023-03-14 04:52:37,262 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:52:37,262 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 04:52:37,262 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 04:52:37,262 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:52:37,262 - INFO - "remote_md5sum": null
2023-03-14 04:52:37,262 - INFO - }
2023-03-14 04:52:38,891 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:52:38,892 - INFO - "changed": true,
2023-03-14 04:52:38,892 - INFO - "checksum": "53bd5a465f711bbee080bfb86f22324756fb23df",
2023-03-14 04:52:38,892 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 04:52:38,892 - INFO - "md5sum": "076c140314ed0208f2ad0966976cad90",
2023-03-14 04:52:38,892 - INFO - "remote_checksum": "53bd5a465f711bbee080bfb86f22324756fb23df",
2023-03-14 04:52:38,892 - INFO - "remote_md5sum": null
2023-03-14 04:52:38,892 - INFO - }
2023-03-14 04:52:38,990 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 04:52:38,990 - INFO - 3.  collect the result
2023-03-14 04:52:39,148 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 04:52:39,149 - INFO - metric_name is: cpu_usage
2023-03-14 04:52:39,163 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678794759.142, '0.07253379166667298']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678794759.142, '0.07605291944445425']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678794759.142, '0.0758531694444375']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678794759.142, '0.0710487694444459']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678794759.142, '0.06811096944442802']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678794759.142, '0.07953757222221611']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678794759.142, '0.001280222222221836']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod2bb1e370_d60b_4967_a2d4_95610f5ea7b3.slice/cri-containerd-1803408b7565507cd8ec6b53a23fcc9c2e769e5da09ea16ed1fcf4b1eadbe5f9.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1803408b7565507cd8ec6b53a23fcc9c2e769e5da09ea16ed1fcf4b1eadbe5f9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q', 'service': 'kubelet'}, 'value': [1678794759.142, '50.99714714722221']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678794759.142, '0.01061147777777478']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678794759.142, '0.001035869444443607']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678794759.142, '0.0199558583333328']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678794759.142, '0']}]
2023-03-14 04:52:39,163 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 04:52:39,163 - INFO - metric_name is: memory_usage
2023-03-14 04:52:39,163 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678794759.146, '386166784']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678794759.146, '386560000']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678794759.146, '386441216']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678794759.146, '386252800']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678794759.146, '386494464']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678794759.146, '386002944']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678794759.146, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q'}, 'value': [1678794759.146, '346984448']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678794759.146, '5093289984']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678794759.146, '15167488']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678794759.146, '2445074432']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678794759.146, '847872']}]
2023-03-14 04:52:39,163 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 04:52:39,164 - INFO - metric_name is: ei_infer_fps
2023-03-14 04:52:39,164 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.16:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678794759.15, '163.38228848737043']}]
2023-03-14 04:52:39,164 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 04:52:39,164 - INFO - metric_name is: ei_drop_fps
2023-03-14 04:52:39,164 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.16:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678794759.154, '6.697798433206236']}]
2023-03-14 04:52:39,164 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 04:52:39,164 - INFO - metric_name is: ei_scale_ratio
2023-03-14 04:52:39,164 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.16:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678794759.157, '1.0411222322029716']}]
2023-03-14 04:52:39,164 - INFO - Results written to metrics/7573_AMX_IN8_metrics_20230314_045239.txt
2023-03-14 04:52:39,230 - INFO - sleep 120 seconds for the next round ...
2023-03-14 04:54:39,233 - INFO - -----------loop num:3/3------------
2023-03-14 04:54:49,239 - INFO - 1.  fetch_emon.sh
2023-03-14 04:54:49,241 - INFO - pwd=/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon
2023-03-14 04:54:51,173 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:54:51,174 - INFO - "ansible_facts": {
2023-03-14 04:54:51,174 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:54:51,174 - INFO - },
2023-03-14 04:54:51,174 - INFO - "changed": false,
2023-03-14 04:54:51,174 - INFO - "checksum": "1bb1c680bf42bce57bd33e9ee945d27bb8aeaafc",
2023-03-14 04:54:51,174 - INFO - "dest": "runemon.sh",
2023-03-14 04:54:51,174 - INFO - "gid": 1007,
2023-03-14 04:54:51,174 - INFO - "group": "ansible",
2023-03-14 04:54:51,175 - INFO - "mode": "0755",
2023-03-14 04:54:51,175 - INFO - "owner": "ansible",
2023-03-14 04:54:51,175 - INFO - "path": "runemon.sh",
2023-03-14 04:54:51,175 - INFO - "size": 452,
2023-03-14 04:54:51,175 - INFO - "state": "file",
2023-03-14 04:54:51,175 - INFO - "uid": 1006
2023-03-14 04:54:51,175 - INFO - }
2023-03-14 04:54:52,574 - INFO - 10.45.247.200 | SUCCESS => {
2023-03-14 04:54:52,574 - INFO - "ansible_facts": {
2023-03-14 04:54:52,575 - INFO - "discovered_interpreter_python": "/usr/bin/python3"
2023-03-14 04:54:52,575 - INFO - },
2023-03-14 04:54:52,575 - INFO - "changed": false,
2023-03-14 04:54:52,575 - INFO - "checksum": "0b7ce1d178a191ee4962273d5bcbcac8b825066d",
2023-03-14 04:54:52,575 - INFO - "dest": "sapphirerapids_server_events_private.txt",
2023-03-14 04:54:52,575 - INFO - "gid": 1007,
2023-03-14 04:54:52,575 - INFO - "group": "ansible",
2023-03-14 04:54:52,575 - INFO - "mode": "0664",
2023-03-14 04:54:52,575 - INFO - "owner": "ansible",
2023-03-14 04:54:52,575 - INFO - "path": "sapphirerapids_server_events_private.txt",
2023-03-14 04:54:52,575 - INFO - "size": 23423,
2023-03-14 04:54:52,576 - INFO - "state": "file",
2023-03-14 04:54:52,576 - INFO - "uid": 1006
2023-03-14 04:54:52,576 - INFO - }
2023-03-14 04:54:53,650 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:54:53,650 - INFO - 
2023-03-14 04:54:54,810 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:54:54,810 - INFO - 
2023-03-14 04:54:54,910 - INFO - Sleep 5 seconds then collect emon data for 30 seconds
2023-03-14 04:54:59,913 - INFO - Collecting 30 seconds sar data background
2023-03-14 04:55:01,883 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:55:01,884 - INFO - 
2023-03-14 04:55:03,935 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:55:03,935 - INFO - 
2023-03-14 04:55:06,016 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:55:06,016 - INFO - 
2023-03-14 04:55:08,120 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:55:08,121 - INFO - 
2023-03-14 04:55:08,218 - INFO - Collecting EMON data
2023-03-14 04:55:39,758 - INFO - 10.45.247.200 | CHANGED | rc=0 >>
2023-03-14 04:55:39,758 - INFO - Usage: sep_vars.sh [emon_api]
2023-03-14 04:55:39,758 - INFO - PATH=/opt/intel/sep/bin64:/opt/intel/sep/android_target:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
2023-03-14 04:55:39,758 - INFO - CPATH=/opt/intel/sep/config/emon_api:
2023-03-14 04:55:39,758 - INFO - LIBRARY_PATH=/opt/intel/sep/lib64:
2023-03-14 04:55:39,758 - INFO - LD_LIBRARY_PATH=
2023-03-14 04:55:39,759 - INFO - SEP_BASE_DIR=/opt/intel/sep/bin64
2023-03-14 04:55:39,759 - INFO - SEP is currently installed under /opt/intel/sep/bin64
2023-03-14 04:55:39,759 - INFO - EMON collector successfully stopped.
2023-03-14 04:55:39,872 - INFO - Sleep another 30 seconds to make sure the previous run exit
2023-03-14 04:56:09,875 - INFO - Copy dat files
2023-03-14 04:56:10,762 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:56:10,763 - INFO - "changed": true,
2023-03-14 04:56:10,763 - INFO - "checksum": "73f87dcf4c945c11a30ebc2c65c1aa801677fcee",
2023-03-14 04:56:10,763 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/cpuutil.log",
2023-03-14 04:56:10,763 - INFO - "md5sum": "9a9ea7f05fe23c3486964e84e797bbdf",
2023-03-14 04:56:10,763 - INFO - "remote_checksum": "73f87dcf4c945c11a30ebc2c65c1aa801677fcee",
2023-03-14 04:56:10,763 - INFO - "remote_md5sum": null
2023-03-14 04:56:10,763 - INFO - }
2023-03-14 04:56:11,870 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:56:11,871 - INFO - "changed": true,
2023-03-14 04:56:11,871 - INFO - "checksum": "f739fe4834c2948818366c9648db8aac3706f7bd",
2023-03-14 04:56:11,871 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/diskutil.log",
2023-03-14 04:56:11,871 - INFO - "md5sum": "3b3eb3aa3cc361e126afc97963a2e3a2",
2023-03-14 04:56:11,871 - INFO - "remote_checksum": "f739fe4834c2948818366c9648db8aac3706f7bd",
2023-03-14 04:56:11,872 - INFO - "remote_md5sum": null
2023-03-14 04:56:11,872 - INFO - }
2023-03-14 04:56:12,972 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:56:12,972 - INFO - "changed": true,
2023-03-14 04:56:12,972 - INFO - "checksum": "bb7a713880e7011c6f71b1788602216c25d5eba6",
2023-03-14 04:56:12,973 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/netutil.log",
2023-03-14 04:56:12,973 - INFO - "md5sum": "64f8d1f689d5a7ac64961b14e6daa989",
2023-03-14 04:56:12,973 - INFO - "remote_checksum": "bb7a713880e7011c6f71b1788602216c25d5eba6",
2023-03-14 04:56:12,973 - INFO - "remote_md5sum": null
2023-03-14 04:56:12,973 - INFO - }
2023-03-14 04:56:14,120 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:56:14,120 - INFO - "changed": true,
2023-03-14 04:56:14,121 - INFO - "checksum": "adc6fb628f7913359c441ec30c19e7242eb3788b",
2023-03-14 04:56:14,121 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/top.log",
2023-03-14 04:56:14,121 - INFO - "md5sum": "1885ab3ddff6caf1acc49646e7c53d22",
2023-03-14 04:56:14,121 - INFO - "remote_checksum": "adc6fb628f7913359c441ec30c19e7242eb3788b",
2023-03-14 04:56:14,121 - INFO - "remote_md5sum": null
2023-03-14 04:56:14,121 - INFO - }
2023-03-14 04:56:15,255 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:56:15,255 - INFO - "changed": true,
2023-03-14 04:56:15,255 - INFO - "checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:56:15,256 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-v.dat",
2023-03-14 04:56:15,256 - INFO - "md5sum": "9ed6ca61f164c3a1ddac82b3adb8e41f",
2023-03-14 04:56:15,256 - INFO - "remote_checksum": "0eecf027044a52ff57e87a1ef1f9277e1ceb146e",
2023-03-14 04:56:15,256 - INFO - "remote_md5sum": null
2023-03-14 04:56:15,256 - INFO - }
2023-03-14 04:56:16,368 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:56:16,368 - INFO - "changed": true,
2023-03-14 04:56:16,368 - INFO - "checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:56:16,369 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon-M.dat",
2023-03-14 04:56:16,369 - INFO - "md5sum": "82b2e5d1d33c2feb6e5d5290b113dd3f",
2023-03-14 04:56:16,369 - INFO - "remote_checksum": "553de59ae1f861c17499a345947edac24f5ef5e6",
2023-03-14 04:56:16,369 - INFO - "remote_md5sum": null
2023-03-14 04:56:16,369 - INFO - }
2023-03-14 04:56:18,037 - INFO - 10.45.247.200 | CHANGED => {
2023-03-14 04:56:18,038 - INFO - "changed": true,
2023-03-14 04:56:18,038 - INFO - "checksum": "9a42edbdcd6977544577d57a02de50653b3bf7ac",
2023-03-14 04:56:18,038 - INFO - "dest": "/home/ansible/yulu/ai_pipeline/ai_pipeline_benchmark/benchmarking/scripts/emon/emon10000/10.45.247.200/emon10000/emon.dat",
2023-03-14 04:56:18,038 - INFO - "md5sum": "8a8f8220397dd7a8bb4bc8cfdd37b755",
2023-03-14 04:56:18,038 - INFO - "remote_checksum": "9a42edbdcd6977544577d57a02de50653b3bf7ac",
2023-03-14 04:56:18,038 - INFO - "remote_md5sum": null
2023-03-14 04:56:18,038 - INFO - }
2023-03-14 04:56:18,137 - INFO - 2. fetch the matrics of ai_pipeline
2023-03-14 04:56:18,138 - INFO - 3.  collect the result
2023-03-14 04:56:18,298 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(rate(container_cpu_usage_seconds_total{namespace="default", container!=""}[2m])[2m:])
2023-03-14 04:56:18,298 - INFO - metric_name is: cpu_usage
2023-03-14 04:56:18,313 - INFO - result is: [{'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod37bfe08c_1a35_4f31_aee2_d3ed773045f6.slice/cri-containerd-32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '32957fce66e8ca89850f6a363f2bad55c4c434f4dd10e8ee22d59409d4d63156', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw', 'service': 'kubelet'}, 'value': [1678794978.292, '0.06828085555555137']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod443d56fd_7192_407b_aa7f_3a19c6164b35.slice/cri-containerd-8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8ef35ec5e997b42b467e9a537ce481f8b80255b055daf3b4d653e511cc959b79', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2', 'service': 'kubelet'}, 'value': [1678794978.292, '0.07035681666667289']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod5b20665e_1471_41e3_a906_37dbadf61ded.slice/cri-containerd-1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1903d9a29e2cc9280c983cf212ed426789dd4724ed212d8d6aaa692b7099b21d', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v', 'service': 'kubelet'}, 'value': [1678794978.292, '0.0774543833333357']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podc1b02e88_e7c7_494d_b700_42e46c1f306d.slice/cri-containerd-8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '8eb30a61e0cb53f9f0a8c0c18dc645c56eb3686a459ce4441c537113ae8007ae', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf', 'service': 'kubelet'}, 'value': [1678794978.292, '0.07084117499999693']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf0bbadd5_e728_4dc7_ac09_67de87ab9ed9.slice/cri-containerd-d2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd2606d2272b90c545952113b692da741b7958b163650096e2f624aeee76293a8', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5', 'service': 'kubelet'}, 'value': [1678794978.292, '0.07849015555556332']}, {'metric': {'container': 'ei-fss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podf765b16c_07f8_4261_9b64_3517dc6bafb7.slice/cri-containerd-88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-file-stream-service:2022WW47', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '88d725ffe5a1ce389c7c711b044f1cbdd7b97a922268c6d9d0735d1ba203f048', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt', 'service': 'kubelet'}, 'value': [1678794978.292, '0.07399353055554658']}, {'metric': {'container': 'ei-gws', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podaf221d52_33c6_40a0_b6bf_e5e2bc7b88db.slice/cri-containerd-870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada.scope', 'image': 'ccr-registry.caas.intel.com/cnbench/ei-gateway-server:2022WW51-ws-8080', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '870edc8724b46c501ca89d89b821712566f2c55b1d2077b638d4cbb0f32dcada', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9', 'service': 'kubelet'}, 'value': [1678794978.292, '0.0014332305555553957']}, {'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod2bb1e370_d60b_4967_a2d4_95610f5ea7b3.slice/cri-containerd-1803408b7565507cd8ec6b53a23fcc9c2e769e5da09ea16ed1fcf4b1eadbe5f9.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-inference-service-tensorflow:2022WW49', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '1803408b7565507cd8ec6b53a23fcc9c2e769e5da09ea16ed1fcf4b1eadbe5f9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q', 'service': 'kubelet'}, 'value': [1678794978.292, '52.84574587777777']}, {'metric': {'container': 'ei-wss', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-podd781997c_c6e4_4a9a_8814_f1a5e364edb4.slice/cri-containerd-d43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87.scope', 'image': 'gar-registry.caas.intel.com/cpio/ei-websocket-server:2022WW51', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': 'd43dd1ddebde49d8cd5407a60d348e56d9384fcda992f264ae9ca5887ba0ab87', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz', 'service': 'kubelet'}, 'value': [1678794978.292, '0.01027035833332977']}, {'metric': {'container': 'nfs-subdir-external-provisioner', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod008ca2f8_cd34_4bb5_9e75_b46ec5ce9a23.slice/cri-containerd-710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4.scope', 'image': 'k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '710ae0fcfaef79b8c1cbf5871a10727a0da4ef1ca22a1fd9e475a740588b43e4', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg', 'service': 'kubelet'}, 'value': [1678794978.292, '0.0010778249999993427']}, {'metric': {'container': 'redis', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod0d8f249f_8e44_4dae_82d3_618b15befd15.slice/cri-containerd-0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e.scope', 'image': 'docker.io/library/redis:6.0', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '0d39607a911d680151ccaee4e31a4eeb21acbade8e1a9eb7cd5377c4796e012e', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'ei-redis-deployment-68df56c9d5-9kt42', 'service': 'kubelet'}, 'value': [1678794978.292, '0.020662874999998672']}, {'metric': {'container': 'tmp-shell', 'cpu': 'total', 'endpoint': 'https-metrics', 'id': '/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod9cbe7477_0ea6_463d_8c1e_33eb5efda051.slice/cri-containerd-9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9.scope', 'image': 'docker.io/nicolaka/netshoot:latest', 'instance': '10.45.247.200:10250', 'job': 'kubelet', 'metrics_path': '/metrics/cadvisor', 'name': '9093ed8c6f94ca6b98db8362a28e0ee47cc31e863e7c131462759af96d66c3e9', 'namespace': 'default', 'node': 'ai-worker0', 'pod': 'tmp-shell', 'service': 'kubelet'}, 'value': [1678794978.292, '0']}]
2023-03-14 04:56:18,313 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=sum(container_memory_working_set_bytes{namespace="default",container!="", image!=""}) by (pod)
2023-03-14 04:56:18,314 - INFO - metric_name is: memory_usage
2023-03-14 04:56:18,314 - INFO - result is: [{'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-06-59c94bd6dd-7fqpw'}, 'value': [1678794978.296, '386314240']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-02-59c94bd6dd-hf2k2'}, 'value': [1678794978.296, '386433024']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-05-59c94bd6dd-2vw5v'}, 'value': [1678794978.296, '386445312']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-04-59c94bd6dd-whjrf'}, 'value': [1678794978.296, '386150400']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-03-59c94bd6dd-57bn5'}, 'value': [1678794978.296, '386625536']}, {'metric': {'pod': 'ei-sample-deployment-pose-bf16-amx-01-59c94bd6dd-n5rdt'}, 'value': [1678794978.296, '386007040']}, {'metric': {'pod': 'ei-gateway-server-deployment-694bf969dd-xhbg9'}, 'value': [1678794978.296, '56774656']}, {'metric': {'pod': 'ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q'}, 'value': [1678794978.296, '346984448']}, {'metric': {'pod': 'ei-websocket-server-deployment-b4f68d987-95vnz'}, 'value': [1678794978.296, '5093232640']}, {'metric': {'pod': 'nfs-subdir-external-provisioner-6f66496f8f-529tg'}, 'value': [1678794978.296, '15290368']}, {'metric': {'pod': 'ei-redis-deployment-68df56c9d5-9kt42'}, 'value': [1678794978.296, '2445082624']}, {'metric': {'pod': 'tmp-shell'}, 'value': [1678794978.296, '847872']}]
2023-03-14 04:56:18,314 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_infer_fps{namespace="default"}[2m])
2023-03-14 04:56:18,314 - INFO - metric_name is: ei_infer_fps
2023-03-14 04:56:18,314 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.16:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678794978.3, '161.4088119819094']}]
2023-03-14 04:56:18,314 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_drop_fps{namespace="default"}[2m])
2023-03-14 04:56:18,314 - INFO - metric_name is: ei_drop_fps
2023-03-14 04:56:18,314 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.16:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678794978.304, '8.634607369215397']}]
2023-03-14 04:56:18,314 - INFO - The query to fetch metrics from prometheus is: http://10.45.247.81:31090/api/v1/query?query=avg_over_time(ei_scale_ratio{namespace="default"}[2m])
2023-03-14 04:56:18,314 - INFO - metric_name is: ei_scale_ratio
2023-03-14 04:56:18,314 - INFO - result is: [{'metric': {'container': 'ei-infer-pose-bf16-amx-app', 'endpoint': 'web', 'instance': '10.244.120.16:8000', 'job': 'ei-infer-pose-bf16-amx-app', 'namespace': 'default', 'pod': 'ei-infer-deployment-pose-bf16-amx-01-596465bf4f-s9g2q', 'service': 'ei-infer-pose-bf16-amx-app'}, 'value': [1678794978.307, '1.0544860647815446']}]
2023-03-14 04:56:18,315 - INFO - Results written to metrics/7573_AMX_IN8_metrics_20230314_045618.txt
2023-03-14 04:56:18,382 - INFO - Finished running all scenarios!
